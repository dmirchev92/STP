"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/search/page",{

/***/ "(app-pages-browser)/./src/components/ChatModal.tsx":
/*!**************************************!*\
  !*** ./src/components/ChatModal.tsx ***!
  \**************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ ChatModal; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _UnifiedCaseModal__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./UnifiedCaseModal */ \"(app-pages-browser)/./src/components/UnifiedCaseModal.tsx\");\n/* harmony import */ var _ServiceRequestButton__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ServiceRequestButton */ \"(app-pages-browser)/./src/components/ServiceRequestButton.tsx\");\n/* harmony import */ var _SurveyModal__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SurveyModal */ \"(app-pages-browser)/./src/components/SurveyModal.tsx\");\n/* harmony import */ var _lib_api__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/api */ \"(app-pages-browser)/./src/lib/api.ts\");\n/* harmony import */ var _contexts_AuthContext__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/contexts/AuthContext */ \"(app-pages-browser)/./src/contexts/AuthContext.tsx\");\n/* harmony import */ var _contexts_SocketContext__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/contexts/SocketContext */ \"(app-pages-browser)/./src/contexts/SocketContext.tsx\");\n/* __next_internal_client_entry_do_not_use__ default auto */ \nvar _s = $RefreshSig$();\n\n\n\n\n\n\n\nfunction ChatModal(param) {\n    let { provider, isOpen, onClose } = param;\n    _s();\n    const { user, isAuthenticated } = (0,_contexts_AuthContext__WEBPACK_IMPORTED_MODULE_6__.useAuth)();\n    const { socket, isConnected } = (0,_contexts_SocketContext__WEBPACK_IMPORTED_MODULE_7__.useSocket)() // Use global socket from context\n    ;\n    const [messages, setMessages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [newMessage, setNewMessage] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [conversationId, setConversationId] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [customerName, setCustomerName] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [customerEmail, setCustomerEmail] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [customerPhone, setCustomerPhone] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [isStarted, setIsStarted] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [showUnifiedModal, setShowUnifiedModal] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [currentTemplate, setCurrentTemplate] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [isSubmittingTemplate, setIsSubmittingTemplate] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [modalMode, setModalMode] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"direct\");\n    const [showSurveyModal, setShowSurveyModal] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [surveyCase, setSurveyCase] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const messagesEndRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    // Storage keys for persistence\n    const storageKey = \"chat_\".concat(provider.id);\n    const conversationKey = \"conversation_\".concat(provider.id);\n    const scrollToBottom = ()=>{\n        var _messagesEndRef_current;\n        (_messagesEndRef_current = messagesEndRef.current) === null || _messagesEndRef_current === void 0 ? void 0 : _messagesEndRef_current.scrollIntoView({\n            behavior: \"smooth\"\n        });\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        scrollToBottom();\n    }, [\n        messages\n    ]);\n    // Initialize user data only once when modal opens\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        const initializeChat = async ()=>{\n            if (isOpen && isAuthenticated && user && !isStarted) {\n                console.log(\"\\uD83D\\uDDE8️ ChatModal opened for provider:\", provider.id);\n                const fullName = \"\".concat(user.firstName || \"\", \" \").concat(user.lastName || \"\").trim();\n                const finalName = fullName || \"User\";\n                setCustomerName(finalName);\n                setCustomerEmail(user.email || \"\");\n                setCustomerPhone(user.phoneNumber || \"\");\n                // Check for existing conversation\n                const savedConversationId = localStorage.getItem(conversationKey);\n                if (savedConversationId) {\n                    console.log(\"\\uD83D\\uDD0D Found saved conversation ID:\", savedConversationId);\n                    // Validate that the conversation exists by trying to load messages\n                    try {\n                        var _messagesResponse_data;\n                        const messagesResponse = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.getConversationMessages(savedConversationId);\n                        if ((_messagesResponse_data = messagesResponse.data) === null || _messagesResponse_data === void 0 ? void 0 : _messagesResponse_data.success) {\n                            console.log(\"✅ Saved conversation is valid, using it\");\n                            setConversationId(savedConversationId);\n                            setIsStarted(true);\n                            loadMessages(savedConversationId);\n                        } else {\n                            console.log(\"❌ Saved conversation is invalid, creating new one\");\n                            localStorage.removeItem(conversationKey);\n                            await startConversation({\n                                name: finalName,\n                                email: user.email || \"\",\n                                phone: user.phoneNumber || \"\"\n                            });\n                        }\n                    } catch (error) {\n                        console.log(\"❌ Error validating saved conversation, creating new one:\", error);\n                        localStorage.removeItem(conversationKey);\n                        await startConversation({\n                            name: finalName,\n                            email: user.email || \"\",\n                            phone: user.phoneNumber || \"\"\n                        });\n                    }\n                } else {\n                    // Auto-start conversation for authenticated users\n                    await startConversation({\n                        name: finalName,\n                        email: user.email || \"\",\n                        phone: user.phoneNumber || \"\"\n                    });\n                }\n            }\n        };\n        initializeChat();\n    }, [\n        isOpen,\n        isAuthenticated,\n        user,\n        provider.id\n    ]);\n    // Join conversation room when modal opens\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (!isOpen || !conversationId || !socket || !isConnected) return;\n        console.log(\"\\uD83C\\uDFE0 ChatModal - Joining conversation room:\", conversationId);\n        socket.emit(\"join-conversation\", conversationId);\n        return ()=>{\n            console.log(\"\\uD83D\\uDEAA ChatModal - Leaving conversation room:\", conversationId);\n        // Don't disconnect the global socket, just leave the room\n        };\n    }, [\n        isOpen,\n        conversationId,\n        socket,\n        isConnected\n    ]);\n    // Setup real-time message listeners\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (!socket || !conversationId) return;\n        const handleNewMessage = (data)=>{\n            console.log(\"\\uD83D\\uDCAC Customer received new message:\", data);\n            // Only add messages from providers (not our own messages)\n            if (data.conversationId === conversationId && data.messageId && data.senderType === \"provider\") {\n                const newMessage = {\n                    id: data.messageId,\n                    conversationId: data.conversationId,\n                    senderType: data.senderType,\n                    senderName: data.senderName,\n                    message: data.message,\n                    messageType: data.messageType,\n                    timestamp: data.timestamp\n                };\n                setMessages((prev)=>{\n                    const messageExists = prev.some((msg)=>msg.id === data.messageId);\n                    if (messageExists) return prev;\n                    console.log(\"\\uD83D\\uDCDD Adding provider message to customer chat:\", newMessage);\n                    return [\n                        ...prev,\n                        newMessage\n                    ];\n                });\n                scrollToBottom();\n            }\n        };\n        socket.on(\"new_message\", handleNewMessage);\n        return ()=>{\n            socket.off(\"new_message\", handleNewMessage);\n        };\n    }, [\n        socket,\n        conversationId\n    ]);\n    const startConversation = async (overrideData)=>{\n        if (loading || isStarted || conversationId) {\n            console.log(\"⏭️ Skipping conversation creation - already exists or in progress\");\n            return conversationId;\n        }\n        setLoading(true);\n        try {\n            var _response_data, _response_data_data, _response_data1;\n            console.log(\"\\uD83D\\uDC64 User object:\", user);\n            console.log(\"\\uD83D\\uDC64 User ID:\", user === null || user === void 0 ? void 0 : user.id);\n            console.log(\"\\uD83D\\uDC64 User type:\", typeof (user === null || user === void 0 ? void 0 : user.id));\n            // Get user ID from user object or fallback to localStorage\n            let userId = user === null || user === void 0 ? void 0 : user.id;\n            if (!userId) {\n                const userData = localStorage.getItem(\"user_data\") || localStorage.getItem(\"user\");\n                if (userData) {\n                    try {\n                        const parsedUser = JSON.parse(userData);\n                        userId = parsedUser.id;\n                        console.log(\"\\uD83D\\uDCE6 Got user ID from localStorage:\", userId);\n                    } catch (e) {\n                        console.error(\"Failed to parse user data from localStorage:\", e);\n                    }\n                }\n            }\n            const data = {\n                providerId: provider.id,\n                customerId: userId || undefined,\n                customerName: (overrideData === null || overrideData === void 0 ? void 0 : overrideData.name) || customerName,\n                customerEmail: (overrideData === null || overrideData === void 0 ? void 0 : overrideData.email) || customerEmail,\n                customerPhone: (overrideData === null || overrideData === void 0 ? void 0 : overrideData.phone) || customerPhone\n            };\n            console.log(\"\\uD83D\\uDE80 Starting conversation with data:\", data);\n            console.log(\"\\uD83D\\uDE80 customerId in data:\", data.customerId, \"type:\", typeof data.customerId);\n            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.createOrGetConversation(data);\n            if (((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) && ((_response_data1 = response.data) === null || _response_data1 === void 0 ? void 0 : (_response_data_data = _response_data1.data) === null || _response_data_data === void 0 ? void 0 : _response_data_data.conversationId)) {\n                const newConversationId = response.data.data.conversationId;\n                setConversationId(newConversationId);\n                setIsStarted(true);\n                // Save to localStorage\n                localStorage.setItem(storageKey, JSON.stringify(data));\n                localStorage.setItem(conversationKey, newConversationId);\n                // Load existing messages\n                await loadMessages(newConversationId);\n                return newConversationId;\n            }\n        } catch (error) {\n            console.error(\"Error starting conversation:\", error);\n        } finally{\n            setLoading(false);\n        }\n        return null;\n    };\n    const loadMessages = async (convId)=>{\n        try {\n            var _response_data;\n            setLoading(true);\n            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.getMarketplaceMessages(convId);\n            if (((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) && Array.isArray(response.data.data)) {\n                setMessages(response.data.data);\n                scrollToBottom();\n            }\n        } catch (error) {\n            var _error_response;\n            console.error(\"Error loading messages:\", error);\n            // If conversation doesn't exist, auto-recreate it\n            if ((error === null || error === void 0 ? void 0 : (_error_response = error.response) === null || _error_response === void 0 ? void 0 : _error_response.status) === 404) {\n                console.log(\"\\uD83D\\uDD27 Conversation not found, attempting to recreate...\");\n                await recreateConversation();\n            }\n        } finally{\n            setLoading(false);\n        }\n    };\n    const recreateConversation = async ()=>{\n        try {\n            var _response_data, _response_data_data, _response_data1;\n            const data = {\n                providerId: provider.id,\n                customerName: customerName,\n                customerEmail: customerEmail,\n                customerPhone: customerPhone\n            };\n            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.createOrGetConversation(data);\n            if (((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) && ((_response_data1 = response.data) === null || _response_data1 === void 0 ? void 0 : (_response_data_data = _response_data1.data) === null || _response_data_data === void 0 ? void 0 : _response_data_data.conversationId)) {\n                const newConversationId = response.data.data.conversationId;\n                setConversationId(newConversationId);\n                localStorage.setItem(conversationKey, newConversationId);\n                console.log(\"✅ Conversation recreated:\", newConversationId);\n            }\n        } catch (error) {\n            console.error(\"Failed to recreate conversation:\", error);\n        }\n    };\n    const handleCaseTemplateClick = async (message)=>{\n        if (message.messageType !== \"case_template\") return;\n        try {\n            var _response_data, _response_data1;\n            // Get the service category from provider\n            const serviceCategory = provider.serviceCategory || provider.service_category || \"general\";\n            // Fetch the case template\n            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.getCaseTemplate(serviceCategory);\n            if (((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) && ((_response_data1 = response.data) === null || _response_data1 === void 0 ? void 0 : _response_data1.data)) {\n                const templateData = JSON.parse(response.data.data.template_data);\n                setCurrentTemplate({\n                    ...response.data.data,\n                    templateData\n                });\n                setModalMode(\"template\");\n                setShowUnifiedModal(true);\n            }\n        } catch (error) {\n            console.error(\"Error loading case template:\", error);\n        }\n    };\n    const handleTemplateSubmit = async (formData)=>{\n        if (!conversationId || !currentTemplate) return;\n        setIsSubmittingTemplate(true);\n        try {\n            var _response_data;\n            // Create or update service case with filled data\n            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.createServiceCase({\n                conversationId,\n                templateId: currentTemplate.id,\n                caseData: formData\n            });\n            if ((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) {\n                // Send a message to the provider with the filled template\n                const summaryMessage = \"\\uD83D\\uDCCB Попълних формата с информация за проблема:\\n\\n\".concat(Object.entries(formData).map((param)=>{\n                    let [key, value] = param;\n                    const field = currentTemplate.templateData.fields.find((f)=>f.id === key);\n                    const label = (field === null || field === void 0 ? void 0 : field.label) || key;\n                    return \"\".concat(label, \": \").concat(value);\n                }).join(\"\\n\"));\n                // Send the summary message\n                const messageResponse = await fetch(\"\".concat(\"http://192.168.0.129:3000/api/v1\" || 0, \"/chat/messages\"), {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        conversationId,\n                        senderType: \"customer\",\n                        senderName: customerName,\n                        message: summaryMessage,\n                        messageType: \"case_filled\"\n                    })\n                });\n                if (messageResponse.ok) {\n                    // Add message to local state\n                    const newMessage = {\n                        id: Date.now().toString(),\n                        conversationId: conversationId,\n                        senderType: \"customer\",\n                        senderName: customerName,\n                        message: summaryMessage,\n                        messageType: \"case_filled\",\n                        timestamp: new Date().toISOString()\n                    };\n                    setMessages((prev)=>[\n                            ...prev,\n                            newMessage\n                        ]);\n                }\n                setShowUnifiedModal(false);\n                setCurrentTemplate(null);\n            }\n        } catch (error) {\n            console.error(\"Error submitting template:\", error);\n            alert(\"Възникна грешка при изпращането на формата\");\n        } finally{\n            setIsSubmittingTemplate(false);\n        }\n    };\n    const handleCaseCreation = async (caseData)=>{\n        if (!conversationId) return;\n        try {\n            var _caseResponse_data;\n            console.log(\"\\uD83D\\uDCCB ChatModal - Creating case with data:\", caseData);\n            console.log(\"\\uD83D\\uDCCB ChatModal - Provider object:\", provider);\n            console.log(\"\\uD83D\\uDCCB ChatModal - Assignment type:\", caseData.assignmentType);\n            // Prepare case data for API\n            const casePayload = {\n                serviceType: caseData.serviceType,\n                description: caseData.description,\n                preferredDate: caseData.preferredDate,\n                preferredTime: caseData.preferredTime,\n                priority: caseData.priority || \"normal\",\n                address: caseData.address,\n                phone: caseData.phone,\n                additionalDetails: caseData.additionalDetails || \"\",\n                // Handle assignment based on \"тип заявка\" selection\n                assignmentType: caseData.assignmentType || \"specific\",\n                providerId: caseData.assignmentType === \"specific\" ? provider.id : null,\n                conversationId: conversationId,\n                customerId: user.id,\n                customerName: customerName,\n                customerEmail: customerEmail,\n                customerPhone: customerPhone\n            };\n            console.log(\"\\uD83D\\uDCCB ChatModal - Case payload:\", casePayload);\n            console.log(\"\\uD83D\\uDCCB ChatModal - Final providerId for assignment:\", casePayload.providerId);\n            console.log(\"\\uD83D\\uDCCB ChatModal - Assignment logic: assignmentType =\", caseData.assignmentType, \"provider.id =\", provider.id);\n            // Create the actual case in the system\n            const caseResponse = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.createCase(casePayload);\n            if ((_caseResponse_data = caseResponse.data) === null || _caseResponse_data === void 0 ? void 0 : _caseResponse_data.success) {\n                const createdCase = caseResponse.data.data;\n                console.log(\"✅ ChatModal - Case created successfully:\", createdCase);\n                // Create a notification message in the chat\n                let notificationMessage = \"✅ Заявката е създадена успешно!\\n\\n\\uD83D\\uDCCB Номер на заявката: #\".concat(createdCase.id, \"\\n\\uD83D\\uDD27 Услуга: \").concat(caseData.serviceType, \"\\n\\uD83D\\uDCCD Адрес: \").concat(caseData.address, \"\\n\\uD83D\\uDCC5 Дата: \").concat(caseData.preferredDate, \"\\n⏰ Време: \").concat(caseData.preferredTime || \"Сутрин (8:00-12:00)\", \"\\n\\n\").concat(caseData.assignmentType === \"specific\" ? \"\\uD83C\\uDFAF Заявката е насочена директно към \".concat(provider.businessName || provider.business_name) : \"\\uD83C\\uDF10 Заявката е поставена в общата опашка за всички специалисти\");\n                // Try to send notification message to chat (non-critical)\n                try {\n                    await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.sendMessage({\n                        conversationId,\n                        senderType: \"customer\",\n                        senderName: customerName,\n                        message: notificationMessage,\n                        messageType: \"case_created\"\n                    });\n                    // Add message to local state\n                    const newMessage = {\n                        id: Date.now().toString(),\n                        conversationId: conversationId,\n                        senderType: \"customer\",\n                        senderName: customerName,\n                        message: notificationMessage,\n                        messageType: \"case_created\",\n                        timestamp: new Date().toISOString()\n                    };\n                    setMessages((prev)=>[\n                            ...prev,\n                            newMessage\n                        ]);\n                } catch (chatError) {\n                    console.error(\"\\uD83D\\uDCCB ChatModal - Failed to send chat notification (non-critical):\", chatError);\n                // Don't throw error here since case was created successfully\n                }\n                // Show success feedback\n                alert(\"Заявката е създадена успешно! Номер: #\".concat(createdCase.id));\n            } else {\n                var _caseResponse_data1;\n                throw new Error(((_caseResponse_data1 = caseResponse.data) === null || _caseResponse_data1 === void 0 ? void 0 : _caseResponse_data1.message) || \"Грешка при създаването на заявката\");\n            }\n            setShowUnifiedModal(false);\n        } catch (error) {\n            console.error(\"Error creating case:\", error);\n            alert(\"Възникна грешка при създаването на заявката\");\n        }\n    };\n    const sendMessage = async ()=>{\n        if (!newMessage.trim() || loading) return;\n        // If no conversation exists, create one first\n        let activeConvId = conversationId;\n        if (!activeConvId) {\n            console.log(\"\\uD83D\\uDD27 No conversation found, creating new one...\");\n            const newConvId = await startConversation();\n            activeConvId = newConvId;\n            if (!activeConvId) {\n                console.error(\"❌ Failed to create conversation\");\n                return;\n            }\n        }\n        setLoading(true);\n        try {\n            var _response_data;\n            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.sendMessage({\n                conversationId: activeConvId,\n                senderType: \"customer\",\n                senderName: customerName,\n                message: newMessage\n            });\n            if ((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) {\n                var _response_data_data;\n                // Add customer message to UI immediately (won't come back via WebSocket)\n                const newMsg = {\n                    id: ((_response_data_data = response.data.data) === null || _response_data_data === void 0 ? void 0 : _response_data_data.messageId) || Date.now().toString(),\n                    conversationId: activeConvId,\n                    senderType: \"customer\",\n                    senderName: customerName,\n                    message: newMessage,\n                    timestamp: new Date().toISOString()\n                };\n                setMessages((prev)=>[\n                        ...prev,\n                        newMsg\n                    ]);\n                setNewMessage(\"\");\n            }\n        } catch (error) {\n            var _error_response;\n            console.error(\"Error sending message:\", error);\n            // If conversation was deleted, try to recreate and resend\n            if ((error === null || error === void 0 ? void 0 : (_error_response = error.response) === null || _error_response === void 0 ? void 0 : _error_response.status) === 404) {\n                console.log(\"\\uD83D\\uDD27 Conversation deleted, recreating and retrying...\");\n                await recreateConversation();\n                // Retry sending the message\n                setTimeout(()=>sendMessage(), 1000);\n            }\n        } finally{\n            setLoading(false);\n        }\n    };\n    const handleClose = ()=>{\n        // Reset state when closing\n        setMessages([]);\n        setNewMessage(\"\");\n        setConversationId(null);\n        setIsStarted(false);\n        onClose();\n    };\n    if (!isOpen) return null;\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"bg-slate-800 rounded-xl shadow-2xl w-full max-w-md mx-4 h-96 flex flex-col border border-white/20\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-4 rounded-t-xl flex justify-between items-center\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                                        className: \"font-semibold\",\n                                        children: provider.businessName || provider.business_name || \"\".concat(provider.firstName || provider.first_name, \" \").concat(provider.lastName || provider.last_name)\n                                    }, void 0, false, {\n                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                        lineNumber: 543,\n                                        columnNumber: 13\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                        className: \"text-sm text-white/80\",\n                                        children: provider.serviceCategory || provider.service_category\n                                    }, void 0, false, {\n                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                        lineNumber: 546,\n                                        columnNumber: 13\n                                    }, this)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                lineNumber: 542,\n                                columnNumber: 11\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: handleClose,\n                                className: \"text-white/80 hover:text-white transition-colors\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                                    className: \"w-6 h-6\",\n                                    fill: \"none\",\n                                    stroke: \"currentColor\",\n                                    viewBox: \"0 0 24 24\",\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                                        strokeLinecap: \"round\",\n                                        strokeLinejoin: \"round\",\n                                        strokeWidth: 2,\n                                        d: \"M6 18L18 6M6 6l12 12\"\n                                    }, void 0, false, {\n                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                        lineNumber: 555,\n                                        columnNumber: 15\n                                    }, this)\n                                }, void 0, false, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 554,\n                                    columnNumber: 13\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                lineNumber: 550,\n                                columnNumber: 11\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                        lineNumber: 541,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex-1 overflow-y-auto p-4 space-y-3 bg-slate-900/50\",\n                        children: [\n                            loading && messages.length === 0 ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"text-center text-slate-400\",\n                                children: \"Зареждане...\"\n                            }, void 0, false, {\n                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                lineNumber: 563,\n                                columnNumber: 13\n                            }, this) : messages.map((msg)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"flex \".concat(msg.senderType === \"customer\" ? \"justify-end\" : \"justify-start\"),\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"max-w-xs px-3 py-2 rounded-lg text-sm \".concat(msg.senderType === \"customer\" ? \"bg-gradient-to-r from-indigo-600 to-purple-600 text-white\" : \"bg-slate-700 text-slate-100 border border-slate-600\"),\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                children: msg.message\n                                            }, void 0, false, {\n                                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                lineNumber: 577,\n                                                columnNumber: 19\n                                            }, this),\n                                            msg.messageType === \"case_template\" && msg.senderType === \"provider\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                onClick: ()=>handleCaseTemplateClick(msg),\n                                                className: \"mt-2 px-3 py-1 bg-gradient-to-r from-indigo-500 to-purple-500 text-white text-xs rounded hover:shadow-lg transform hover:scale-105 transition-all duration-300\",\n                                                children: \"\\uD83D\\uDCCB Попълни формата\"\n                                            }, void 0, false, {\n                                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                lineNumber: 581,\n                                                columnNumber: 21\n                                            }, this),\n                                            msg.messageType === \"service_request\" && msg.senderType === \"provider\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"mt-2\",\n                                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_ServiceRequestButton__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n                                                    providerName: provider.businessName || provider.business_name || \"\".concat(provider.firstName || provider.first_name, \" \").concat(provider.lastName || provider.last_name),\n                                                    onClick: ()=>{\n                                                        setModalMode(\"direct\");\n                                                        setShowUnifiedModal(true);\n                                                    }\n                                                }, void 0, false, {\n                                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                    lineNumber: 592,\n                                                    columnNumber: 23\n                                                }, this)\n                                            }, void 0, false, {\n                                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                lineNumber: 591,\n                                                columnNumber: 21\n                                            }, this),\n                                            msg.messageType === \"survey_request\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                onClick: async ()=>{\n                                                    // Extract case ID from message data\n                                                    console.log(\"\\uD83D\\uDD0D Survey button clicked, message data:\", msg);\n                                                    let caseId = msg.caseId;\n                                                    // Try to parse data field if it exists\n                                                    if (msg.data) {\n                                                        try {\n                                                            const parsedData = typeof msg.data === \"string\" ? JSON.parse(msg.data) : msg.data;\n                                                            console.log(\"\\uD83D\\uDD0D Parsed message data:\", parsedData);\n                                                            caseId = parsedData.caseId || caseId;\n                                                        } catch (e) {\n                                                            console.log(\"Could not parse message data:\", msg.data);\n                                                        }\n                                                    }\n                                                    console.log(\"\\uD83D\\uDD0D Final caseId extracted:\", caseId);\n                                                    if (caseId) {\n                                                        try {\n                                                            var _response_data;\n                                                            // Fetch case details for the survey\n                                                            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.getCase(caseId);\n                                                            if ((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) {\n                                                                setSurveyCase({\n                                                                    id: caseId,\n                                                                    providerName: provider.businessName || provider.business_name || \"\".concat(provider.firstName || provider.first_name, \" \").concat(provider.lastName || provider.last_name),\n                                                                    serviceType: response.data.data.service_type,\n                                                                    completedAt: response.data.data.completed_at,\n                                                                    description: response.data.data.description\n                                                                });\n                                                                setShowSurveyModal(true);\n                                                            }\n                                                        } catch (error) {\n                                                            console.error(\"Error fetching case details:\", error);\n                                                            alert(\"Възникна грешка при зареждането на детайлите за заявката\");\n                                                        }\n                                                    } else {\n                                                        alert(\"Не може да се намери ID на заявката\");\n                                                    }\n                                                },\n                                                className: \"mt-2 px-4 py-2 bg-gradient-to-r from-yellow-500 to-orange-500 text-white text-sm rounded-lg hover:from-yellow-600 hover:to-orange-600 transition-all duration-200 flex items-center space-x-2\",\n                                                children: [\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                        children: \"⭐\"\n                                                    }, void 0, false, {\n                                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                        lineNumber: 647,\n                                                        columnNumber: 23\n                                                    }, this),\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                        children: \"Оценете услугата\"\n                                                    }, void 0, false, {\n                                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                        lineNumber: 648,\n                                                        columnNumber: 23\n                                                    }, this)\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                lineNumber: 604,\n                                                columnNumber: 21\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"text-xs mt-1 \".concat(msg.senderType === \"customer\" ? \"text-white/60\" : \"text-slate-400\"),\n                                                children: new Date(msg.timestamp).toLocaleTimeString(\"bg-BG\", {\n                                                    hour: \"2-digit\",\n                                                    minute: \"2-digit\"\n                                                })\n                                            }, void 0, false, {\n                                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                lineNumber: 652,\n                                                columnNumber: 19\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                        lineNumber: 570,\n                                        columnNumber: 17\n                                    }, this)\n                                }, msg.id, false, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 566,\n                                    columnNumber: 15\n                                }, this)),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                ref: messagesEndRef\n                            }, void 0, false, {\n                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                lineNumber: 664,\n                                columnNumber: 11\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                        lineNumber: 561,\n                        columnNumber: 9\n                    }, this),\n                    isStarted && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"border-t border-slate-700 p-4 bg-slate-800/50\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex space-x-2 mb-3\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                                        type: \"text\",\n                                        value: newMessage,\n                                        onChange: (e)=>setNewMessage(e.target.value),\n                                        onKeyPress: (e)=>e.key === \"Enter\" && sendMessage(),\n                                        placeholder: \"Напишете съобщение...\",\n                                        className: \"flex-1 bg-slate-700 border border-slate-600 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder:text-slate-400\",\n                                        disabled: loading\n                                    }, void 0, false, {\n                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                        lineNumber: 671,\n                                        columnNumber: 15\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                        onClick: sendMessage,\n                                        disabled: !newMessage.trim() || loading,\n                                        className: \"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-lg transform hover:scale-105 transition-all duration-300\",\n                                        children: loading ? \"...\" : \"Изпрати\"\n                                    }, void 0, false, {\n                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                        lineNumber: 680,\n                                        columnNumber: 15\n                                    }, this)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                lineNumber: 670,\n                                columnNumber: 13\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex justify-center\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    onClick: ()=>{\n                                        setModalMode(\"direct\");\n                                        setShowUnifiedModal(true);\n                                    },\n                                    className: \"bg-gradient-to-r from-green-500 to-blue-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-green-600 hover:to-blue-600 transition-all duration-200 flex items-center space-x-2\",\n                                    children: [\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                            children: \"\\uD83D\\uDD27\"\n                                        }, void 0, false, {\n                                            fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                            lineNumber: 698,\n                                            columnNumber: 17\n                                        }, this),\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                            children: \"Създай заявка за услуга\"\n                                        }, void 0, false, {\n                                            fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                            lineNumber: 699,\n                                            columnNumber: 17\n                                        }, this)\n                                    ]\n                                }, void 0, true, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 691,\n                                    columnNumber: 15\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                lineNumber: 690,\n                                columnNumber: 13\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                        lineNumber: 669,\n                        columnNumber: 11\n                    }, this),\n                    !isStarted && !loading && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"p-4 border-t border-slate-700 bg-slate-800/50\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"space-y-3\",\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                                    type: \"text\",\n                                    placeholder: \"Вашето име\",\n                                    value: customerName,\n                                    onChange: (e)=>setCustomerName(e.target.value),\n                                    className: \"w-full bg-slate-700 border border-slate-600 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder:text-slate-400\"\n                                }, void 0, false, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 709,\n                                    columnNumber: 15\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                                    type: \"email\",\n                                    placeholder: \"Email адрес\",\n                                    value: customerEmail,\n                                    onChange: (e)=>setCustomerEmail(e.target.value),\n                                    className: \"w-full bg-slate-700 border border-slate-600 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder:text-slate-400\"\n                                }, void 0, false, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 716,\n                                    columnNumber: 15\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                                    type: \"tel\",\n                                    placeholder: \"Телефон\",\n                                    value: customerPhone,\n                                    onChange: (e)=>setCustomerPhone(e.target.value),\n                                    className: \"w-full bg-slate-700 border border-slate-600 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder:text-slate-400\"\n                                }, void 0, false, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 723,\n                                    columnNumber: 15\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    onClick: ()=>startConversation(),\n                                    disabled: !customerName || !customerEmail,\n                                    className: \"w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-lg transform hover:scale-105 transition-all duration-300\",\n                                    children: \"Започни разговор\"\n                                }, void 0, false, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 730,\n                                    columnNumber: 15\n                                }, this)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                            lineNumber: 708,\n                            columnNumber: 13\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                        lineNumber: 707,\n                        columnNumber: 11\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                lineNumber: 539,\n                columnNumber: 7\n            }, this),\n            showUnifiedModal && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_UnifiedCaseModal__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n                isOpen: showUnifiedModal,\n                mode: modalMode,\n                templateData: currentTemplate === null || currentTemplate === void 0 ? void 0 : currentTemplate.templateData,\n                onClose: ()=>{\n                    setShowUnifiedModal(false);\n                    setCurrentTemplate(null);\n                },\n                onSubmit: modalMode === \"template\" ? handleTemplateSubmit : handleCaseCreation,\n                isSubmitting: isSubmittingTemplate,\n                providerName: provider.businessName || provider.business_name || \"специалиста\",\n                providerId: provider.id,\n                providerCategory: provider.serviceCategory || provider.service_category,\n                customerPhone: customerPhone\n            }, void 0, false, {\n                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                lineNumber: 744,\n                columnNumber: 7\n            }, this),\n            showSurveyModal && surveyCase && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_SurveyModal__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n                isOpen: showSurveyModal,\n                onClose: ()=>{\n                    setShowSurveyModal(false);\n                    setSurveyCase(null);\n                },\n                caseId: surveyCase.id,\n                providerId: provider.id,\n                providerName: provider.businessName || provider.business_name || \"\".concat(provider.firstName || provider.first_name, \" \").concat(provider.lastName || provider.last_name),\n                onSubmitSuccess: async ()=>{\n                    // Send a thank you message to the chat\n                    const thankYouMessage = \"✅ Благодарим ви за оценката! \\n\\nВашето мнение е важно за нас и помага на други клиенти да направят правилния избор.\";\n                    try {\n                        await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.sendMessage({\n                            conversationId: conversationId,\n                            senderType: \"customer\",\n                            senderName: customerName,\n                            message: thankYouMessage,\n                            messageType: \"text\"\n                        });\n                        // Add thank you message to local state\n                        const newMessage = {\n                            id: Date.now().toString(),\n                            conversationId: conversationId,\n                            senderType: \"customer\",\n                            senderName: customerName,\n                            message: thankYouMessage,\n                            messageType: \"text\",\n                            timestamp: new Date().toISOString()\n                        };\n                        setMessages((prev)=>[\n                                ...prev,\n                                newMessage\n                            ]);\n                    } catch (error) {\n                        console.error(\"Error sending thank you message:\", error);\n                    }\n                    setShowSurveyModal(false);\n                    setSurveyCase(null);\n                    alert(\"Благодарим ви за оценката!\");\n                }\n            }, void 0, false, {\n                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                lineNumber: 763,\n                columnNumber: 7\n            }, this)\n        ]\n    }, void 0, true, {\n        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n        lineNumber: 538,\n        columnNumber: 5\n    }, this);\n}\n_s(ChatModal, \"ir1+hIhHPugMO/zr0fAfFVq4m5g=\", false, function() {\n    return [\n        _contexts_AuthContext__WEBPACK_IMPORTED_MODULE_6__.useAuth,\n        _contexts_SocketContext__WEBPACK_IMPORTED_MODULE_7__.useSocket\n    ];\n});\n_c = ChatModal;\nvar _c;\n$RefreshReg$(_c, \"ChatModal\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9jb21wb25lbnRzL0NoYXRNb2RhbC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBRTJEO0FBRVQ7QUFDUTtBQUNsQjtBQUNIO0FBQ1c7QUFDSTtBQThDckMsU0FBU1UsVUFBVSxLQUE2QztRQUE3QyxFQUFFQyxRQUFRLEVBQUVDLE1BQU0sRUFBRUMsT0FBTyxFQUFrQixHQUE3Qzs7SUFDaEMsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLGVBQWUsRUFBRSxHQUFHUCw4REFBT0E7SUFDekMsTUFBTSxFQUFFUSxNQUFNLEVBQUVDLFdBQVcsRUFBRSxHQUFHUixrRUFBU0EsR0FBRyxpQ0FBaUM7O0lBQzdFLE1BQU0sQ0FBQ1MsVUFBVUMsWUFBWSxHQUFHbEIsK0NBQVFBLENBQVksRUFBRTtJQUN0RCxNQUFNLENBQUNtQixZQUFZQyxjQUFjLEdBQUdwQiwrQ0FBUUEsQ0FBQztJQUM3QyxNQUFNLENBQUNxQixTQUFTQyxXQUFXLEdBQUd0QiwrQ0FBUUEsQ0FBQztJQUN2QyxNQUFNLENBQUN1QixnQkFBZ0JDLGtCQUFrQixHQUFHeEIsK0NBQVFBLENBQWdCO0lBQ3BFLE1BQU0sQ0FBQ3lCLGNBQWNDLGdCQUFnQixHQUFHMUIsK0NBQVFBLENBQUM7SUFDakQsTUFBTSxDQUFDMkIsZUFBZUMsaUJBQWlCLEdBQUc1QiwrQ0FBUUEsQ0FBQztJQUNuRCxNQUFNLENBQUM2QixlQUFlQyxpQkFBaUIsR0FBRzlCLCtDQUFRQSxDQUFDO0lBQ25ELE1BQU0sQ0FBQytCLFdBQVdDLGFBQWEsR0FBR2hDLCtDQUFRQSxDQUFDO0lBQzNDLE1BQU0sQ0FBQ2lDLGtCQUFrQkMsb0JBQW9CLEdBQUdsQywrQ0FBUUEsQ0FBQztJQUN6RCxNQUFNLENBQUNtQyxpQkFBaUJDLG1CQUFtQixHQUFHcEMsK0NBQVFBLENBQU07SUFDNUQsTUFBTSxDQUFDcUMsc0JBQXNCQyx3QkFBd0IsR0FBR3RDLCtDQUFRQSxDQUFDO0lBQ2pFLE1BQU0sQ0FBQ3VDLFdBQVdDLGFBQWEsR0FBR3hDLCtDQUFRQSxDQUF3QjtJQUNsRSxNQUFNLENBQUN5QyxpQkFBaUJDLG1CQUFtQixHQUFHMUMsK0NBQVFBLENBQUM7SUFDdkQsTUFBTSxDQUFDMkMsWUFBWUMsY0FBYyxHQUFHNUMsK0NBQVFBLENBQU07SUFDbEQsTUFBTTZDLGlCQUFpQjNDLDZDQUFNQSxDQUFpQjtJQUU5QywrQkFBK0I7SUFDL0IsTUFBTTRDLGFBQWEsUUFBb0IsT0FBWnBDLFNBQVNxQyxFQUFFO0lBQ3RDLE1BQU1DLGtCQUFrQixnQkFBNEIsT0FBWnRDLFNBQVNxQyxFQUFFO0lBRW5ELE1BQU1FLGlCQUFpQjtZQUNyQko7U0FBQUEsMEJBQUFBLGVBQWVLLE9BQU8sY0FBdEJMLDhDQUFBQSx3QkFBd0JNLGNBQWMsQ0FBQztZQUFFQyxVQUFVO1FBQVM7SUFDOUQ7SUFFQW5ELGdEQUFTQSxDQUFDO1FBQ1JnRDtJQUNGLEdBQUc7UUFBQ2hDO0tBQVM7SUFFYixrREFBa0Q7SUFDbERoQixnREFBU0EsQ0FBQztRQUNSLE1BQU1vRCxpQkFBaUI7WUFDckIsSUFBSTFDLFVBQVVHLG1CQUFtQkQsUUFBUSxDQUFDa0IsV0FBVztnQkFDbkR1QixRQUFRQyxHQUFHLENBQUMsZ0RBQXNDN0MsU0FBU3FDLEVBQUU7Z0JBRTdELE1BQU1TLFdBQVcsR0FBMkIzQyxPQUF4QkEsS0FBSzRDLFNBQVMsSUFBSSxJQUFHLEtBQXVCLE9BQXBCNUMsS0FBSzZDLFFBQVEsSUFBSSxJQUFLQyxJQUFJO2dCQUN0RSxNQUFNQyxZQUFZSixZQUFZO2dCQUU5QjlCLGdCQUFnQmtDO2dCQUNoQmhDLGlCQUFpQmYsS0FBS2dELEtBQUssSUFBSTtnQkFDL0IvQixpQkFBaUJqQixLQUFLaUQsV0FBVyxJQUFJO2dCQUVyQyxrQ0FBa0M7Z0JBQ2xDLE1BQU1DLHNCQUFzQkMsYUFBYUMsT0FBTyxDQUFDakI7Z0JBQ2pELElBQUllLHFCQUFxQjtvQkFDdkJULFFBQVFDLEdBQUcsQ0FBQyw2Q0FBbUNRO29CQUMvQyxtRUFBbUU7b0JBQ25FLElBQUk7NEJBRUVHO3dCQURKLE1BQU1BLG1CQUFtQixNQUFNNUQsK0NBQVNBLENBQUM2RCx1QkFBdUIsQ0FBQ0o7d0JBQ2pFLEtBQUlHLHlCQUFBQSxpQkFBaUJFLElBQUksY0FBckJGLDZDQUFBQSx1QkFBdUJHLE9BQU8sRUFBRTs0QkFDbENmLFFBQVFDLEdBQUcsQ0FBQzs0QkFDWi9CLGtCQUFrQnVDOzRCQUNsQi9CLGFBQWE7NEJBQ2JzQyxhQUFhUDt3QkFDZixPQUFPOzRCQUNMVCxRQUFRQyxHQUFHLENBQUM7NEJBQ1pTLGFBQWFPLFVBQVUsQ0FBQ3ZCOzRCQUN4QixNQUFNd0Isa0JBQWtCO2dDQUN0QkMsTUFBTWI7Z0NBQ05DLE9BQU9oRCxLQUFLZ0QsS0FBSyxJQUFJO2dDQUNyQmEsT0FBTzdELEtBQUtpRCxXQUFXLElBQUk7NEJBQzdCO3dCQUNGO29CQUNGLEVBQUUsT0FBT2EsT0FBTzt3QkFDZHJCLFFBQVFDLEdBQUcsQ0FBQyw0REFBNERvQjt3QkFDeEVYLGFBQWFPLFVBQVUsQ0FBQ3ZCO3dCQUN4QixNQUFNd0Isa0JBQWtCOzRCQUN0QkMsTUFBTWI7NEJBQ05DLE9BQU9oRCxLQUFLZ0QsS0FBSyxJQUFJOzRCQUNyQmEsT0FBTzdELEtBQUtpRCxXQUFXLElBQUk7d0JBQzdCO29CQUNGO2dCQUNGLE9BQU87b0JBQ0wsa0RBQWtEO29CQUNsRCxNQUFNVSxrQkFBa0I7d0JBQ3RCQyxNQUFNYjt3QkFDTkMsT0FBT2hELEtBQUtnRCxLQUFLLElBQUk7d0JBQ3JCYSxPQUFPN0QsS0FBS2lELFdBQVcsSUFBSTtvQkFDN0I7Z0JBQ0Y7WUFDRjtRQUNGO1FBRUFUO0lBQ0YsR0FBRztRQUFDMUM7UUFBUUc7UUFBaUJEO1FBQU1ILFNBQVNxQyxFQUFFO0tBQUM7SUFFL0MsMENBQTBDO0lBQzFDOUMsZ0RBQVNBLENBQUM7UUFDUixJQUFJLENBQUNVLFVBQVUsQ0FBQ1ksa0JBQWtCLENBQUNSLFVBQVUsQ0FBQ0MsYUFBYTtRQUUzRHNDLFFBQVFDLEdBQUcsQ0FBQyx1REFBNkNoQztRQUN6RFIsT0FBTzZELElBQUksQ0FBQyxxQkFBcUJyRDtRQUVqQyxPQUFPO1lBQ0wrQixRQUFRQyxHQUFHLENBQUMsdURBQTZDaEM7UUFDekQsMERBQTBEO1FBQzVEO0lBQ0YsR0FBRztRQUFDWjtRQUFRWTtRQUFnQlI7UUFBUUM7S0FBWTtJQUVoRCxvQ0FBb0M7SUFDcENmLGdEQUFTQSxDQUFDO1FBQ1IsSUFBSSxDQUFDYyxVQUFVLENBQUNRLGdCQUFnQjtRQUVoQyxNQUFNc0QsbUJBQW1CLENBQUNUO1lBQ3hCZCxRQUFRQyxHQUFHLENBQUMsK0NBQXFDYTtZQUVqRCwwREFBMEQ7WUFDMUQsSUFBSUEsS0FBSzdDLGNBQWMsS0FBS0Esa0JBQWtCNkMsS0FBS1UsU0FBUyxJQUFJVixLQUFLVyxVQUFVLEtBQUssWUFBWTtnQkFDOUYsTUFBTTVELGFBQXNCO29CQUMxQjRCLElBQUlxQixLQUFLVSxTQUFTO29CQUNsQnZELGdCQUFnQjZDLEtBQUs3QyxjQUFjO29CQUNuQ3dELFlBQVlYLEtBQUtXLFVBQVU7b0JBQzNCQyxZQUFZWixLQUFLWSxVQUFVO29CQUMzQkMsU0FBU2IsS0FBS2EsT0FBTztvQkFDckJDLGFBQWFkLEtBQUtjLFdBQVc7b0JBQzdCQyxXQUFXZixLQUFLZSxTQUFTO2dCQUMzQjtnQkFFQWpFLFlBQVlrRSxDQUFBQTtvQkFDVixNQUFNQyxnQkFBZ0JELEtBQUtFLElBQUksQ0FBQ0MsQ0FBQUEsTUFBT0EsSUFBSXhDLEVBQUUsS0FBS3FCLEtBQUtVLFNBQVM7b0JBQ2hFLElBQUlPLGVBQWUsT0FBT0Q7b0JBRTFCOUIsUUFBUUMsR0FBRyxDQUFDLDBEQUFnRHBDO29CQUM1RCxPQUFPOzJCQUFJaUU7d0JBQU1qRTtxQkFBVztnQkFDOUI7Z0JBQ0E4QjtZQUNGO1FBQ0Y7UUFFQWxDLE9BQU95RSxFQUFFLENBQUMsZUFBZVg7UUFFekIsT0FBTztZQUNMOUQsT0FBTzBFLEdBQUcsQ0FBQyxlQUFlWjtRQUM1QjtJQUNGLEdBQUc7UUFBQzlEO1FBQVFRO0tBQWU7SUFFM0IsTUFBTWlELG9CQUFvQixPQUFPa0I7UUFDL0IsSUFBSXJFLFdBQVdVLGFBQWFSLGdCQUFnQjtZQUMxQytCLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU9oQztRQUNUO1FBRUFELFdBQVc7UUFDWCxJQUFJO2dCQWlDRXFFLGdCQUEwQkEscUJBQUFBO1lBaEM5QnJDLFFBQVFDLEdBQUcsQ0FBQyw2QkFBbUIxQztZQUMvQnlDLFFBQVFDLEdBQUcsQ0FBQyx5QkFBZTFDLGlCQUFBQSwyQkFBQUEsS0FBTWtDLEVBQUU7WUFDbkNPLFFBQVFDLEdBQUcsQ0FBQywyQkFBaUIsUUFBTzFDLGlCQUFBQSwyQkFBQUEsS0FBTWtDLEVBQUU7WUFFNUMsMkRBQTJEO1lBQzNELElBQUk2QyxTQUFTL0UsaUJBQUFBLDJCQUFBQSxLQUFNa0MsRUFBRTtZQUNyQixJQUFJLENBQUM2QyxRQUFRO2dCQUNYLE1BQU1DLFdBQVc3QixhQUFhQyxPQUFPLENBQUMsZ0JBQWdCRCxhQUFhQyxPQUFPLENBQUM7Z0JBQzNFLElBQUk0QixVQUFVO29CQUNaLElBQUk7d0JBQ0YsTUFBTUMsYUFBYUMsS0FBS0MsS0FBSyxDQUFDSDt3QkFDOUJELFNBQVNFLFdBQVcvQyxFQUFFO3dCQUN0Qk8sUUFBUUMsR0FBRyxDQUFDLCtDQUFxQ3FDO29CQUNuRCxFQUFFLE9BQU9LLEdBQUc7d0JBQ1YzQyxRQUFRcUIsS0FBSyxDQUFDLGdEQUFnRHNCO29CQUNoRTtnQkFDRjtZQUNGO1lBRUEsTUFBTTdCLE9BQU87Z0JBQ1g4QixZQUFZeEYsU0FBU3FDLEVBQUU7Z0JBQ3ZCb0QsWUFBWVAsVUFBVVE7Z0JBQ3RCM0UsY0FBY2lFLENBQUFBLHlCQUFBQSxtQ0FBQUEsYUFBY2pCLElBQUksS0FBSWhEO2dCQUNwQ0UsZUFBZStELENBQUFBLHlCQUFBQSxtQ0FBQUEsYUFBYzdCLEtBQUssS0FBSWxDO2dCQUN0Q0UsZUFBZTZELENBQUFBLHlCQUFBQSxtQ0FBQUEsYUFBY2hCLEtBQUssS0FBSTdDO1lBQ3hDO1lBRUF5QixRQUFRQyxHQUFHLENBQUMsaURBQXVDYTtZQUNuRGQsUUFBUUMsR0FBRyxDQUFDLG9DQUEwQmEsS0FBSytCLFVBQVUsRUFBRSxTQUFTLE9BQU8vQixLQUFLK0IsVUFBVTtZQUV0RixNQUFNUixXQUFXLE1BQU1yRiwrQ0FBU0EsQ0FBQytGLHVCQUF1QixDQUFDakM7WUFFekQsSUFBSXVCLEVBQUFBLGlCQUFBQSxTQUFTdkIsSUFBSSxjQUFidUIscUNBQUFBLGVBQWV0QixPQUFPLE9BQUlzQixrQkFBQUEsU0FBU3ZCLElBQUksY0FBYnVCLHVDQUFBQSxzQkFBQUEsZ0JBQWV2QixJQUFJLGNBQW5CdUIsMENBQUFBLG9CQUFxQnBFLGNBQWMsR0FBRTtnQkFDakUsTUFBTStFLG9CQUFvQlgsU0FBU3ZCLElBQUksQ0FBQ0EsSUFBSSxDQUFDN0MsY0FBYztnQkFDM0RDLGtCQUFrQjhFO2dCQUNsQnRFLGFBQWE7Z0JBRWIsdUJBQXVCO2dCQUN2QmdDLGFBQWF1QyxPQUFPLENBQUN6RCxZQUFZaUQsS0FBS1MsU0FBUyxDQUFDcEM7Z0JBQ2hESixhQUFhdUMsT0FBTyxDQUFDdkQsaUJBQWlCc0Q7Z0JBRXRDLHlCQUF5QjtnQkFDekIsTUFBTWhDLGFBQWFnQztnQkFFbkIsT0FBT0E7WUFDVDtRQUNGLEVBQUUsT0FBTzNCLE9BQU87WUFDZHJCLFFBQVFxQixLQUFLLENBQUMsZ0NBQWdDQTtRQUNoRCxTQUFVO1lBQ1JyRCxXQUFXO1FBQ2I7UUFDQSxPQUFPO0lBQ1Q7SUFFQSxNQUFNZ0QsZUFBZSxPQUFPbUM7UUFDMUIsSUFBSTtnQkFHRWQ7WUFGSnJFLFdBQVc7WUFDWCxNQUFNcUUsV0FBVyxNQUFNckYsK0NBQVNBLENBQUNvRyxzQkFBc0IsQ0FBQ0Q7WUFDeEQsSUFBSWQsRUFBQUEsaUJBQUFBLFNBQVN2QixJQUFJLGNBQWJ1QixxQ0FBQUEsZUFBZXRCLE9BQU8sS0FBSXNDLE1BQU1DLE9BQU8sQ0FBQ2pCLFNBQVN2QixJQUFJLENBQUNBLElBQUksR0FBRztnQkFDL0RsRCxZQUFZeUUsU0FBU3ZCLElBQUksQ0FBQ0EsSUFBSTtnQkFDOUJuQjtZQUNGO1FBQ0YsRUFBRSxPQUFPMEIsT0FBWTtnQkFHZkE7WUFGSnJCLFFBQVFxQixLQUFLLENBQUMsMkJBQTJCQTtZQUN6QyxrREFBa0Q7WUFDbEQsSUFBSUEsQ0FBQUEsa0JBQUFBLDZCQUFBQSxrQkFBQUEsTUFBT2dCLFFBQVEsY0FBZmhCLHNDQUFBQSxnQkFBaUJrQyxNQUFNLE1BQUssS0FBSztnQkFDbkN2RCxRQUFRQyxHQUFHLENBQUM7Z0JBQ1osTUFBTXVEO1lBQ1I7UUFDRixTQUFVO1lBQ1J4RixXQUFXO1FBQ2I7SUFDRjtJQUVBLE1BQU13Rix1QkFBdUI7UUFDM0IsSUFBSTtnQkFTRW5CLGdCQUEwQkEscUJBQUFBO1lBUjlCLE1BQU12QixPQUFPO2dCQUNYOEIsWUFBWXhGLFNBQVNxQyxFQUFFO2dCQUN2QnRCLGNBQWNBO2dCQUNkRSxlQUFlQTtnQkFDZkUsZUFBZUE7WUFDakI7WUFFQSxNQUFNOEQsV0FBVyxNQUFNckYsK0NBQVNBLENBQUMrRix1QkFBdUIsQ0FBQ2pDO1lBQ3pELElBQUl1QixFQUFBQSxpQkFBQUEsU0FBU3ZCLElBQUksY0FBYnVCLHFDQUFBQSxlQUFldEIsT0FBTyxPQUFJc0Isa0JBQUFBLFNBQVN2QixJQUFJLGNBQWJ1Qix1Q0FBQUEsc0JBQUFBLGdCQUFldkIsSUFBSSxjQUFuQnVCLDBDQUFBQSxvQkFBcUJwRSxjQUFjLEdBQUU7Z0JBQ2pFLE1BQU0rRSxvQkFBb0JYLFNBQVN2QixJQUFJLENBQUNBLElBQUksQ0FBQzdDLGNBQWM7Z0JBQzNEQyxrQkFBa0I4RTtnQkFDbEJ0QyxhQUFhdUMsT0FBTyxDQUFDdkQsaUJBQWlCc0Q7Z0JBQ3RDaEQsUUFBUUMsR0FBRyxDQUFDLDZCQUE2QitDO1lBQzNDO1FBQ0YsRUFBRSxPQUFPM0IsT0FBTztZQUNkckIsUUFBUXFCLEtBQUssQ0FBQyxvQ0FBb0NBO1FBQ3BEO0lBQ0Y7SUFFQSxNQUFNb0MsMEJBQTBCLE9BQU85QjtRQUNyQyxJQUFJQSxRQUFRQyxXQUFXLEtBQUssaUJBQWlCO1FBRTdDLElBQUk7Z0JBT0VTLGdCQUEwQkE7WUFOOUIseUNBQXlDO1lBQ3pDLE1BQU1xQixrQkFBa0J0RyxTQUFTc0csZUFBZSxJQUFJdEcsU0FBU3VHLGdCQUFnQixJQUFJO1lBRWpGLDBCQUEwQjtZQUMxQixNQUFNdEIsV0FBVyxNQUFNckYsK0NBQVNBLENBQUM0RyxlQUFlLENBQUNGO1lBRWpELElBQUlyQixFQUFBQSxpQkFBQUEsU0FBU3ZCLElBQUksY0FBYnVCLHFDQUFBQSxlQUFldEIsT0FBTyxPQUFJc0Isa0JBQUFBLFNBQVN2QixJQUFJLGNBQWJ1QixzQ0FBQUEsZ0JBQWV2QixJQUFJLEdBQUU7Z0JBQ2pELE1BQU0rQyxlQUFlcEIsS0FBS0MsS0FBSyxDQUFDTCxTQUFTdkIsSUFBSSxDQUFDQSxJQUFJLENBQUNnRCxhQUFhO2dCQUNoRWhGLG1CQUFtQjtvQkFDakIsR0FBR3VELFNBQVN2QixJQUFJLENBQUNBLElBQUk7b0JBQ3JCK0M7Z0JBQ0Y7Z0JBQ0EzRSxhQUFhO2dCQUNiTixvQkFBb0I7WUFDdEI7UUFDRixFQUFFLE9BQU95QyxPQUFPO1lBQ2RyQixRQUFRcUIsS0FBSyxDQUFDLGdDQUFnQ0E7UUFDaEQ7SUFDRjtJQUVBLE1BQU0wQyx1QkFBdUIsT0FBT0M7UUFDbEMsSUFBSSxDQUFDL0Ysa0JBQWtCLENBQUNZLGlCQUFpQjtRQUV6Q0csd0JBQXdCO1FBQ3hCLElBQUk7Z0JBUUVxRDtZQVBKLGlEQUFpRDtZQUNqRCxNQUFNQSxXQUFXLE1BQU1yRiwrQ0FBU0EsQ0FBQ2lILGlCQUFpQixDQUFDO2dCQUNqRGhHO2dCQUNBaUcsWUFBWXJGLGdCQUFnQlksRUFBRTtnQkFDOUIwRSxVQUFVSDtZQUNaO1lBRUEsS0FBSTNCLGlCQUFBQSxTQUFTdkIsSUFBSSxjQUFidUIscUNBQUFBLGVBQWV0QixPQUFPLEVBQUU7Z0JBQzFCLDBEQUEwRDtnQkFDMUQsTUFBTXFELGlCQUFpQiw4REFNakIsT0FKWkMsT0FBT0MsT0FBTyxDQUFDTixVQUFVTyxHQUFHLENBQUM7d0JBQUMsQ0FBQ0MsS0FBS0MsTUFBTTtvQkFDMUMsTUFBTUMsUUFBUTdGLGdCQUFnQmdGLFlBQVksQ0FBQ2MsTUFBTSxDQUFDQyxJQUFJLENBQUMsQ0FBQ0MsSUFBV0EsRUFBRXBGLEVBQUUsS0FBSytFO29CQUM1RSxNQUFNTSxRQUFRSixDQUFBQSxrQkFBQUEsNEJBQUFBLE1BQU9JLEtBQUssS0FBSU47b0JBQzlCLE9BQU8sR0FBYUMsT0FBVkssT0FBTSxNQUFVLE9BQU5MO2dCQUN0QixHQUFHTSxJQUFJLENBQUM7Z0JBRUEsMkJBQTJCO2dCQUMzQixNQUFNQyxrQkFBa0IsTUFBTUMsTUFBTSxHQUF5RSxPQUF0RUMsa0NBQStCLElBQUksR0FBbUMsbUJBQWlCO29CQUM1SEcsUUFBUTtvQkFDUkMsU0FBUzt3QkFBRSxnQkFBZ0I7b0JBQW1CO29CQUM5Q0MsTUFBTTlDLEtBQUtTLFNBQVMsQ0FBQzt3QkFDbkJqRjt3QkFDQXdELFlBQVk7d0JBQ1pDLFlBQVl2RDt3QkFDWndELFNBQVN5Qzt3QkFDVHhDLGFBQWE7b0JBQ2Y7Z0JBQ0Y7Z0JBRUEsSUFBSW9ELGdCQUFnQlEsRUFBRSxFQUFFO29CQUN0Qiw2QkFBNkI7b0JBQzdCLE1BQU0zSCxhQUFzQjt3QkFDMUI0QixJQUFJZ0csS0FBS0MsR0FBRyxHQUFHQyxRQUFRO3dCQUN2QjFILGdCQUFnQkE7d0JBQ2hCd0QsWUFBWTt3QkFDWkMsWUFBWXZEO3dCQUNad0QsU0FBU3lDO3dCQUNUeEMsYUFBYTt3QkFDYkMsV0FBVyxJQUFJNEQsT0FBT0csV0FBVztvQkFDbkM7b0JBQ0FoSSxZQUFZa0UsQ0FBQUEsT0FBUTsrQkFBSUE7NEJBQU1qRTt5QkFBVztnQkFDM0M7Z0JBRUFlLG9CQUFvQjtnQkFDcEJFLG1CQUFtQjtZQUNyQjtRQUNGLEVBQUUsT0FBT3VDLE9BQU87WUFDZHJCLFFBQVFxQixLQUFLLENBQUMsOEJBQThCQTtZQUM1Q3dFLE1BQU07UUFDUixTQUFVO1lBQ1I3Ryx3QkFBd0I7UUFDMUI7SUFDRjtJQUVBLE1BQU04RyxxQkFBcUIsT0FBTzNCO1FBQ2hDLElBQUksQ0FBQ2xHLGdCQUFnQjtRQUVyQixJQUFJO2dCQStCRThIO1lBOUJKL0YsUUFBUUMsR0FBRyxDQUFDLHFEQUEyQ2tFO1lBQ3ZEbkUsUUFBUUMsR0FBRyxDQUFDLDZDQUFtQzdDO1lBQy9DNEMsUUFBUUMsR0FBRyxDQUFDLDZDQUFtQ2tFLFNBQVM2QixjQUFjO1lBRXRFLDRCQUE0QjtZQUM1QixNQUFNQyxjQUFjO2dCQUNsQkMsYUFBYS9CLFNBQVMrQixXQUFXO2dCQUNqQ0MsYUFBYWhDLFNBQVNnQyxXQUFXO2dCQUNqQ0MsZUFBZWpDLFNBQVNpQyxhQUFhO2dCQUNyQ0MsZUFBZWxDLFNBQVNrQyxhQUFhO2dCQUNyQ0MsVUFBVW5DLFNBQVNtQyxRQUFRLElBQUk7Z0JBQy9CQyxTQUFTcEMsU0FBU29DLE9BQU87Z0JBQ3pCbkYsT0FBTytDLFNBQVMvQyxLQUFLO2dCQUNyQm9GLG1CQUFtQnJDLFNBQVNxQyxpQkFBaUIsSUFBSTtnQkFDakQsb0RBQW9EO2dCQUNwRFIsZ0JBQWdCN0IsU0FBUzZCLGNBQWMsSUFBSTtnQkFDM0NwRCxZQUFZdUIsU0FBUzZCLGNBQWMsS0FBSyxhQUFhNUksU0FBU3FDLEVBQUUsR0FBRztnQkFDbkV4QixnQkFBZ0JBO2dCQUNoQjRFLFlBQVl0RixLQUFNa0MsRUFBRTtnQkFDcEJ0QixjQUFjQTtnQkFDZEUsZUFBZUE7Z0JBQ2ZFLGVBQWVBO1lBQ2pCO1lBQ0F5QixRQUFRQyxHQUFHLENBQUMsMENBQWdDZ0c7WUFDNUNqRyxRQUFRQyxHQUFHLENBQUMsNkRBQW1EZ0csWUFBWXJELFVBQVU7WUFDckY1QyxRQUFRQyxHQUFHLENBQUMsK0RBQXFEa0UsU0FBUzZCLGNBQWMsRUFBRSxpQkFBaUI1SSxTQUFTcUMsRUFBRTtZQUV0SCx1Q0FBdUM7WUFDdkMsTUFBTXNHLGVBQWUsTUFBTS9JLCtDQUFTQSxDQUFDeUosVUFBVSxDQUFDUjtZQUVoRCxLQUFJRixxQkFBQUEsYUFBYWpGLElBQUksY0FBakJpRix5Q0FBQUEsbUJBQW1CaEYsT0FBTyxFQUFFO2dCQUM5QixNQUFNMkYsY0FBY1gsYUFBYWpGLElBQUksQ0FBQ0EsSUFBSTtnQkFDMUNkLFFBQVFDLEdBQUcsQ0FBQyw0Q0FBNEN5RztnQkFFeEQsNENBQTRDO2dCQUM1QyxJQUFJQyxzQkFBc0IsdUVBR3JCeEMsT0FEWXVDLFlBQVlqSCxFQUFFLEVBQUMsMkJBRTVCMEUsT0FEQ0EsU0FBUytCLFdBQVcsRUFBQywwQkFFdkIvQixPQURDQSxTQUFTb0MsT0FBTyxFQUFDLHlCQUVsQnBDLE9BREFBLFNBQVNpQyxhQUFhLEVBQUMsZUFHaENqQyxPQUZTQSxTQUFTa0MsYUFBYSxJQUFJLHVCQUFzQixRQUsxRCxPQUhDbEMsU0FBUzZCLGNBQWMsS0FBSyxhQUMxQixpREFBdUYsT0FBaEQ1SSxTQUFTd0osWUFBWSxJQUFJeEosU0FBU3lKLGFBQWEsSUFDdEY7Z0JBR0ksMERBQTBEO2dCQUMxRCxJQUFJO29CQUNGLE1BQU03SiwrQ0FBU0EsQ0FBQzhKLFdBQVcsQ0FBQzt3QkFDMUI3STt3QkFDQXdELFlBQVk7d0JBQ1pDLFlBQVl2RDt3QkFDWndELFNBQVNnRjt3QkFDVC9FLGFBQWE7b0JBQ2Y7b0JBRUEsNkJBQTZCO29CQUM3QixNQUFNL0QsYUFBc0I7d0JBQzFCNEIsSUFBSWdHLEtBQUtDLEdBQUcsR0FBR0MsUUFBUTt3QkFDdkIxSCxnQkFBZ0JBO3dCQUNoQndELFlBQVk7d0JBQ1pDLFlBQVl2RDt3QkFDWndELFNBQVNnRjt3QkFDVC9FLGFBQWE7d0JBQ2JDLFdBQVcsSUFBSTRELE9BQU9HLFdBQVc7b0JBQ25DO29CQUNBaEksWUFBWWtFLENBQUFBLE9BQVE7K0JBQUlBOzRCQUFNakU7eUJBQVc7Z0JBQzNDLEVBQUUsT0FBT2tKLFdBQVc7b0JBQ2xCL0csUUFBUXFCLEtBQUssQ0FBQyw2RUFBbUUwRjtnQkFDakYsNkRBQTZEO2dCQUMvRDtnQkFFQSx3QkFBd0I7Z0JBQ3hCbEIsTUFBTSx5Q0FBd0QsT0FBZmEsWUFBWWpILEVBQUU7WUFFL0QsT0FBTztvQkFDV3NHO2dCQUFoQixNQUFNLElBQUlpQixNQUFNakIsRUFBQUEsc0JBQUFBLGFBQWFqRixJQUFJLGNBQWpCaUYsMENBQUFBLG9CQUFtQnBFLE9BQU8sS0FBSTtZQUNoRDtZQUVBL0Msb0JBQW9CO1FBQ3RCLEVBQUUsT0FBT3lDLE9BQVk7WUFDbkJyQixRQUFRcUIsS0FBSyxDQUFDLHdCQUF3QkE7WUFDdEN3RSxNQUFNO1FBQ1I7SUFDRjtJQUVBLE1BQU1pQixjQUFjO1FBQ2xCLElBQUksQ0FBQ2pKLFdBQVd3QyxJQUFJLE1BQU10QyxTQUFTO1FBRW5DLDhDQUE4QztRQUM5QyxJQUFJa0osZUFBZWhKO1FBQ25CLElBQUksQ0FBQ2dKLGNBQWM7WUFDakJqSCxRQUFRQyxHQUFHLENBQUM7WUFDWixNQUFNaUgsWUFBWSxNQUFNaEc7WUFDeEIrRixlQUFlQztZQUNmLElBQUksQ0FBQ0QsY0FBYztnQkFDakJqSCxRQUFRcUIsS0FBSyxDQUFDO2dCQUNkO1lBQ0Y7UUFDRjtRQUVBckQsV0FBVztRQUNYLElBQUk7Z0JBUUVxRTtZQVBKLE1BQU1BLFdBQVcsTUFBTXJGLCtDQUFTQSxDQUFDOEosV0FBVyxDQUFDO2dCQUMzQzdJLGdCQUFnQmdKO2dCQUNoQnhGLFlBQVk7Z0JBQ1pDLFlBQVl2RDtnQkFDWndELFNBQVM5RDtZQUNYO1lBRUEsS0FBSXdFLGlCQUFBQSxTQUFTdkIsSUFBSSxjQUFidUIscUNBQUFBLGVBQWV0QixPQUFPLEVBQUU7b0JBR3BCc0I7Z0JBRk4seUVBQXlFO2dCQUN6RSxNQUFNOEUsU0FBa0I7b0JBQ3RCMUgsSUFBSTRDLEVBQUFBLHNCQUFBQSxTQUFTdkIsSUFBSSxDQUFDQSxJQUFJLGNBQWxCdUIsMENBQUFBLG9CQUFvQmIsU0FBUyxLQUFJaUUsS0FBS0MsR0FBRyxHQUFHQyxRQUFRO29CQUN4RDFILGdCQUFnQmdKO29CQUNoQnhGLFlBQVk7b0JBQ1pDLFlBQVl2RDtvQkFDWndELFNBQVM5RDtvQkFDVGdFLFdBQVcsSUFBSTRELE9BQU9HLFdBQVc7Z0JBQ25DO2dCQUVBaEksWUFBWWtFLENBQUFBLE9BQVE7MkJBQUlBO3dCQUFNcUY7cUJBQU87Z0JBQ3JDckosY0FBYztZQUNoQjtRQUNGLEVBQUUsT0FBT3VELE9BQVk7Z0JBSWZBO1lBSEpyQixRQUFRcUIsS0FBSyxDQUFDLDBCQUEwQkE7WUFFeEMsMERBQTBEO1lBQzFELElBQUlBLENBQUFBLGtCQUFBQSw2QkFBQUEsa0JBQUFBLE1BQU9nQixRQUFRLGNBQWZoQixzQ0FBQUEsZ0JBQWlCa0MsTUFBTSxNQUFLLEtBQUs7Z0JBQ25DdkQsUUFBUUMsR0FBRyxDQUFDO2dCQUNaLE1BQU11RDtnQkFDTiw0QkFBNEI7Z0JBQzVCNEQsV0FBVyxJQUFNTixlQUFlO1lBQ2xDO1FBQ0YsU0FBVTtZQUNSOUksV0FBVztRQUNiO0lBQ0Y7SUFFQSxNQUFNcUosY0FBYztRQUNsQiwyQkFBMkI7UUFDM0J6SixZQUFZLEVBQUU7UUFDZEUsY0FBYztRQUNkSSxrQkFBa0I7UUFDbEJRLGFBQWE7UUFDYnBCO0lBQ0Y7SUFFQSxJQUFJLENBQUNELFFBQVEsT0FBTztJQUVwQixxQkFDRSw4REFBQ2lLO1FBQUlDLFdBQVU7OzBCQUNiLDhEQUFDRDtnQkFBSUMsV0FBVTs7a0NBRWIsOERBQUNEO3dCQUFJQyxXQUFVOzswQ0FDYiw4REFBQ0Q7O2tEQUNDLDhEQUFDRTt3Q0FBR0QsV0FBVTtrREFDWG5LLFNBQVN3SixZQUFZLElBQUl4SixTQUFTeUosYUFBYSxJQUFJLEdBQWdEekosT0FBN0NBLFNBQVMrQyxTQUFTLElBQUkvQyxTQUFTcUssVUFBVSxFQUFDLEtBQTJDLE9BQXhDckssU0FBU2dELFFBQVEsSUFBSWhELFNBQVNzSyxTQUFTOzs7Ozs7a0RBRTdJLDhEQUFDQzt3Q0FBRUosV0FBVTtrREFDVm5LLFNBQVNzRyxlQUFlLElBQUl0RyxTQUFTdUcsZ0JBQWdCOzs7Ozs7Ozs7Ozs7MENBRzFELDhEQUFDaUU7Z0NBQ0NDLFNBQVNSO2dDQUNURSxXQUFVOzBDQUVWLDRFQUFDTztvQ0FBSVAsV0FBVTtvQ0FBVVEsTUFBSztvQ0FBT0MsUUFBTztvQ0FBZUMsU0FBUTs4Q0FDakUsNEVBQUNDO3dDQUFLQyxlQUFjO3dDQUFRQyxnQkFBZTt3Q0FBUUMsYUFBYTt3Q0FBR0MsR0FBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztrQ0FNM0UsOERBQUNoQjt3QkFBSUMsV0FBVTs7NEJBQ1p4SixXQUFXSixTQUFTNEssTUFBTSxLQUFLLGtCQUM5Qiw4REFBQ2pCO2dDQUFJQyxXQUFVOzBDQUE2Qjs7Ozs7dUNBRTVDNUosU0FBUzRHLEdBQUcsQ0FBQyxDQUFDdEMsb0JBQ1osOERBQUNxRjtvQ0FFQ0MsV0FBVyxRQUF3RSxPQUFoRXRGLElBQUlSLFVBQVUsS0FBSyxhQUFhLGdCQUFnQjs4Q0FFbkUsNEVBQUM2Rjt3Q0FDQ0MsV0FBVyx5Q0FJVixPQUhDdEYsSUFBSVIsVUFBVSxLQUFLLGFBQ2YsOERBQ0E7OzBEQUdOLDhEQUFDNkY7MERBQUtyRixJQUFJTixPQUFPOzs7Ozs7NENBR2hCTSxJQUFJTCxXQUFXLEtBQUssbUJBQW1CSyxJQUFJUixVQUFVLEtBQUssNEJBQ3pELDhEQUFDbUc7Z0RBQ0NDLFNBQVMsSUFBTXBFLHdCQUF3QnhCO2dEQUN2Q3NGLFdBQVU7MERBQ1g7Ozs7Ozs0Q0FNRnRGLElBQUlMLFdBQVcsS0FBSyxxQkFBcUJLLElBQUlSLFVBQVUsS0FBSyw0QkFDM0QsOERBQUM2RjtnREFBSUMsV0FBVTswREFDYiw0RUFBQ3pLLDZEQUFvQkE7b0RBQ25CMEwsY0FBY3BMLFNBQVN3SixZQUFZLElBQUl4SixTQUFTeUosYUFBYSxJQUFJLEdBQWdEekosT0FBN0NBLFNBQVMrQyxTQUFTLElBQUkvQyxTQUFTcUssVUFBVSxFQUFDLEtBQTJDLE9BQXhDckssU0FBU2dELFFBQVEsSUFBSWhELFNBQVNzSyxTQUFTO29EQUN4SkcsU0FBUzt3REFDUDNJLGFBQWE7d0RBQ2JOLG9CQUFvQjtvREFDdEI7Ozs7Ozs7Ozs7OzRDQU1McUQsSUFBSUwsV0FBVyxLQUFLLGtDQUNuQiw4REFBQ2dHO2dEQUNDQyxTQUFTO29EQUNQLG9DQUFvQztvREFDcEM3SCxRQUFRQyxHQUFHLENBQUMscURBQTJDZ0M7b0RBQ3ZELElBQUl3RyxTQUFTeEcsSUFBSXdHLE1BQU07b0RBRXZCLHVDQUF1QztvREFDdkMsSUFBSXhHLElBQUluQixJQUFJLEVBQUU7d0RBQ1osSUFBSTs0REFDRixNQUFNNEgsYUFBYSxPQUFPekcsSUFBSW5CLElBQUksS0FBSyxXQUFXMkIsS0FBS0MsS0FBSyxDQUFDVCxJQUFJbkIsSUFBSSxJQUFJbUIsSUFBSW5CLElBQUk7NERBQ2pGZCxRQUFRQyxHQUFHLENBQUMscUNBQTJCeUk7NERBQ3ZDRCxTQUFTQyxXQUFXRCxNQUFNLElBQUlBO3dEQUNoQyxFQUFFLE9BQU85RixHQUFHOzREQUNWM0MsUUFBUUMsR0FBRyxDQUFDLGlDQUFpQ2dDLElBQUluQixJQUFJO3dEQUN2RDtvREFDRjtvREFFQWQsUUFBUUMsR0FBRyxDQUFDLHdDQUE4QndJO29EQUUxQyxJQUFJQSxRQUFRO3dEQUNWLElBQUk7Z0VBR0VwRzs0REFGSixvQ0FBb0M7NERBQ3BDLE1BQU1BLFdBQVcsTUFBTXJGLCtDQUFTQSxDQUFDMkwsT0FBTyxDQUFDRjs0REFDekMsS0FBSXBHLGlCQUFBQSxTQUFTdkIsSUFBSSxjQUFidUIscUNBQUFBLGVBQWV0QixPQUFPLEVBQUU7Z0VBQzFCekIsY0FBYztvRUFDWkcsSUFBSWdKO29FQUNKRCxjQUFjcEwsU0FBU3dKLFlBQVksSUFBSXhKLFNBQVN5SixhQUFhLElBQUksR0FBZ0R6SixPQUE3Q0EsU0FBUytDLFNBQVMsSUFBSS9DLFNBQVNxSyxVQUFVLEVBQUMsS0FBMkMsT0FBeENySyxTQUFTZ0QsUUFBUSxJQUFJaEQsU0FBU3NLLFNBQVM7b0VBQ3hKeEIsYUFBYTdELFNBQVN2QixJQUFJLENBQUNBLElBQUksQ0FBQzhILFlBQVk7b0VBQzVDQyxhQUFheEcsU0FBU3ZCLElBQUksQ0FBQ0EsSUFBSSxDQUFDZ0ksWUFBWTtvRUFDNUMzQyxhQUFhOUQsU0FBU3ZCLElBQUksQ0FBQ0EsSUFBSSxDQUFDcUYsV0FBVztnRUFDN0M7Z0VBQ0EvRyxtQkFBbUI7NERBQ3JCO3dEQUNGLEVBQUUsT0FBT2lDLE9BQU87NERBQ2RyQixRQUFRcUIsS0FBSyxDQUFDLGdDQUFnQ0E7NERBQzlDd0UsTUFBTTt3REFDUjtvREFDRixPQUFPO3dEQUNMQSxNQUFNO29EQUNSO2dEQUNGO2dEQUNBMEIsV0FBVTs7a0VBRVYsOERBQUN3QjtrRUFBSzs7Ozs7O2tFQUNOLDhEQUFDQTtrRUFBSzs7Ozs7Ozs7Ozs7OzBEQUlWLDhEQUFDekI7Z0RBQUlDLFdBQVcsZ0JBRWYsT0FEQ3RGLElBQUlSLFVBQVUsS0FBSyxhQUFhLGtCQUFrQjswREFFakQsSUFBSWdFLEtBQUt4RCxJQUFJSixTQUFTLEVBQUVtSCxrQkFBa0IsQ0FBQyxTQUFTO29EQUNuREMsTUFBTTtvREFDTkMsUUFBUTtnREFDVjs7Ozs7Ozs7Ozs7O21DQTNGQ2pILElBQUl4QyxFQUFFOzs7OzswQ0FpR2pCLDhEQUFDNkg7Z0NBQUk2QixLQUFLNUo7Ozs7Ozs7Ozs7OztvQkFJWGQsMkJBQ0MsOERBQUM2STt3QkFBSUMsV0FBVTs7MENBQ2IsOERBQUNEO2dDQUFJQyxXQUFVOztrREFDYiw4REFBQzZCO3dDQUNDQyxNQUFLO3dDQUNMNUUsT0FBTzVHO3dDQUNQeUwsVUFBVSxDQUFDM0csSUFBTTdFLGNBQWM2RSxFQUFFNEcsTUFBTSxDQUFDOUUsS0FBSzt3Q0FDN0MrRSxZQUFZLENBQUM3RyxJQUFNQSxFQUFFNkIsR0FBRyxLQUFLLFdBQVdzQzt3Q0FDeEMyQyxhQUFZO3dDQUNabEMsV0FBVTt3Q0FDVm1DLFVBQVUzTDs7Ozs7O2tEQUVaLDhEQUFDNko7d0NBQ0NDLFNBQVNmO3dDQUNUNEMsVUFBVSxDQUFDN0wsV0FBV3dDLElBQUksTUFBTXRDO3dDQUNoQ3dKLFdBQVU7a0RBRVR4SixVQUFVLFFBQVE7Ozs7Ozs7Ozs7OzswQ0FLdkIsOERBQUN1SjtnQ0FBSUMsV0FBVTswQ0FDYiw0RUFBQ0s7b0NBQ0NDLFNBQVM7d0NBQ1AzSSxhQUFhO3dDQUNiTixvQkFBb0I7b0NBQ3RCO29DQUNBMkksV0FBVTs7c0RBRVYsOERBQUN3QjtzREFBSzs7Ozs7O3NEQUNOLDhEQUFDQTtzREFBSzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBT2IsQ0FBQ3RLLGFBQWEsQ0FBQ1YseUJBQ2QsOERBQUN1Sjt3QkFBSUMsV0FBVTtrQ0FDYiw0RUFBQ0Q7NEJBQUlDLFdBQVU7OzhDQUNiLDhEQUFDNkI7b0NBQ0NDLE1BQUs7b0NBQ0xJLGFBQVk7b0NBQ1poRixPQUFPdEc7b0NBQ1BtTCxVQUFVLENBQUMzRyxJQUFNdkUsZ0JBQWdCdUUsRUFBRTRHLE1BQU0sQ0FBQzlFLEtBQUs7b0NBQy9DOEMsV0FBVTs7Ozs7OzhDQUVaLDhEQUFDNkI7b0NBQ0NDLE1BQUs7b0NBQ0xJLGFBQVk7b0NBQ1poRixPQUFPcEc7b0NBQ1BpTCxVQUFVLENBQUMzRyxJQUFNckUsaUJBQWlCcUUsRUFBRTRHLE1BQU0sQ0FBQzlFLEtBQUs7b0NBQ2hEOEMsV0FBVTs7Ozs7OzhDQUVaLDhEQUFDNkI7b0NBQ0NDLE1BQUs7b0NBQ0xJLGFBQVk7b0NBQ1poRixPQUFPbEc7b0NBQ1ArSyxVQUFVLENBQUMzRyxJQUFNbkUsaUJBQWlCbUUsRUFBRTRHLE1BQU0sQ0FBQzlFLEtBQUs7b0NBQ2hEOEMsV0FBVTs7Ozs7OzhDQUVaLDhEQUFDSztvQ0FDQ0MsU0FBUyxJQUFNM0c7b0NBQ2Z3SSxVQUFVLENBQUN2TCxnQkFBZ0IsQ0FBQ0U7b0NBQzVCa0osV0FBVTs4Q0FDWDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7WUFTVjVJLGtDQUNDLDhEQUFDOUIseURBQWdCQTtnQkFDZlEsUUFBUXNCO2dCQUNSZ0wsTUFBTTFLO2dCQUNONEUsWUFBWSxFQUFFaEYsNEJBQUFBLHNDQUFBQSxnQkFBaUJnRixZQUFZO2dCQUMzQ3ZHLFNBQVM7b0JBQ1BzQixvQkFBb0I7b0JBQ3BCRSxtQkFBbUI7Z0JBQ3JCO2dCQUNBOEssVUFBVTNLLGNBQWMsYUFBYThFLHVCQUF1QitCO2dCQUM1RCtELGNBQWM5SztnQkFDZHlKLGNBQWNwTCxTQUFTd0osWUFBWSxJQUFJeEosU0FBU3lKLGFBQWEsSUFBSTtnQkFDakVqRSxZQUFZeEYsU0FBU3FDLEVBQUU7Z0JBQ3ZCcUssa0JBQWtCMU0sU0FBU3NHLGVBQWUsSUFBSXRHLFNBQVN1RyxnQkFBZ0I7Z0JBQ3ZFcEYsZUFBZUE7Ozs7OztZQUtsQlksbUJBQW1CRSw0QkFDbEIsOERBQUN0QyxvREFBV0E7Z0JBQ1ZNLFFBQVE4QjtnQkFDUjdCLFNBQVM7b0JBQ1A4QixtQkFBbUI7b0JBQ25CRSxjQUFjO2dCQUNoQjtnQkFDQW1KLFFBQVFwSixXQUFXSSxFQUFFO2dCQUNyQm1ELFlBQVl4RixTQUFTcUMsRUFBRTtnQkFDdkIrSSxjQUFjcEwsU0FBU3dKLFlBQVksSUFBSXhKLFNBQVN5SixhQUFhLElBQUksR0FBZ0R6SixPQUE3Q0EsU0FBUytDLFNBQVMsSUFBSS9DLFNBQVNxSyxVQUFVLEVBQUMsS0FBMkMsT0FBeENySyxTQUFTZ0QsUUFBUSxJQUFJaEQsU0FBU3NLLFNBQVM7Z0JBQ3hKcUMsaUJBQWlCO29CQUNmLHVDQUF1QztvQkFDdkMsTUFBTUMsa0JBQW1CO29CQUl6QixJQUFJO3dCQUNGLE1BQU1oTiwrQ0FBU0EsQ0FBQzhKLFdBQVcsQ0FBQzs0QkFDMUI3SSxnQkFBZ0JBOzRCQUNoQndELFlBQVk7NEJBQ1pDLFlBQVl2RDs0QkFDWndELFNBQVNxSTs0QkFDVHBJLGFBQWE7d0JBQ2Y7d0JBRUEsdUNBQXVDO3dCQUN2QyxNQUFNL0QsYUFBc0I7NEJBQzFCNEIsSUFBSWdHLEtBQUtDLEdBQUcsR0FBR0MsUUFBUTs0QkFDdkIxSCxnQkFBZ0JBOzRCQUNoQndELFlBQVk7NEJBQ1pDLFlBQVl2RDs0QkFDWndELFNBQVNxSTs0QkFDVHBJLGFBQWE7NEJBQ2JDLFdBQVcsSUFBSTRELE9BQU9HLFdBQVc7d0JBQ25DO3dCQUNBaEksWUFBWWtFLENBQUFBLE9BQVE7bUNBQUlBO2dDQUFNakU7NkJBQVc7b0JBQzNDLEVBQUUsT0FBT3dELE9BQU87d0JBQ2RyQixRQUFRcUIsS0FBSyxDQUFDLG9DQUFvQ0E7b0JBQ3BEO29CQUVBakMsbUJBQW1CO29CQUNuQkUsY0FBYztvQkFDZHVHLE1BQU07Z0JBQ1I7Ozs7Ozs7Ozs7OztBQUtSO0dBbHZCd0IxSTs7UUFDWUYsMERBQU9BO1FBQ1RDLDhEQUFTQTs7O0tBRm5CQyIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvY29tcG9uZW50cy9DaGF0TW9kYWwudHN4Pzc4N2MiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBjbGllbnQnXG5cbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0LCB1c2VSZWYgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBTb2NrZXQgfSBmcm9tICdzb2NrZXQuaW8tY2xpZW50JztcbmltcG9ydCBVbmlmaWVkQ2FzZU1vZGFsIGZyb20gJy4vVW5pZmllZENhc2VNb2RhbCc7XG5pbXBvcnQgU2VydmljZVJlcXVlc3RCdXR0b24gZnJvbSAnLi9TZXJ2aWNlUmVxdWVzdEJ1dHRvbic7XG5pbXBvcnQgU3VydmV5TW9kYWwgZnJvbSAnLi9TdXJ2ZXlNb2RhbCc7XG5pbXBvcnQgeyBhcGlDbGllbnQgfSBmcm9tICdAL2xpYi9hcGknXG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnQC9jb250ZXh0cy9BdXRoQ29udGV4dCdcbmltcG9ydCB7IHVzZVNvY2tldCB9IGZyb20gJ0AvY29udGV4dHMvU29ja2V0Q29udGV4dCdcblxuaW50ZXJmYWNlIFNlcnZpY2VQcm92aWRlciB7XG4gIGlkOiBzdHJpbmdcbiAgLy8gU3VwcG9ydCBib3RoIG5hbWluZyBjb252ZW50aW9ucyAtIG1ha2UgYWxsIG9wdGlvbmFsIGFuZCBoYW5kbGUgYm90aFxuICBidXNpbmVzc05hbWU/OiBzdHJpbmdcbiAgYnVzaW5lc3NfbmFtZT86IHN0cmluZ1xuICBzZXJ2aWNlQ2F0ZWdvcnk/OiBzdHJpbmdcbiAgc2VydmljZV9jYXRlZ29yeT86IHN0cmluZ1xuICBkZXNjcmlwdGlvbj86IHN0cmluZ1xuICBleHBlcmllbmNlWWVhcnM/OiBudW1iZXJcbiAgZXhwZXJpZW5jZV95ZWFycz86IG51bWJlclxuICBob3VybHlSYXRlPzogbnVtYmVyXG4gIGhvdXJseV9yYXRlPzogbnVtYmVyXG4gIGNpdHk6IHN0cmluZ1xuICBuZWlnaGJvcmhvb2Q/OiBzdHJpbmdcbiAgcGhvbmVOdW1iZXI/OiBzdHJpbmdcbiAgcGhvbmVfbnVtYmVyPzogc3RyaW5nXG4gIGVtYWlsPzogc3RyaW5nXG4gIHJhdGluZzogbnVtYmVyXG4gIHRvdGFsUmV2aWV3cz86IG51bWJlclxuICB0b3RhbF9yZXZpZXdzPzogbnVtYmVyXG4gIGZpcnN0TmFtZT86IHN0cmluZ1xuICBmaXJzdF9uYW1lPzogc3RyaW5nXG4gIGxhc3ROYW1lPzogc3RyaW5nXG4gIGxhc3RfbmFtZT86IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgTWVzc2FnZSB7XG4gIGlkOiBzdHJpbmdcbiAgY29udmVyc2F0aW9uSWQ6IHN0cmluZ1xuICBzZW5kZXJUeXBlOiAnY3VzdG9tZXInIHwgJ3Byb3ZpZGVyJyB8ICdzeXN0ZW0nXG4gIHNlbmRlck5hbWU6IHN0cmluZ1xuICBtZXNzYWdlOiBzdHJpbmdcbiAgbWVzc2FnZVR5cGU/OiBzdHJpbmdcbiAgdGltZXN0YW1wOiBzdHJpbmdcbiAgZGF0YT86IGFueSAvLyBGb3IgYWRkaXRpb25hbCBtZXNzYWdlIGRhdGEgbGlrZSBjYXNlSWRcbiAgY2FzZUlkPzogc3RyaW5nIC8vIERpcmVjdCBjYXNlIElEIGZvciBzdXJ2ZXkgbWVzc2FnZXNcbn1cblxuaW50ZXJmYWNlIENoYXRNb2RhbFByb3BzIHtcbiAgcHJvdmlkZXI6IFNlcnZpY2VQcm92aWRlclxuICBpc09wZW46IGJvb2xlYW5cbiAgb25DbG9zZTogKCkgPT4gdm9pZFxufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDaGF0TW9kYWwoeyBwcm92aWRlciwgaXNPcGVuLCBvbkNsb3NlIH06IENoYXRNb2RhbFByb3BzKSB7XG4gIGNvbnN0IHsgdXNlciwgaXNBdXRoZW50aWNhdGVkIH0gPSB1c2VBdXRoKClcbiAgY29uc3QgeyBzb2NrZXQsIGlzQ29ubmVjdGVkIH0gPSB1c2VTb2NrZXQoKSAvLyBVc2UgZ2xvYmFsIHNvY2tldCBmcm9tIGNvbnRleHRcbiAgY29uc3QgW21lc3NhZ2VzLCBzZXRNZXNzYWdlc10gPSB1c2VTdGF0ZTxNZXNzYWdlW10+KFtdKVxuICBjb25zdCBbbmV3TWVzc2FnZSwgc2V0TmV3TWVzc2FnZV0gPSB1c2VTdGF0ZSgnJylcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpXG4gIGNvbnN0IFtjb252ZXJzYXRpb25JZCwgc2V0Q29udmVyc2F0aW9uSWRdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbClcbiAgY29uc3QgW2N1c3RvbWVyTmFtZSwgc2V0Q3VzdG9tZXJOYW1lXSA9IHVzZVN0YXRlKCcnKVxuICBjb25zdCBbY3VzdG9tZXJFbWFpbCwgc2V0Q3VzdG9tZXJFbWFpbF0gPSB1c2VTdGF0ZSgnJylcbiAgY29uc3QgW2N1c3RvbWVyUGhvbmUsIHNldEN1c3RvbWVyUGhvbmVdID0gdXNlU3RhdGUoJycpXG4gIGNvbnN0IFtpc1N0YXJ0ZWQsIHNldElzU3RhcnRlZF0gPSB1c2VTdGF0ZShmYWxzZSlcbiAgY29uc3QgW3Nob3dVbmlmaWVkTW9kYWwsIHNldFNob3dVbmlmaWVkTW9kYWxdID0gdXNlU3RhdGUoZmFsc2UpXG4gIGNvbnN0IFtjdXJyZW50VGVtcGxhdGUsIHNldEN1cnJlbnRUZW1wbGF0ZV0gPSB1c2VTdGF0ZTxhbnk+KG51bGwpXG4gIGNvbnN0IFtpc1N1Ym1pdHRpbmdUZW1wbGF0ZSwgc2V0SXNTdWJtaXR0aW5nVGVtcGxhdGVdID0gdXNlU3RhdGUoZmFsc2UpXG4gIGNvbnN0IFttb2RhbE1vZGUsIHNldE1vZGFsTW9kZV0gPSB1c2VTdGF0ZTwndGVtcGxhdGUnIHwgJ2RpcmVjdCc+KCdkaXJlY3QnKVxuICBjb25zdCBbc2hvd1N1cnZleU1vZGFsLCBzZXRTaG93U3VydmV5TW9kYWxdID0gdXNlU3RhdGUoZmFsc2UpXG4gIGNvbnN0IFtzdXJ2ZXlDYXNlLCBzZXRTdXJ2ZXlDYXNlXSA9IHVzZVN0YXRlPGFueT4obnVsbClcbiAgY29uc3QgbWVzc2FnZXNFbmRSZWYgPSB1c2VSZWY8SFRNTERpdkVsZW1lbnQ+KG51bGwpXG5cbiAgLy8gU3RvcmFnZSBrZXlzIGZvciBwZXJzaXN0ZW5jZVxuICBjb25zdCBzdG9yYWdlS2V5ID0gYGNoYXRfJHtwcm92aWRlci5pZH1gXG4gIGNvbnN0IGNvbnZlcnNhdGlvbktleSA9IGBjb252ZXJzYXRpb25fJHtwcm92aWRlci5pZH1gXG5cbiAgY29uc3Qgc2Nyb2xsVG9Cb3R0b20gPSAoKSA9PiB7XG4gICAgbWVzc2FnZXNFbmRSZWYuY3VycmVudD8uc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcgfSlcbiAgfVxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgc2Nyb2xsVG9Cb3R0b20oKVxuICB9LCBbbWVzc2FnZXNdKVxuXG4gIC8vIEluaXRpYWxpemUgdXNlciBkYXRhIG9ubHkgb25jZSB3aGVuIG1vZGFsIG9wZW5zXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgaW5pdGlhbGl6ZUNoYXQgPSBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoaXNPcGVuICYmIGlzQXV0aGVudGljYXRlZCAmJiB1c2VyICYmICFpc1N0YXJ0ZWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfl6jvuI8gQ2hhdE1vZGFsIG9wZW5lZCBmb3IgcHJvdmlkZXI6JywgcHJvdmlkZXIuaWQpXG4gICAgICAgIFxuICAgICAgICBjb25zdCBmdWxsTmFtZSA9IGAke3VzZXIuZmlyc3ROYW1lIHx8ICcnfSAke3VzZXIubGFzdE5hbWUgfHwgJyd9YC50cmltKClcbiAgICAgICAgY29uc3QgZmluYWxOYW1lID0gZnVsbE5hbWUgfHwgJ1VzZXInXG4gICAgICAgIFxuICAgICAgICBzZXRDdXN0b21lck5hbWUoZmluYWxOYW1lKVxuICAgICAgICBzZXRDdXN0b21lckVtYWlsKHVzZXIuZW1haWwgfHwgJycpXG4gICAgICAgIHNldEN1c3RvbWVyUGhvbmUodXNlci5waG9uZU51bWJlciB8fCAnJylcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGZvciBleGlzdGluZyBjb252ZXJzYXRpb25cbiAgICAgICAgY29uc3Qgc2F2ZWRDb252ZXJzYXRpb25JZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGNvbnZlcnNhdGlvbktleSlcbiAgICAgICAgaWYgKHNhdmVkQ29udmVyc2F0aW9uSWQpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+UjSBGb3VuZCBzYXZlZCBjb252ZXJzYXRpb24gSUQ6Jywgc2F2ZWRDb252ZXJzYXRpb25JZClcbiAgICAgICAgICAvLyBWYWxpZGF0ZSB0aGF0IHRoZSBjb252ZXJzYXRpb24gZXhpc3RzIGJ5IHRyeWluZyB0byBsb2FkIG1lc3NhZ2VzXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VzUmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQuZ2V0Q29udmVyc2F0aW9uTWVzc2FnZXMoc2F2ZWRDb252ZXJzYXRpb25JZClcbiAgICAgICAgICAgIGlmIChtZXNzYWdlc1Jlc3BvbnNlLmRhdGE/LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+KchSBTYXZlZCBjb252ZXJzYXRpb24gaXMgdmFsaWQsIHVzaW5nIGl0JylcbiAgICAgICAgICAgICAgc2V0Q29udmVyc2F0aW9uSWQoc2F2ZWRDb252ZXJzYXRpb25JZClcbiAgICAgICAgICAgICAgc2V0SXNTdGFydGVkKHRydWUpXG4gICAgICAgICAgICAgIGxvYWRNZXNzYWdlcyhzYXZlZENvbnZlcnNhdGlvbklkKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+KdjCBTYXZlZCBjb252ZXJzYXRpb24gaXMgaW52YWxpZCwgY3JlYXRpbmcgbmV3IG9uZScpXG4gICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGNvbnZlcnNhdGlvbktleSlcbiAgICAgICAgICAgICAgYXdhaXQgc3RhcnRDb252ZXJzYXRpb24oeyBcbiAgICAgICAgICAgICAgICBuYW1lOiBmaW5hbE5hbWUsIFxuICAgICAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsIHx8ICcnLCBcbiAgICAgICAgICAgICAgICBwaG9uZTogdXNlci5waG9uZU51bWJlciB8fCAnJyBcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+KdjCBFcnJvciB2YWxpZGF0aW5nIHNhdmVkIGNvbnZlcnNhdGlvbiwgY3JlYXRpbmcgbmV3IG9uZTonLCBlcnJvcilcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGNvbnZlcnNhdGlvbktleSlcbiAgICAgICAgICAgIGF3YWl0IHN0YXJ0Q29udmVyc2F0aW9uKHsgXG4gICAgICAgICAgICAgIG5hbWU6IGZpbmFsTmFtZSwgXG4gICAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsIHx8ICcnLCBcbiAgICAgICAgICAgICAgcGhvbmU6IHVzZXIucGhvbmVOdW1iZXIgfHwgJycgXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBBdXRvLXN0YXJ0IGNvbnZlcnNhdGlvbiBmb3IgYXV0aGVudGljYXRlZCB1c2Vyc1xuICAgICAgICAgIGF3YWl0IHN0YXJ0Q29udmVyc2F0aW9uKHsgXG4gICAgICAgICAgICBuYW1lOiBmaW5hbE5hbWUsIFxuICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwgfHwgJycsIFxuICAgICAgICAgICAgcGhvbmU6IHVzZXIucGhvbmVOdW1iZXIgfHwgJycgXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBpbml0aWFsaXplQ2hhdCgpXG4gIH0sIFtpc09wZW4sIGlzQXV0aGVudGljYXRlZCwgdXNlciwgcHJvdmlkZXIuaWRdKVxuXG4gIC8vIEpvaW4gY29udmVyc2F0aW9uIHJvb20gd2hlbiBtb2RhbCBvcGVuc1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghaXNPcGVuIHx8ICFjb252ZXJzYXRpb25JZCB8fCAhc29ja2V0IHx8ICFpc0Nvbm5lY3RlZCkgcmV0dXJuXG5cbiAgICBjb25zb2xlLmxvZygn8J+PoCBDaGF0TW9kYWwgLSBKb2luaW5nIGNvbnZlcnNhdGlvbiByb29tOicsIGNvbnZlcnNhdGlvbklkKVxuICAgIHNvY2tldC5lbWl0KCdqb2luLWNvbnZlcnNhdGlvbicsIGNvbnZlcnNhdGlvbklkKVxuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5qqIENoYXRNb2RhbCAtIExlYXZpbmcgY29udmVyc2F0aW9uIHJvb206JywgY29udmVyc2F0aW9uSWQpXG4gICAgICAvLyBEb24ndCBkaXNjb25uZWN0IHRoZSBnbG9iYWwgc29ja2V0LCBqdXN0IGxlYXZlIHRoZSByb29tXG4gICAgfVxuICB9LCBbaXNPcGVuLCBjb252ZXJzYXRpb25JZCwgc29ja2V0LCBpc0Nvbm5lY3RlZF0pXG5cbiAgLy8gU2V0dXAgcmVhbC10aW1lIG1lc3NhZ2UgbGlzdGVuZXJzXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFzb2NrZXQgfHwgIWNvbnZlcnNhdGlvbklkKSByZXR1cm5cblxuICAgIGNvbnN0IGhhbmRsZU5ld01lc3NhZ2UgPSAoZGF0YTogYW55KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygn8J+SrCBDdXN0b21lciByZWNlaXZlZCBuZXcgbWVzc2FnZTonLCBkYXRhKVxuICAgICAgXG4gICAgICAvLyBPbmx5IGFkZCBtZXNzYWdlcyBmcm9tIHByb3ZpZGVycyAobm90IG91ciBvd24gbWVzc2FnZXMpXG4gICAgICBpZiAoZGF0YS5jb252ZXJzYXRpb25JZCA9PT0gY29udmVyc2F0aW9uSWQgJiYgZGF0YS5tZXNzYWdlSWQgJiYgZGF0YS5zZW5kZXJUeXBlID09PSAncHJvdmlkZXInKSB7XG4gICAgICAgIGNvbnN0IG5ld01lc3NhZ2U6IE1lc3NhZ2UgPSB7XG4gICAgICAgICAgaWQ6IGRhdGEubWVzc2FnZUlkLFxuICAgICAgICAgIGNvbnZlcnNhdGlvbklkOiBkYXRhLmNvbnZlcnNhdGlvbklkLFxuICAgICAgICAgIHNlbmRlclR5cGU6IGRhdGEuc2VuZGVyVHlwZSxcbiAgICAgICAgICBzZW5kZXJOYW1lOiBkYXRhLnNlbmRlck5hbWUsXG4gICAgICAgICAgbWVzc2FnZTogZGF0YS5tZXNzYWdlLFxuICAgICAgICAgIG1lc3NhZ2VUeXBlOiBkYXRhLm1lc3NhZ2VUeXBlLFxuICAgICAgICAgIHRpbWVzdGFtcDogZGF0YS50aW1lc3RhbXBcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2V0TWVzc2FnZXMocHJldiA9PiB7XG4gICAgICAgICAgY29uc3QgbWVzc2FnZUV4aXN0cyA9IHByZXYuc29tZShtc2cgPT4gbXNnLmlkID09PSBkYXRhLm1lc3NhZ2VJZClcbiAgICAgICAgICBpZiAobWVzc2FnZUV4aXN0cykgcmV0dXJuIHByZXZcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+TnSBBZGRpbmcgcHJvdmlkZXIgbWVzc2FnZSB0byBjdXN0b21lciBjaGF0OicsIG5ld01lc3NhZ2UpXG4gICAgICAgICAgcmV0dXJuIFsuLi5wcmV2LCBuZXdNZXNzYWdlXVxuICAgICAgICB9KVxuICAgICAgICBzY3JvbGxUb0JvdHRvbSgpXG4gICAgICB9XG4gICAgfVxuXG4gICAgc29ja2V0Lm9uKCduZXdfbWVzc2FnZScsIGhhbmRsZU5ld01lc3NhZ2UpXG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgc29ja2V0Lm9mZignbmV3X21lc3NhZ2UnLCBoYW5kbGVOZXdNZXNzYWdlKVxuICAgIH1cbiAgfSwgW3NvY2tldCwgY29udmVyc2F0aW9uSWRdKVxuXG4gIGNvbnN0IHN0YXJ0Q29udmVyc2F0aW9uID0gYXN5bmMgKG92ZXJyaWRlRGF0YT86IHsgbmFtZT86IHN0cmluZywgZW1haWw/OiBzdHJpbmcsIHBob25lPzogc3RyaW5nIH0pID0+IHtcbiAgICBpZiAobG9hZGluZyB8fCBpc1N0YXJ0ZWQgfHwgY29udmVyc2F0aW9uSWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfij63vuI8gU2tpcHBpbmcgY29udmVyc2F0aW9uIGNyZWF0aW9uIC0gYWxyZWFkeSBleGlzdHMgb3IgaW4gcHJvZ3Jlc3MnKVxuICAgICAgcmV0dXJuIGNvbnZlcnNhdGlvbklkXG4gICAgfVxuXG4gICAgc2V0TG9hZGluZyh0cnVlKVxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+RpCBVc2VyIG9iamVjdDonLCB1c2VyKVxuICAgICAgY29uc29sZS5sb2coJ/CfkaQgVXNlciBJRDonLCB1c2VyPy5pZClcbiAgICAgIGNvbnNvbGUubG9nKCfwn5GkIFVzZXIgdHlwZTonLCB0eXBlb2YgdXNlcj8uaWQpXG4gICAgICBcbiAgICAgIC8vIEdldCB1c2VyIElEIGZyb20gdXNlciBvYmplY3Qgb3IgZmFsbGJhY2sgdG8gbG9jYWxTdG9yYWdlXG4gICAgICBsZXQgdXNlcklkID0gdXNlcj8uaWRcbiAgICAgIGlmICghdXNlcklkKSB7XG4gICAgICAgIGNvbnN0IHVzZXJEYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJfZGF0YScpIHx8IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyJylcbiAgICAgICAgaWYgKHVzZXJEYXRhKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZFVzZXIgPSBKU09OLnBhcnNlKHVzZXJEYXRhKVxuICAgICAgICAgICAgdXNlcklkID0gcGFyc2VkVXNlci5pZFxuICAgICAgICAgICAgY29uc29sZS5sb2coJ/Cfk6YgR290IHVzZXIgSUQgZnJvbSBsb2NhbFN0b3JhZ2U6JywgdXNlcklkKVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSB1c2VyIGRhdGEgZnJvbSBsb2NhbFN0b3JhZ2U6JywgZSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgcHJvdmlkZXJJZDogcHJvdmlkZXIuaWQsXG4gICAgICAgIGN1c3RvbWVySWQ6IHVzZXJJZCB8fCB1bmRlZmluZWQsIC8vIEFkZCBhdXRoZW50aWNhdGVkIHVzZXIgSURcbiAgICAgICAgY3VzdG9tZXJOYW1lOiBvdmVycmlkZURhdGE/Lm5hbWUgfHwgY3VzdG9tZXJOYW1lLFxuICAgICAgICBjdXN0b21lckVtYWlsOiBvdmVycmlkZURhdGE/LmVtYWlsIHx8IGN1c3RvbWVyRW1haWwsXG4gICAgICAgIGN1c3RvbWVyUGhvbmU6IG92ZXJyaWRlRGF0YT8ucGhvbmUgfHwgY3VzdG9tZXJQaG9uZVxuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZygn8J+agCBTdGFydGluZyBjb252ZXJzYXRpb24gd2l0aCBkYXRhOicsIGRhdGEpXG4gICAgICBjb25zb2xlLmxvZygn8J+agCBjdXN0b21lcklkIGluIGRhdGE6JywgZGF0YS5jdXN0b21lcklkLCAndHlwZTonLCB0eXBlb2YgZGF0YS5jdXN0b21lcklkKVxuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaUNsaWVudC5jcmVhdGVPckdldENvbnZlcnNhdGlvbihkYXRhKVxuICAgICAgXG4gICAgICBpZiAocmVzcG9uc2UuZGF0YT8uc3VjY2VzcyAmJiByZXNwb25zZS5kYXRhPy5kYXRhPy5jb252ZXJzYXRpb25JZCkge1xuICAgICAgICBjb25zdCBuZXdDb252ZXJzYXRpb25JZCA9IHJlc3BvbnNlLmRhdGEuZGF0YS5jb252ZXJzYXRpb25JZFxuICAgICAgICBzZXRDb252ZXJzYXRpb25JZChuZXdDb252ZXJzYXRpb25JZClcbiAgICAgICAgc2V0SXNTdGFydGVkKHRydWUpXG4gICAgICAgIFxuICAgICAgICAvLyBTYXZlIHRvIGxvY2FsU3RvcmFnZVxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShzdG9yYWdlS2V5LCBKU09OLnN0cmluZ2lmeShkYXRhKSlcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY29udmVyc2F0aW9uS2V5LCBuZXdDb252ZXJzYXRpb25JZClcbiAgICAgICAgXG4gICAgICAgIC8vIExvYWQgZXhpc3RpbmcgbWVzc2FnZXNcbiAgICAgICAgYXdhaXQgbG9hZE1lc3NhZ2VzKG5ld0NvbnZlcnNhdGlvbklkKVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIG5ld0NvbnZlcnNhdGlvbklkXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN0YXJ0aW5nIGNvbnZlcnNhdGlvbjonLCBlcnJvcilcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSlcbiAgICB9XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGNvbnN0IGxvYWRNZXNzYWdlcyA9IGFzeW5jIChjb252SWQ6IHN0cmluZykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBzZXRMb2FkaW5nKHRydWUpXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaUNsaWVudC5nZXRNYXJrZXRwbGFjZU1lc3NhZ2VzKGNvbnZJZClcbiAgICAgIGlmIChyZXNwb25zZS5kYXRhPy5zdWNjZXNzICYmIEFycmF5LmlzQXJyYXkocmVzcG9uc2UuZGF0YS5kYXRhKSkge1xuICAgICAgICBzZXRNZXNzYWdlcyhyZXNwb25zZS5kYXRhLmRhdGEpXG4gICAgICAgIHNjcm9sbFRvQm90dG9tKClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIG1lc3NhZ2VzOicsIGVycm9yKVxuICAgICAgLy8gSWYgY29udmVyc2F0aW9uIGRvZXNuJ3QgZXhpc3QsIGF1dG8tcmVjcmVhdGUgaXRcbiAgICAgIGlmIChlcnJvcj8ucmVzcG9uc2U/LnN0YXR1cyA9PT0gNDA0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SnIENvbnZlcnNhdGlvbiBub3QgZm91bmQsIGF0dGVtcHRpbmcgdG8gcmVjcmVhdGUuLi4nKVxuICAgICAgICBhd2FpdCByZWNyZWF0ZUNvbnZlcnNhdGlvbigpXG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldExvYWRpbmcoZmFsc2UpXG4gICAgfVxuICB9XG5cbiAgY29uc3QgcmVjcmVhdGVDb252ZXJzYXRpb24gPSBhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIHByb3ZpZGVySWQ6IHByb3ZpZGVyLmlkLFxuICAgICAgICBjdXN0b21lck5hbWU6IGN1c3RvbWVyTmFtZSxcbiAgICAgICAgY3VzdG9tZXJFbWFpbDogY3VzdG9tZXJFbWFpbCxcbiAgICAgICAgY3VzdG9tZXJQaG9uZTogY3VzdG9tZXJQaG9uZVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaUNsaWVudC5jcmVhdGVPckdldENvbnZlcnNhdGlvbihkYXRhKVxuICAgICAgaWYgKHJlc3BvbnNlLmRhdGE/LnN1Y2Nlc3MgJiYgcmVzcG9uc2UuZGF0YT8uZGF0YT8uY29udmVyc2F0aW9uSWQpIHtcbiAgICAgICAgY29uc3QgbmV3Q29udmVyc2F0aW9uSWQgPSByZXNwb25zZS5kYXRhLmRhdGEuY29udmVyc2F0aW9uSWRcbiAgICAgICAgc2V0Q29udmVyc2F0aW9uSWQobmV3Q29udmVyc2F0aW9uSWQpXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGNvbnZlcnNhdGlvbktleSwgbmV3Q29udmVyc2F0aW9uSWQpXG4gICAgICAgIGNvbnNvbGUubG9nKCfinIUgQ29udmVyc2F0aW9uIHJlY3JlYXRlZDonLCBuZXdDb252ZXJzYXRpb25JZClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHJlY3JlYXRlIGNvbnZlcnNhdGlvbjonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICBjb25zdCBoYW5kbGVDYXNlVGVtcGxhdGVDbGljayA9IGFzeW5jIChtZXNzYWdlOiBNZXNzYWdlKSA9PiB7XG4gICAgaWYgKG1lc3NhZ2UubWVzc2FnZVR5cGUgIT09ICdjYXNlX3RlbXBsYXRlJykgcmV0dXJuO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICAvLyBHZXQgdGhlIHNlcnZpY2UgY2F0ZWdvcnkgZnJvbSBwcm92aWRlclxuICAgICAgY29uc3Qgc2VydmljZUNhdGVnb3J5ID0gcHJvdmlkZXIuc2VydmljZUNhdGVnb3J5IHx8IHByb3ZpZGVyLnNlcnZpY2VfY2F0ZWdvcnkgfHwgJ2dlbmVyYWwnO1xuICAgICAgXG4gICAgICAvLyBGZXRjaCB0aGUgY2FzZSB0ZW1wbGF0ZVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQuZ2V0Q2FzZVRlbXBsYXRlKHNlcnZpY2VDYXRlZ29yeSk7XG4gICAgICBcbiAgICAgIGlmIChyZXNwb25zZS5kYXRhPy5zdWNjZXNzICYmIHJlc3BvbnNlLmRhdGE/LmRhdGEpIHtcbiAgICAgICAgY29uc3QgdGVtcGxhdGVEYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZS5kYXRhLmRhdGEudGVtcGxhdGVfZGF0YSk7XG4gICAgICAgIHNldEN1cnJlbnRUZW1wbGF0ZSh7XG4gICAgICAgICAgLi4ucmVzcG9uc2UuZGF0YS5kYXRhLFxuICAgICAgICAgIHRlbXBsYXRlRGF0YVxuICAgICAgICB9KTtcbiAgICAgICAgc2V0TW9kYWxNb2RlKCd0ZW1wbGF0ZScpO1xuICAgICAgICBzZXRTaG93VW5pZmllZE1vZGFsKHRydWUpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIGNhc2UgdGVtcGxhdGU6JywgZXJyb3IpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBoYW5kbGVUZW1wbGF0ZVN1Ym1pdCA9IGFzeW5jIChmb3JtRGF0YTogUmVjb3JkPHN0cmluZywgYW55PikgPT4ge1xuICAgIGlmICghY29udmVyc2F0aW9uSWQgfHwgIWN1cnJlbnRUZW1wbGF0ZSkgcmV0dXJuO1xuXG4gICAgc2V0SXNTdWJtaXR0aW5nVGVtcGxhdGUodHJ1ZSk7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENyZWF0ZSBvciB1cGRhdGUgc2VydmljZSBjYXNlIHdpdGggZmlsbGVkIGRhdGFcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpQ2xpZW50LmNyZWF0ZVNlcnZpY2VDYXNlKHtcbiAgICAgICAgY29udmVyc2F0aW9uSWQsXG4gICAgICAgIHRlbXBsYXRlSWQ6IGN1cnJlbnRUZW1wbGF0ZS5pZCxcbiAgICAgICAgY2FzZURhdGE6IGZvcm1EYXRhXG4gICAgICB9KTtcblxuICAgICAgaWYgKHJlc3BvbnNlLmRhdGE/LnN1Y2Nlc3MpIHtcbiAgICAgICAgLy8gU2VuZCBhIG1lc3NhZ2UgdG8gdGhlIHByb3ZpZGVyIHdpdGggdGhlIGZpbGxlZCB0ZW1wbGF0ZVxuICAgICAgICBjb25zdCBzdW1tYXJ5TWVzc2FnZSA9IGDwn5OLINCf0L7Qv9GK0LvQvdC40YUg0YTQvtGA0LzQsNGC0LAg0YEg0LjQvdGE0L7RgNC80LDRhtC40Y8g0LfQsCDQv9GA0L7QsdC70LXQvNCwOlxuXG4ke09iamVjdC5lbnRyaWVzKGZvcm1EYXRhKS5tYXAoKFtrZXksIHZhbHVlXSkgPT4ge1xuICBjb25zdCBmaWVsZCA9IGN1cnJlbnRUZW1wbGF0ZS50ZW1wbGF0ZURhdGEuZmllbGRzLmZpbmQoKGY6IGFueSkgPT4gZi5pZCA9PT0ga2V5KTtcbiAgY29uc3QgbGFiZWwgPSBmaWVsZD8ubGFiZWwgfHwga2V5O1xuICByZXR1cm4gYCR7bGFiZWx9OiAke3ZhbHVlfWA7XG59KS5qb2luKCdcXG4nKX1gO1xuXG4gICAgICAgIC8vIFNlbmQgdGhlIHN1bW1hcnkgbWVzc2FnZVxuICAgICAgICBjb25zdCBtZXNzYWdlUmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BUElfVVJMIHx8ICdodHRwOi8vMTkyLjE2OC4wLjEyOTozMDAwL2FwaS92MSd9L2NoYXQvbWVzc2FnZXNgLCB7XG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgY29udmVyc2F0aW9uSWQsXG4gICAgICAgICAgICBzZW5kZXJUeXBlOiAnY3VzdG9tZXInLFxuICAgICAgICAgICAgc2VuZGVyTmFtZTogY3VzdG9tZXJOYW1lLFxuICAgICAgICAgICAgbWVzc2FnZTogc3VtbWFyeU1lc3NhZ2UsXG4gICAgICAgICAgICBtZXNzYWdlVHlwZTogJ2Nhc2VfZmlsbGVkJ1xuICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChtZXNzYWdlUmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAvLyBBZGQgbWVzc2FnZSB0byBsb2NhbCBzdGF0ZVxuICAgICAgICAgIGNvbnN0IG5ld01lc3NhZ2U6IE1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxuICAgICAgICAgICAgY29udmVyc2F0aW9uSWQ6IGNvbnZlcnNhdGlvbklkISxcbiAgICAgICAgICAgIHNlbmRlclR5cGU6ICdjdXN0b21lcicsXG4gICAgICAgICAgICBzZW5kZXJOYW1lOiBjdXN0b21lck5hbWUsXG4gICAgICAgICAgICBtZXNzYWdlOiBzdW1tYXJ5TWVzc2FnZSxcbiAgICAgICAgICAgIG1lc3NhZ2VUeXBlOiAnY2FzZV9maWxsZWQnLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICB9O1xuICAgICAgICAgIHNldE1lc3NhZ2VzKHByZXYgPT4gWy4uLnByZXYsIG5ld01lc3NhZ2VdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNldFNob3dVbmlmaWVkTW9kYWwoZmFsc2UpO1xuICAgICAgICBzZXRDdXJyZW50VGVtcGxhdGUobnVsbCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN1Ym1pdHRpbmcgdGVtcGxhdGU6JywgZXJyb3IpXG4gICAgICBhbGVydCgn0JLRitC30L3QuNC60L3QsCDQs9GA0LXRiNC60LAg0L/RgNC4INC40LfQv9GA0LDRidCw0L3QtdGC0L4g0L3QsCDRhNC+0YDQvNCw0YLQsCcpXG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzU3VibWl0dGluZ1RlbXBsYXRlKGZhbHNlKVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGhhbmRsZUNhc2VDcmVhdGlvbiA9IGFzeW5jIChjYXNlRGF0YTogYW55KSA9PiB7XG4gICAgaWYgKCFjb252ZXJzYXRpb25JZCkgcmV0dXJuXG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OLIENoYXRNb2RhbCAtIENyZWF0aW5nIGNhc2Ugd2l0aCBkYXRhOicsIGNhc2VEYXRhKVxuICAgICAgY29uc29sZS5sb2coJ/Cfk4sgQ2hhdE1vZGFsIC0gUHJvdmlkZXIgb2JqZWN0OicsIHByb3ZpZGVyKVxuICAgICAgY29uc29sZS5sb2coJ/Cfk4sgQ2hhdE1vZGFsIC0gQXNzaWdubWVudCB0eXBlOicsIGNhc2VEYXRhLmFzc2lnbm1lbnRUeXBlKVxuICAgICAgXG4gICAgICAvLyBQcmVwYXJlIGNhc2UgZGF0YSBmb3IgQVBJXG4gICAgICBjb25zdCBjYXNlUGF5bG9hZCA9IHtcbiAgICAgICAgc2VydmljZVR5cGU6IGNhc2VEYXRhLnNlcnZpY2VUeXBlLFxuICAgICAgICBkZXNjcmlwdGlvbjogY2FzZURhdGEuZGVzY3JpcHRpb24sXG4gICAgICAgIHByZWZlcnJlZERhdGU6IGNhc2VEYXRhLnByZWZlcnJlZERhdGUsXG4gICAgICAgIHByZWZlcnJlZFRpbWU6IGNhc2VEYXRhLnByZWZlcnJlZFRpbWUsXG4gICAgICAgIHByaW9yaXR5OiBjYXNlRGF0YS5wcmlvcml0eSB8fCAnbm9ybWFsJyxcbiAgICAgICAgYWRkcmVzczogY2FzZURhdGEuYWRkcmVzcyxcbiAgICAgICAgcGhvbmU6IGNhc2VEYXRhLnBob25lLFxuICAgICAgICBhZGRpdGlvbmFsRGV0YWlsczogY2FzZURhdGEuYWRkaXRpb25hbERldGFpbHMgfHwgJycsXG4gICAgICAgIC8vIEhhbmRsZSBhc3NpZ25tZW50IGJhc2VkIG9uIFwi0YLQuNC/INC30LDRj9Cy0LrQsFwiIHNlbGVjdGlvblxuICAgICAgICBhc3NpZ25tZW50VHlwZTogY2FzZURhdGEuYXNzaWdubWVudFR5cGUgfHwgJ3NwZWNpZmljJyxcbiAgICAgICAgcHJvdmlkZXJJZDogY2FzZURhdGEuYXNzaWdubWVudFR5cGUgPT09ICdzcGVjaWZpYycgPyBwcm92aWRlci5pZCA6IG51bGwsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBjb252ZXJzYXRpb25JZCxcbiAgICAgICAgY3VzdG9tZXJJZDogdXNlciEuaWQsIC8vIEFkZCB0aGUgYWN0dWFsIHVzZXIgSURcbiAgICAgICAgY3VzdG9tZXJOYW1lOiBjdXN0b21lck5hbWUsXG4gICAgICAgIGN1c3RvbWVyRW1haWw6IGN1c3RvbWVyRW1haWwsXG4gICAgICAgIGN1c3RvbWVyUGhvbmU6IGN1c3RvbWVyUGhvbmVcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKCfwn5OLIENoYXRNb2RhbCAtIENhc2UgcGF5bG9hZDonLCBjYXNlUGF5bG9hZClcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OLIENoYXRNb2RhbCAtIEZpbmFsIHByb3ZpZGVySWQgZm9yIGFzc2lnbm1lbnQ6JywgY2FzZVBheWxvYWQucHJvdmlkZXJJZClcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OLIENoYXRNb2RhbCAtIEFzc2lnbm1lbnQgbG9naWM6IGFzc2lnbm1lbnRUeXBlID0nLCBjYXNlRGF0YS5hc3NpZ25tZW50VHlwZSwgJ3Byb3ZpZGVyLmlkID0nLCBwcm92aWRlci5pZClcblxuICAgICAgLy8gQ3JlYXRlIHRoZSBhY3R1YWwgY2FzZSBpbiB0aGUgc3lzdGVtXG4gICAgICBjb25zdCBjYXNlUmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQuY3JlYXRlQ2FzZShjYXNlUGF5bG9hZClcbiAgICAgIFxuICAgICAgaWYgKGNhc2VSZXNwb25zZS5kYXRhPy5zdWNjZXNzKSB7XG4gICAgICAgIGNvbnN0IGNyZWF0ZWRDYXNlID0gY2FzZVJlc3BvbnNlLmRhdGEuZGF0YVxuICAgICAgICBjb25zb2xlLmxvZygn4pyFIENoYXRNb2RhbCAtIENhc2UgY3JlYXRlZCBzdWNjZXNzZnVsbHk6JywgY3JlYXRlZENhc2UpXG5cbiAgICAgICAgLy8gQ3JlYXRlIGEgbm90aWZpY2F0aW9uIG1lc3NhZ2UgaW4gdGhlIGNoYXRcbiAgICAgICAgbGV0IG5vdGlmaWNhdGlvbk1lc3NhZ2UgPSBg4pyFINCX0LDRj9Cy0LrQsNGC0LAg0LUg0YHRitC30LTQsNC00LXQvdCwINGD0YHQv9C10YjQvdC+IVxuXG7wn5OLINCd0L7QvNC10YAg0L3QsCDQt9Cw0Y/QstC60LDRgtCwOiAjJHtjcmVhdGVkQ2FzZS5pZH1cbvCflKcg0KPRgdC70YPQs9CwOiAke2Nhc2VEYXRhLnNlcnZpY2VUeXBlfVxu8J+TjSDQkNC00YDQtdGBOiAke2Nhc2VEYXRhLmFkZHJlc3N9XG7wn5OFINCU0LDRgtCwOiAke2Nhc2VEYXRhLnByZWZlcnJlZERhdGV9XG7ij7Ag0JLRgNC10LzQtTogJHtjYXNlRGF0YS5wcmVmZXJyZWRUaW1lIHx8ICfQodGD0YLRgNC40L0gKDg6MDAtMTI6MDApJ31cblxuJHtjYXNlRGF0YS5hc3NpZ25tZW50VHlwZSA9PT0gJ3NwZWNpZmljJyBcbiAgPyBg8J+OryDQl9Cw0Y/QstC60LDRgtCwINC1INC90LDRgdC+0YfQtdC90LAg0LTQuNGA0LXQutGC0L3QviDQutGK0LwgJHtwcm92aWRlci5idXNpbmVzc05hbWUgfHwgcHJvdmlkZXIuYnVzaW5lc3NfbmFtZX1gXG4gIDogJ/CfjJAg0JfQsNGP0LLQutCw0YLQsCDQtSDQv9C+0YHRgtCw0LLQtdC90LAg0LIg0L7QsdGJ0LDRgtCwINC+0L/QsNGI0LrQsCDQt9CwINCy0YHQuNGH0LrQuCDRgdC/0LXRhtC40LDQu9C40YHRgtC4J1xufWBcblxuICAgICAgICAvLyBUcnkgdG8gc2VuZCBub3RpZmljYXRpb24gbWVzc2FnZSB0byBjaGF0IChub24tY3JpdGljYWwpXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgYXBpQ2xpZW50LnNlbmRNZXNzYWdlKHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbklkLFxuICAgICAgICAgICAgc2VuZGVyVHlwZTogJ2N1c3RvbWVyJyxcbiAgICAgICAgICAgIHNlbmRlck5hbWU6IGN1c3RvbWVyTmFtZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IG5vdGlmaWNhdGlvbk1lc3NhZ2UsXG4gICAgICAgICAgICBtZXNzYWdlVHlwZTogJ2Nhc2VfY3JlYXRlZCdcbiAgICAgICAgICB9KVxuXG4gICAgICAgICAgLy8gQWRkIG1lc3NhZ2UgdG8gbG9jYWwgc3RhdGVcbiAgICAgICAgICBjb25zdCBuZXdNZXNzYWdlOiBNZXNzYWdlID0ge1xuICAgICAgICAgICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbklkOiBjb252ZXJzYXRpb25JZCEsXG4gICAgICAgICAgICBzZW5kZXJUeXBlOiAnY3VzdG9tZXInLFxuICAgICAgICAgICAgc2VuZGVyTmFtZTogY3VzdG9tZXJOYW1lLFxuICAgICAgICAgICAgbWVzc2FnZTogbm90aWZpY2F0aW9uTWVzc2FnZSxcbiAgICAgICAgICAgIG1lc3NhZ2VUeXBlOiAnY2FzZV9jcmVhdGVkJyxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgfVxuICAgICAgICAgIHNldE1lc3NhZ2VzKHByZXYgPT4gWy4uLnByZXYsIG5ld01lc3NhZ2VdKVxuICAgICAgICB9IGNhdGNoIChjaGF0RXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfwn5OLIENoYXRNb2RhbCAtIEZhaWxlZCB0byBzZW5kIGNoYXQgbm90aWZpY2F0aW9uIChub24tY3JpdGljYWwpOicsIGNoYXRFcnJvcilcbiAgICAgICAgICAvLyBEb24ndCB0aHJvdyBlcnJvciBoZXJlIHNpbmNlIGNhc2Ugd2FzIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTaG93IHN1Y2Nlc3MgZmVlZGJhY2tcbiAgICAgICAgYWxlcnQoYNCX0LDRj9Cy0LrQsNGC0LAg0LUg0YHRitC30LTQsNC00LXQvdCwINGD0YHQv9C10YjQvdC+ISDQndC+0LzQtdGAOiAjJHtjcmVhdGVkQ2FzZS5pZH1gKVxuICAgICAgICBcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihjYXNlUmVzcG9uc2UuZGF0YT8ubWVzc2FnZSB8fCAn0JPRgNC10YjQutCwINC/0YDQuCDRgdGK0LfQtNCw0LLQsNC90LXRgtC+INC90LAg0LfQsNGP0LLQutCw0YLQsCcpXG4gICAgICB9XG4gICAgICBcbiAgICAgIHNldFNob3dVbmlmaWVkTW9kYWwoZmFsc2UpXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzZTonLCBlcnJvcilcbiAgICAgIGFsZXJ0KCfQktGK0LfQvdC40LrQvdCwINCz0YDQtdGI0LrQsCDQv9GA0Lgg0YHRitC30LTQsNCy0LDQvdC10YLQviDQvdCwINC30LDRj9Cy0LrQsNGC0LAnKVxuICAgIH1cbiAgfTtcblxuICBjb25zdCBzZW5kTWVzc2FnZSA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIW5ld01lc3NhZ2UudHJpbSgpIHx8IGxvYWRpbmcpIHJldHVyblxuXG4gICAgLy8gSWYgbm8gY29udmVyc2F0aW9uIGV4aXN0cywgY3JlYXRlIG9uZSBmaXJzdFxuICAgIGxldCBhY3RpdmVDb252SWQgPSBjb252ZXJzYXRpb25JZFxuICAgIGlmICghYWN0aXZlQ29udklkKSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+UpyBObyBjb252ZXJzYXRpb24gZm91bmQsIGNyZWF0aW5nIG5ldyBvbmUuLi4nKVxuICAgICAgY29uc3QgbmV3Q29udklkID0gYXdhaXQgc3RhcnRDb252ZXJzYXRpb24oKVxuICAgICAgYWN0aXZlQ29udklkID0gbmV3Q29udklkXG4gICAgICBpZiAoIWFjdGl2ZUNvbnZJZCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRmFpbGVkIHRvIGNyZWF0ZSBjb252ZXJzYXRpb24nKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRMb2FkaW5nKHRydWUpXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpQ2xpZW50LnNlbmRNZXNzYWdlKHtcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGFjdGl2ZUNvbnZJZCxcbiAgICAgICAgc2VuZGVyVHlwZTogJ2N1c3RvbWVyJyxcbiAgICAgICAgc2VuZGVyTmFtZTogY3VzdG9tZXJOYW1lLFxuICAgICAgICBtZXNzYWdlOiBuZXdNZXNzYWdlXG4gICAgICB9KVxuXG4gICAgICBpZiAocmVzcG9uc2UuZGF0YT8uc3VjY2Vzcykge1xuICAgICAgICAvLyBBZGQgY3VzdG9tZXIgbWVzc2FnZSB0byBVSSBpbW1lZGlhdGVseSAod29uJ3QgY29tZSBiYWNrIHZpYSBXZWJTb2NrZXQpXG4gICAgICAgIGNvbnN0IG5ld01zZzogTWVzc2FnZSA9IHtcbiAgICAgICAgICBpZDogcmVzcG9uc2UuZGF0YS5kYXRhPy5tZXNzYWdlSWQgfHwgRGF0ZS5ub3coKS50b1N0cmluZygpLFxuICAgICAgICAgIGNvbnZlcnNhdGlvbklkOiBhY3RpdmVDb252SWQsXG4gICAgICAgICAgc2VuZGVyVHlwZTogJ2N1c3RvbWVyJyxcbiAgICAgICAgICBzZW5kZXJOYW1lOiBjdXN0b21lck5hbWUsXG4gICAgICAgICAgbWVzc2FnZTogbmV3TWVzc2FnZSxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBzZXRNZXNzYWdlcyhwcmV2ID0+IFsuLi5wcmV2LCBuZXdNc2ddKVxuICAgICAgICBzZXROZXdNZXNzYWdlKCcnKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgbWVzc2FnZTonLCBlcnJvcilcbiAgICAgIFxuICAgICAgLy8gSWYgY29udmVyc2F0aW9uIHdhcyBkZWxldGVkLCB0cnkgdG8gcmVjcmVhdGUgYW5kIHJlc2VuZFxuICAgICAgaWYgKGVycm9yPy5yZXNwb25zZT8uc3RhdHVzID09PSA0MDQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ/CflKcgQ29udmVyc2F0aW9uIGRlbGV0ZWQsIHJlY3JlYXRpbmcgYW5kIHJldHJ5aW5nLi4uJylcbiAgICAgICAgYXdhaXQgcmVjcmVhdGVDb252ZXJzYXRpb24oKVxuICAgICAgICAvLyBSZXRyeSBzZW5kaW5nIHRoZSBtZXNzYWdlXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gc2VuZE1lc3NhZ2UoKSwgMTAwMClcbiAgICAgIH1cbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSlcbiAgICB9XG4gIH1cblxuICBjb25zdCBoYW5kbGVDbG9zZSA9ICgpID0+IHtcbiAgICAvLyBSZXNldCBzdGF0ZSB3aGVuIGNsb3NpbmdcbiAgICBzZXRNZXNzYWdlcyhbXSlcbiAgICBzZXROZXdNZXNzYWdlKCcnKVxuICAgIHNldENvbnZlcnNhdGlvbklkKG51bGwpXG4gICAgc2V0SXNTdGFydGVkKGZhbHNlKVxuICAgIG9uQ2xvc2UoKVxuICB9XG5cbiAgaWYgKCFpc09wZW4pIHJldHVybiBudWxsXG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cImZpeGVkIGluc2V0LTAgYmctYmxhY2svNzAgYmFja2Ryb3AtYmx1ci1zbSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciB6LTUwXCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLXNsYXRlLTgwMCByb3VuZGVkLXhsIHNoYWRvdy0yeGwgdy1mdWxsIG1heC13LW1kIG14LTQgaC05NiBmbGV4IGZsZXgtY29sIGJvcmRlciBib3JkZXItd2hpdGUvMjBcIj5cbiAgICAgICAgey8qIEhlYWRlciAqL31cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJiZy1ncmFkaWVudC10by1yIGZyb20taW5kaWdvLTYwMCB0by1wdXJwbGUtNjAwIHRleHQtd2hpdGUgcC00IHJvdW5kZWQtdC14bCBmbGV4IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1jZW50ZXJcIj5cbiAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPGgzIGNsYXNzTmFtZT1cImZvbnQtc2VtaWJvbGRcIj5cbiAgICAgICAgICAgICAge3Byb3ZpZGVyLmJ1c2luZXNzTmFtZSB8fCBwcm92aWRlci5idXNpbmVzc19uYW1lIHx8IGAke3Byb3ZpZGVyLmZpcnN0TmFtZSB8fCBwcm92aWRlci5maXJzdF9uYW1lfSAke3Byb3ZpZGVyLmxhc3ROYW1lIHx8IHByb3ZpZGVyLmxhc3RfbmFtZX1gfVxuICAgICAgICAgICAgPC9oMz5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC13aGl0ZS84MFwiPlxuICAgICAgICAgICAgICB7cHJvdmlkZXIuc2VydmljZUNhdGVnb3J5IHx8IHByb3ZpZGVyLnNlcnZpY2VfY2F0ZWdvcnl9XG4gICAgICAgICAgICA8L3A+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgb25DbGljaz17aGFuZGxlQ2xvc2V9XG4gICAgICAgICAgICBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlLzgwIGhvdmVyOnRleHQtd2hpdGUgdHJhbnNpdGlvbi1jb2xvcnNcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxzdmcgY2xhc3NOYW1lPVwidy02IGgtNlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPlxuICAgICAgICAgICAgICA8cGF0aCBzdHJva2VMaW5lY2FwPVwicm91bmRcIiBzdHJva2VMaW5lam9pbj1cInJvdW5kXCIgc3Ryb2tlV2lkdGg9ezJ9IGQ9XCJNNiAxOEwxOCA2TTYgNmwxMiAxMlwiIC8+XG4gICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgey8qIE1lc3NhZ2VzICovfVxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBvdmVyZmxvdy15LWF1dG8gcC00IHNwYWNlLXktMyBiZy1zbGF0ZS05MDAvNTBcIj5cbiAgICAgICAgICB7bG9hZGluZyAmJiBtZXNzYWdlcy5sZW5ndGggPT09IDAgPyAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyIHRleHQtc2xhdGUtNDAwXCI+0JfQsNGA0LXQttC00LDQvdC1Li4uPC9kaXY+XG4gICAgICAgICAgKSA6IChcbiAgICAgICAgICAgIG1lc3NhZ2VzLm1hcCgobXNnKSA9PiAoXG4gICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICBrZXk9e21zZy5pZH1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BmbGV4ICR7bXNnLnNlbmRlclR5cGUgPT09ICdjdXN0b21lcicgPyAnanVzdGlmeS1lbmQnIDogJ2p1c3RpZnktc3RhcnQnfWB9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BtYXgtdy14cyBweC0zIHB5LTIgcm91bmRlZC1sZyB0ZXh0LXNtICR7XG4gICAgICAgICAgICAgICAgICAgIG1zZy5zZW5kZXJUeXBlID09PSAnY3VzdG9tZXInXG4gICAgICAgICAgICAgICAgICAgICAgPyAnYmctZ3JhZGllbnQtdG8tciBmcm9tLWluZGlnby02MDAgdG8tcHVycGxlLTYwMCB0ZXh0LXdoaXRlJ1xuICAgICAgICAgICAgICAgICAgICAgIDogJ2JnLXNsYXRlLTcwMCB0ZXh0LXNsYXRlLTEwMCBib3JkZXIgYm9yZGVyLXNsYXRlLTYwMCdcbiAgICAgICAgICAgICAgICAgIH1gfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIDxkaXY+e21zZy5tZXNzYWdlfTwvZGl2PlxuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICB7LyogU2hvdyB0ZW1wbGF0ZSBidXR0b24gZm9yIGNhc2VfdGVtcGxhdGUgbWVzc2FnZXMgKi99XG4gICAgICAgICAgICAgICAgICB7bXNnLm1lc3NhZ2VUeXBlID09PSAnY2FzZV90ZW1wbGF0ZScgJiYgbXNnLnNlbmRlclR5cGUgPT09ICdwcm92aWRlcicgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlQ2FzZVRlbXBsYXRlQ2xpY2sobXNnKX1cbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJtdC0yIHB4LTMgcHktMSBiZy1ncmFkaWVudC10by1yIGZyb20taW5kaWdvLTUwMCB0by1wdXJwbGUtNTAwIHRleHQtd2hpdGUgdGV4dC14cyByb3VuZGVkIGhvdmVyOnNoYWRvdy1sZyB0cmFuc2Zvcm0gaG92ZXI6c2NhbGUtMTA1IHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTMwMFwiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICDwn5OLINCf0L7Qv9GK0LvQvdC4INGE0L7RgNC80LDRgtCwXG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgey8qIFNob3cgc2VydmljZSByZXF1ZXN0IGJ1dHRvbiBmb3Igc2VydmljZV9yZXF1ZXN0IG1lc3NhZ2VzICovfVxuICAgICAgICAgICAgICAgICAge21zZy5tZXNzYWdlVHlwZSA9PT0gJ3NlcnZpY2VfcmVxdWVzdCcgJiYgbXNnLnNlbmRlclR5cGUgPT09ICdwcm92aWRlcicgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm10LTJcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8U2VydmljZVJlcXVlc3RCdXR0b24gXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlck5hbWU9e3Byb3ZpZGVyLmJ1c2luZXNzTmFtZSB8fCBwcm92aWRlci5idXNpbmVzc19uYW1lIHx8IGAke3Byb3ZpZGVyLmZpcnN0TmFtZSB8fCBwcm92aWRlci5maXJzdF9uYW1lfSAke3Byb3ZpZGVyLmxhc3ROYW1lIHx8IHByb3ZpZGVyLmxhc3RfbmFtZX1gfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRNb2RhbE1vZGUoJ2RpcmVjdCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRTaG93VW5pZmllZE1vZGFsKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgICAgICAgIHsvKiBTaG93IHN1cnZleSBidXR0b24gZm9yIHN1cnZleV9yZXF1ZXN0IG1lc3NhZ2VzICovfVxuICAgICAgICAgICAgICAgICAge21zZy5tZXNzYWdlVHlwZSA9PT0gJ3N1cnZleV9yZXF1ZXN0JyAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXthc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBFeHRyYWN0IGNhc2UgSUQgZnJvbSBtZXNzYWdlIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIFN1cnZleSBidXR0b24gY2xpY2tlZCwgbWVzc2FnZSBkYXRhOicsIG1zZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2FzZUlkID0gbXNnLmNhc2VJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IHRvIHBhcnNlIGRhdGEgZmllbGQgaWYgaXQgZXhpc3RzXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobXNnLmRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWREYXRhID0gdHlwZW9mIG1zZy5kYXRhID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UobXNnLmRhdGEpIDogbXNnLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ/CflI0gUGFyc2VkIG1lc3NhZ2UgZGF0YTonLCBwYXJzZWREYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlSWQgPSBwYXJzZWREYXRhLmNhc2VJZCB8fCBjYXNlSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQ291bGQgbm90IHBhcnNlIG1lc3NhZ2UgZGF0YTonLCBtc2cuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ/CflI0gRmluYWwgY2FzZUlkIGV4dHJhY3RlZDonLCBjYXNlSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FzZUlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmV0Y2ggY2FzZSBkZXRhaWxzIGZvciB0aGUgc3VydmV5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQuZ2V0Q2FzZShjYXNlSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhPy5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRTdXJ2ZXlDYXNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNhc2VJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJOYW1lOiBwcm92aWRlci5idXNpbmVzc05hbWUgfHwgcHJvdmlkZXIuYnVzaW5lc3NfbmFtZSB8fCBgJHtwcm92aWRlci5maXJzdE5hbWUgfHwgcHJvdmlkZXIuZmlyc3RfbmFtZX0gJHtwcm92aWRlci5sYXN0TmFtZSB8fCBwcm92aWRlci5sYXN0X25hbWV9YCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZVR5cGU6IHJlc3BvbnNlLmRhdGEuZGF0YS5zZXJ2aWNlX3R5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZEF0OiByZXNwb25zZS5kYXRhLmRhdGEuY29tcGxldGVkX2F0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogcmVzcG9uc2UuZGF0YS5kYXRhLmRlc2NyaXB0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFNob3dTdXJ2ZXlNb2RhbCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzZSBkZXRhaWxzOicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydCgn0JLRitC30L3QuNC60L3QsCDQs9GA0LXRiNC60LAg0L/RgNC4INC30LDRgNC10LbQtNCw0L3QtdGC0L4g0L3QsCDQtNC10YLQsNC50LvQuNGC0LUg0LfQsCDQt9Cw0Y/QstC60LDRgtCwJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfQndC1INC80L7QttC1INC00LAg0YHQtSDQvdCw0LzQtdGA0LggSUQg0L3QsCDQt9Cw0Y/QstC60LDRgtCwJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJtdC0yIHB4LTQgcHktMiBiZy1ncmFkaWVudC10by1yIGZyb20teWVsbG93LTUwMCB0by1vcmFuZ2UtNTAwIHRleHQtd2hpdGUgdGV4dC1zbSByb3VuZGVkLWxnIGhvdmVyOmZyb20teWVsbG93LTYwMCBob3Zlcjp0by1vcmFuZ2UtNjAwIHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTIwMCBmbGV4IGl0ZW1zLWNlbnRlciBzcGFjZS14LTJcIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgPHNwYW4+4q2QPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPtCe0YbQtdC90LXRgtC1INGD0YHQu9GD0LPQsNGC0LA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2B0ZXh0LXhzIG10LTEgJHtcbiAgICAgICAgICAgICAgICAgICAgbXNnLnNlbmRlclR5cGUgPT09ICdjdXN0b21lcicgPyAndGV4dC13aGl0ZS82MCcgOiAndGV4dC1zbGF0ZS00MDAnXG4gICAgICAgICAgICAgICAgICB9YH0+XG4gICAgICAgICAgICAgICAgICAgIHtuZXcgRGF0ZShtc2cudGltZXN0YW1wKS50b0xvY2FsZVRpbWVTdHJpbmcoJ2JnLUJHJywge1xuICAgICAgICAgICAgICAgICAgICAgIGhvdXI6ICcyLWRpZ2l0JyxcbiAgICAgICAgICAgICAgICAgICAgICBtaW51dGU6ICcyLWRpZ2l0J1xuICAgICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICkpXG4gICAgICAgICAgKX1cbiAgICAgICAgICA8ZGl2IHJlZj17bWVzc2FnZXNFbmRSZWZ9IC8+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIHsvKiBJbnB1dCBTZWN0aW9uICovfVxuICAgICAgICB7aXNTdGFydGVkICYmIChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJvcmRlci10IGJvcmRlci1zbGF0ZS03MDAgcC00IGJnLXNsYXRlLTgwMC81MFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IHNwYWNlLXgtMiBtYi0zXCI+XG4gICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICB2YWx1ZT17bmV3TWVzc2FnZX1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldE5ld01lc3NhZ2UoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICAgIG9uS2V5UHJlc3M9eyhlKSA9PiBlLmtleSA9PT0gJ0VudGVyJyAmJiBzZW5kTWVzc2FnZSgpfVxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwi0J3QsNC/0LjRiNC10YLQtSDRgdGK0L7QsdGJ0LXQvdC40LUuLi5cIlxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsZXgtMSBiZy1zbGF0ZS03MDAgYm9yZGVyIGJvcmRlci1zbGF0ZS02MDAgdGV4dC13aGl0ZSByb3VuZGVkLWxnIHB4LTMgcHktMiB0ZXh0LXNtIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1pbmRpZ28tNTAwIHBsYWNlaG9sZGVyOnRleHQtc2xhdGUtNDAwXCJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17bG9hZGluZ31cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3NlbmRNZXNzYWdlfVxuICAgICAgICAgICAgICAgIGRpc2FibGVkPXshbmV3TWVzc2FnZS50cmltKCkgfHwgbG9hZGluZ31cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJiZy1ncmFkaWVudC10by1yIGZyb20taW5kaWdvLTYwMCB0by1wdXJwbGUtNjAwIHRleHQtd2hpdGUgcHgtNCBweS0yIHJvdW5kZWQtbGcgZGlzYWJsZWQ6b3BhY2l0eS01MCBkaXNhYmxlZDpjdXJzb3Itbm90LWFsbG93ZWQgaG92ZXI6c2hhZG93LWxnIHRyYW5zZm9ybSBob3ZlcjpzY2FsZS0xMDUgdHJhbnNpdGlvbi1hbGwgZHVyYXRpb24tMzAwXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHtsb2FkaW5nID8gJy4uLicgOiAn0JjQt9C/0YDQsNGC0LgnfVxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgXG4gICAgICAgICAgICB7LyogUXVpY2sgQWN0aW9uIEJ1dHRvbiAqL31cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgICAgc2V0TW9kYWxNb2RlKCdkaXJlY3QnKTtcbiAgICAgICAgICAgICAgICAgIHNldFNob3dVbmlmaWVkTW9kYWwodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJiZy1ncmFkaWVudC10by1yIGZyb20tZ3JlZW4tNTAwIHRvLWJsdWUtNTAwIHRleHQtd2hpdGUgcHgtNCBweS0yIHJvdW5kZWQtbGcgdGV4dC1zbSBmb250LW1lZGl1bSBob3Zlcjpmcm9tLWdyZWVuLTYwMCBob3Zlcjp0by1ibHVlLTYwMCB0cmFuc2l0aW9uLWFsbCBkdXJhdGlvbi0yMDAgZmxleCBpdGVtcy1jZW50ZXIgc3BhY2UteC0yXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxzcGFuPvCflKc8L3NwYW4+XG4gICAgICAgICAgICAgICAgPHNwYW4+0KHRitC30LTQsNC5INC30LDRj9Cy0LrQsCDQt9CwINGD0YHQu9GD0LPQsDwvc3Bhbj5cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKX1cblxuICAgICAgICB7LyogU3RhcnQgQ2hhdCBGb3JtICovfVxuICAgICAgICB7IWlzU3RhcnRlZCAmJiAhbG9hZGluZyAmJiAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTQgYm9yZGVyLXQgYm9yZGVyLXNsYXRlLTcwMCBiZy1zbGF0ZS04MDAvNTBcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0zXCI+XG4gICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cItCS0LDRiNC10YLQviDQuNC80LVcIlxuICAgICAgICAgICAgICAgIHZhbHVlPXtjdXN0b21lck5hbWV9XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRDdXN0b21lck5hbWUoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBiZy1zbGF0ZS03MDAgYm9yZGVyIGJvcmRlci1zbGF0ZS02MDAgdGV4dC13aGl0ZSByb3VuZGVkLWxnIHB4LTMgcHktMiB0ZXh0LXNtIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1pbmRpZ28tNTAwIHBsYWNlaG9sZGVyOnRleHQtc2xhdGUtNDAwXCJcbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgdHlwZT1cImVtYWlsXCJcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkVtYWlsINCw0LTRgNC10YFcIlxuICAgICAgICAgICAgICAgIHZhbHVlPXtjdXN0b21lckVtYWlsfVxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0Q3VzdG9tZXJFbWFpbChlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIGJnLXNsYXRlLTcwMCBib3JkZXIgYm9yZGVyLXNsYXRlLTYwMCB0ZXh0LXdoaXRlIHJvdW5kZWQtbGcgcHgtMyBweS0yIHRleHQtc20gZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOnJpbmctMiBmb2N1czpyaW5nLWluZGlnby01MDAgcGxhY2Vob2xkZXI6dGV4dC1zbGF0ZS00MDBcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICB0eXBlPVwidGVsXCJcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cItCi0LXQu9C10YTQvtC9XCJcbiAgICAgICAgICAgICAgICB2YWx1ZT17Y3VzdG9tZXJQaG9uZX1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEN1c3RvbWVyUGhvbmUoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBiZy1zbGF0ZS03MDAgYm9yZGVyIGJvcmRlci1zbGF0ZS02MDAgdGV4dC13aGl0ZSByb3VuZGVkLWxnIHB4LTMgcHktMiB0ZXh0LXNtIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1pbmRpZ28tNTAwIHBsYWNlaG9sZGVyOnRleHQtc2xhdGUtNDAwXCJcbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHN0YXJ0Q29udmVyc2F0aW9uKCl9XG4gICAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFjdXN0b21lck5hbWUgfHwgIWN1c3RvbWVyRW1haWx9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIGJnLWdyYWRpZW50LXRvLXIgZnJvbS1pbmRpZ28tNjAwIHRvLXB1cnBsZS02MDAgdGV4dC13aGl0ZSBweS0yIHJvdW5kZWQtbGcgZGlzYWJsZWQ6b3BhY2l0eS01MCBkaXNhYmxlZDpjdXJzb3Itbm90LWFsbG93ZWQgaG92ZXI6c2hhZG93LWxnIHRyYW5zZm9ybSBob3ZlcjpzY2FsZS0xMDUgdHJhbnNpdGlvbi1hbGwgZHVyYXRpb24tMzAwXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgINCX0LDQv9C+0YfQvdC4INGA0LDQt9Cz0L7QstC+0YBcbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKX1cbiAgICA8L2Rpdj5cblxuICAgIHsvKiBVbmlmaWVkIENhc2UgTW9kYWwgKi99XG4gICAge3Nob3dVbmlmaWVkTW9kYWwgJiYgKFxuICAgICAgPFVuaWZpZWRDYXNlTW9kYWxcbiAgICAgICAgaXNPcGVuPXtzaG93VW5pZmllZE1vZGFsfVxuICAgICAgICBtb2RlPXttb2RhbE1vZGV9XG4gICAgICAgIHRlbXBsYXRlRGF0YT17Y3VycmVudFRlbXBsYXRlPy50ZW1wbGF0ZURhdGF9XG4gICAgICAgIG9uQ2xvc2U9eygpID0+IHtcbiAgICAgICAgICBzZXRTaG93VW5pZmllZE1vZGFsKGZhbHNlKTtcbiAgICAgICAgICBzZXRDdXJyZW50VGVtcGxhdGUobnVsbCk7XG4gICAgICAgIH19XG4gICAgICAgIG9uU3VibWl0PXttb2RhbE1vZGUgPT09ICd0ZW1wbGF0ZScgPyBoYW5kbGVUZW1wbGF0ZVN1Ym1pdCA6IGhhbmRsZUNhc2VDcmVhdGlvbn1cbiAgICAgICAgaXNTdWJtaXR0aW5nPXtpc1N1Ym1pdHRpbmdUZW1wbGF0ZX1cbiAgICAgICAgcHJvdmlkZXJOYW1lPXtwcm92aWRlci5idXNpbmVzc05hbWUgfHwgcHJvdmlkZXIuYnVzaW5lc3NfbmFtZSB8fCAn0YHQv9C10YbQuNCw0LvQuNGB0YLQsCd9XG4gICAgICAgIHByb3ZpZGVySWQ9e3Byb3ZpZGVyLmlkfVxuICAgICAgICBwcm92aWRlckNhdGVnb3J5PXtwcm92aWRlci5zZXJ2aWNlQ2F0ZWdvcnkgfHwgcHJvdmlkZXIuc2VydmljZV9jYXRlZ29yeX1cbiAgICAgICAgY3VzdG9tZXJQaG9uZT17Y3VzdG9tZXJQaG9uZX1cbiAgICAgIC8+XG4gICAgKX1cblxuICAgIHsvKiBTdXJ2ZXkgTW9kYWwgKi99XG4gICAge3Nob3dTdXJ2ZXlNb2RhbCAmJiBzdXJ2ZXlDYXNlICYmIChcbiAgICAgIDxTdXJ2ZXlNb2RhbFxuICAgICAgICBpc09wZW49e3Nob3dTdXJ2ZXlNb2RhbH1cbiAgICAgICAgb25DbG9zZT17KCkgPT4ge1xuICAgICAgICAgIHNldFNob3dTdXJ2ZXlNb2RhbChmYWxzZSk7XG4gICAgICAgICAgc2V0U3VydmV5Q2FzZShudWxsKTtcbiAgICAgICAgfX1cbiAgICAgICAgY2FzZUlkPXtzdXJ2ZXlDYXNlLmlkfVxuICAgICAgICBwcm92aWRlcklkPXtwcm92aWRlci5pZH1cbiAgICAgICAgcHJvdmlkZXJOYW1lPXtwcm92aWRlci5idXNpbmVzc05hbWUgfHwgcHJvdmlkZXIuYnVzaW5lc3NfbmFtZSB8fCBgJHtwcm92aWRlci5maXJzdE5hbWUgfHwgcHJvdmlkZXIuZmlyc3RfbmFtZX0gJHtwcm92aWRlci5sYXN0TmFtZSB8fCBwcm92aWRlci5sYXN0X25hbWV9YH1cbiAgICAgICAgb25TdWJtaXRTdWNjZXNzPXthc3luYyAoKSA9PiB7XG4gICAgICAgICAgLy8gU2VuZCBhIHRoYW5rIHlvdSBtZXNzYWdlIHRvIHRoZSBjaGF0XG4gICAgICAgICAgY29uc3QgdGhhbmtZb3VNZXNzYWdlID0gYOKchSDQkdC70LDQs9C+0LTQsNGA0LjQvCDQstC4INC30LAg0L7RhtC10L3QutCw0YLQsCEgXG5cbtCS0LDRiNC10YLQviDQvNC90LXQvdC40LUg0LUg0LLQsNC20L3QviDQt9CwINC90LDRgSDQuCDQv9C+0LzQsNCz0LAg0L3QsCDQtNGA0YPQs9C4INC60LvQuNC10L3RgtC4INC00LAg0L3QsNC/0YDQsNCy0Y/RgiDQv9GA0LDQstC40LvQvdC40Y8g0LjQt9Cx0L7RgC5gO1xuXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGFwaUNsaWVudC5zZW5kTWVzc2FnZSh7XG4gICAgICAgICAgICAgIGNvbnZlcnNhdGlvbklkOiBjb252ZXJzYXRpb25JZCEsXG4gICAgICAgICAgICAgIHNlbmRlclR5cGU6ICdjdXN0b21lcicsXG4gICAgICAgICAgICAgIHNlbmRlck5hbWU6IGN1c3RvbWVyTmFtZSxcbiAgICAgICAgICAgICAgbWVzc2FnZTogdGhhbmtZb3VNZXNzYWdlLFxuICAgICAgICAgICAgICBtZXNzYWdlVHlwZTogJ3RleHQnXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gQWRkIHRoYW5rIHlvdSBtZXNzYWdlIHRvIGxvY2FsIHN0YXRlXG4gICAgICAgICAgICBjb25zdCBuZXdNZXNzYWdlOiBNZXNzYWdlID0ge1xuICAgICAgICAgICAgICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxuICAgICAgICAgICAgICBjb252ZXJzYXRpb25JZDogY29udmVyc2F0aW9uSWQhLFxuICAgICAgICAgICAgICBzZW5kZXJUeXBlOiAnY3VzdG9tZXInLFxuICAgICAgICAgICAgICBzZW5kZXJOYW1lOiBjdXN0b21lck5hbWUsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IHRoYW5rWW91TWVzc2FnZSxcbiAgICAgICAgICAgICAgbWVzc2FnZVR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzZXRNZXNzYWdlcyhwcmV2ID0+IFsuLi5wcmV2LCBuZXdNZXNzYWdlXSk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgdGhhbmsgeW91IG1lc3NhZ2U6JywgZXJyb3IpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHNldFNob3dTdXJ2ZXlNb2RhbChmYWxzZSk7XG4gICAgICAgICAgc2V0U3VydmV5Q2FzZShudWxsKTtcbiAgICAgICAgICBhbGVydCgn0JHQu9Cw0LPQvtC00LDRgNC40Lwg0LLQuCDQt9CwINC+0YbQtdC90LrQsNGC0LAhJyk7XG4gICAgICAgIH19XG4gICAgICAvPlxuICAgICl9XG4gIDwvZGl2PlxuKVxufVxuIl0sIm5hbWVzIjpbIlJlYWN0IiwidXNlU3RhdGUiLCJ1c2VFZmZlY3QiLCJ1c2VSZWYiLCJVbmlmaWVkQ2FzZU1vZGFsIiwiU2VydmljZVJlcXVlc3RCdXR0b24iLCJTdXJ2ZXlNb2RhbCIsImFwaUNsaWVudCIsInVzZUF1dGgiLCJ1c2VTb2NrZXQiLCJDaGF0TW9kYWwiLCJwcm92aWRlciIsImlzT3BlbiIsIm9uQ2xvc2UiLCJ1c2VyIiwiaXNBdXRoZW50aWNhdGVkIiwic29ja2V0IiwiaXNDb25uZWN0ZWQiLCJtZXNzYWdlcyIsInNldE1lc3NhZ2VzIiwibmV3TWVzc2FnZSIsInNldE5ld01lc3NhZ2UiLCJsb2FkaW5nIiwic2V0TG9hZGluZyIsImNvbnZlcnNhdGlvbklkIiwic2V0Q29udmVyc2F0aW9uSWQiLCJjdXN0b21lck5hbWUiLCJzZXRDdXN0b21lck5hbWUiLCJjdXN0b21lckVtYWlsIiwic2V0Q3VzdG9tZXJFbWFpbCIsImN1c3RvbWVyUGhvbmUiLCJzZXRDdXN0b21lclBob25lIiwiaXNTdGFydGVkIiwic2V0SXNTdGFydGVkIiwic2hvd1VuaWZpZWRNb2RhbCIsInNldFNob3dVbmlmaWVkTW9kYWwiLCJjdXJyZW50VGVtcGxhdGUiLCJzZXRDdXJyZW50VGVtcGxhdGUiLCJpc1N1Ym1pdHRpbmdUZW1wbGF0ZSIsInNldElzU3VibWl0dGluZ1RlbXBsYXRlIiwibW9kYWxNb2RlIiwic2V0TW9kYWxNb2RlIiwic2hvd1N1cnZleU1vZGFsIiwic2V0U2hvd1N1cnZleU1vZGFsIiwic3VydmV5Q2FzZSIsInNldFN1cnZleUNhc2UiLCJtZXNzYWdlc0VuZFJlZiIsInN0b3JhZ2VLZXkiLCJpZCIsImNvbnZlcnNhdGlvbktleSIsInNjcm9sbFRvQm90dG9tIiwiY3VycmVudCIsInNjcm9sbEludG9WaWV3IiwiYmVoYXZpb3IiLCJpbml0aWFsaXplQ2hhdCIsImNvbnNvbGUiLCJsb2ciLCJmdWxsTmFtZSIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwidHJpbSIsImZpbmFsTmFtZSIsImVtYWlsIiwicGhvbmVOdW1iZXIiLCJzYXZlZENvbnZlcnNhdGlvbklkIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsIm1lc3NhZ2VzUmVzcG9uc2UiLCJnZXRDb252ZXJzYXRpb25NZXNzYWdlcyIsImRhdGEiLCJzdWNjZXNzIiwibG9hZE1lc3NhZ2VzIiwicmVtb3ZlSXRlbSIsInN0YXJ0Q29udmVyc2F0aW9uIiwibmFtZSIsInBob25lIiwiZXJyb3IiLCJlbWl0IiwiaGFuZGxlTmV3TWVzc2FnZSIsIm1lc3NhZ2VJZCIsInNlbmRlclR5cGUiLCJzZW5kZXJOYW1lIiwibWVzc2FnZSIsIm1lc3NhZ2VUeXBlIiwidGltZXN0YW1wIiwicHJldiIsIm1lc3NhZ2VFeGlzdHMiLCJzb21lIiwibXNnIiwib24iLCJvZmYiLCJvdmVycmlkZURhdGEiLCJyZXNwb25zZSIsInVzZXJJZCIsInVzZXJEYXRhIiwicGFyc2VkVXNlciIsIkpTT04iLCJwYXJzZSIsImUiLCJwcm92aWRlcklkIiwiY3VzdG9tZXJJZCIsInVuZGVmaW5lZCIsImNyZWF0ZU9yR2V0Q29udmVyc2F0aW9uIiwibmV3Q29udmVyc2F0aW9uSWQiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwiY29udklkIiwiZ2V0TWFya2V0cGxhY2VNZXNzYWdlcyIsIkFycmF5IiwiaXNBcnJheSIsInN0YXR1cyIsInJlY3JlYXRlQ29udmVyc2F0aW9uIiwiaGFuZGxlQ2FzZVRlbXBsYXRlQ2xpY2siLCJzZXJ2aWNlQ2F0ZWdvcnkiLCJzZXJ2aWNlX2NhdGVnb3J5IiwiZ2V0Q2FzZVRlbXBsYXRlIiwidGVtcGxhdGVEYXRhIiwidGVtcGxhdGVfZGF0YSIsImhhbmRsZVRlbXBsYXRlU3VibWl0IiwiZm9ybURhdGEiLCJjcmVhdGVTZXJ2aWNlQ2FzZSIsInRlbXBsYXRlSWQiLCJjYXNlRGF0YSIsInN1bW1hcnlNZXNzYWdlIiwiT2JqZWN0IiwiZW50cmllcyIsIm1hcCIsImtleSIsInZhbHVlIiwiZmllbGQiLCJmaWVsZHMiLCJmaW5kIiwiZiIsImxhYmVsIiwiam9pbiIsIm1lc3NhZ2VSZXNwb25zZSIsImZldGNoIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX0FQSV9VUkwiLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIm9rIiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwidG9JU09TdHJpbmciLCJhbGVydCIsImhhbmRsZUNhc2VDcmVhdGlvbiIsImNhc2VSZXNwb25zZSIsImFzc2lnbm1lbnRUeXBlIiwiY2FzZVBheWxvYWQiLCJzZXJ2aWNlVHlwZSIsImRlc2NyaXB0aW9uIiwicHJlZmVycmVkRGF0ZSIsInByZWZlcnJlZFRpbWUiLCJwcmlvcml0eSIsImFkZHJlc3MiLCJhZGRpdGlvbmFsRGV0YWlscyIsImNyZWF0ZUNhc2UiLCJjcmVhdGVkQ2FzZSIsIm5vdGlmaWNhdGlvbk1lc3NhZ2UiLCJidXNpbmVzc05hbWUiLCJidXNpbmVzc19uYW1lIiwic2VuZE1lc3NhZ2UiLCJjaGF0RXJyb3IiLCJFcnJvciIsImFjdGl2ZUNvbnZJZCIsIm5ld0NvbnZJZCIsIm5ld01zZyIsInNldFRpbWVvdXQiLCJoYW5kbGVDbG9zZSIsImRpdiIsImNsYXNzTmFtZSIsImgzIiwiZmlyc3RfbmFtZSIsImxhc3RfbmFtZSIsInAiLCJidXR0b24iLCJvbkNsaWNrIiwic3ZnIiwiZmlsbCIsInN0cm9rZSIsInZpZXdCb3giLCJwYXRoIiwic3Ryb2tlTGluZWNhcCIsInN0cm9rZUxpbmVqb2luIiwic3Ryb2tlV2lkdGgiLCJkIiwibGVuZ3RoIiwicHJvdmlkZXJOYW1lIiwiY2FzZUlkIiwicGFyc2VkRGF0YSIsImdldENhc2UiLCJzZXJ2aWNlX3R5cGUiLCJjb21wbGV0ZWRBdCIsImNvbXBsZXRlZF9hdCIsInNwYW4iLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJob3VyIiwibWludXRlIiwicmVmIiwiaW5wdXQiLCJ0eXBlIiwib25DaGFuZ2UiLCJ0YXJnZXQiLCJvbktleVByZXNzIiwicGxhY2Vob2xkZXIiLCJkaXNhYmxlZCIsIm1vZGUiLCJvblN1Ym1pdCIsImlzU3VibWl0dGluZyIsInByb3ZpZGVyQ2F0ZWdvcnkiLCJvblN1Ym1pdFN1Y2Nlc3MiLCJ0aGFua1lvdU1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/components/ChatModal.tsx\n"));

/***/ })

});