"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/search/page",{

/***/ "(app-pages-browser)/./src/components/ChatModal.tsx":
/*!**************************************!*\
  !*** ./src/components/ChatModal.tsx ***!
  \**************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ ChatModal; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _UnifiedCaseModal__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./UnifiedCaseModal */ \"(app-pages-browser)/./src/components/UnifiedCaseModal.tsx\");\n/* harmony import */ var _ServiceRequestButton__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ServiceRequestButton */ \"(app-pages-browser)/./src/components/ServiceRequestButton.tsx\");\n/* harmony import */ var _SurveyModal__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SurveyModal */ \"(app-pages-browser)/./src/components/SurveyModal.tsx\");\n/* harmony import */ var _lib_api__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/api */ \"(app-pages-browser)/./src/lib/api.ts\");\n/* harmony import */ var _contexts_AuthContext__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/contexts/AuthContext */ \"(app-pages-browser)/./src/contexts/AuthContext.tsx\");\n/* harmony import */ var _contexts_SocketContext__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/contexts/SocketContext */ \"(app-pages-browser)/./src/contexts/SocketContext.tsx\");\n/* __next_internal_client_entry_do_not_use__ default auto */ \nvar _s = $RefreshSig$();\n\n\n\n\n\n\n\nfunction ChatModal(param) {\n    let { provider, isOpen, onClose } = param;\n    _s();\n    const { user, isAuthenticated } = (0,_contexts_AuthContext__WEBPACK_IMPORTED_MODULE_6__.useAuth)();\n    const { socket, isConnected } = (0,_contexts_SocketContext__WEBPACK_IMPORTED_MODULE_7__.useSocket)() // Use global socket from context\n    ;\n    const [messages, setMessages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [newMessage, setNewMessage] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [conversationId, setConversationId] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [customerName, setCustomerName] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [customerEmail, setCustomerEmail] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [customerPhone, setCustomerPhone] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [isStarted, setIsStarted] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [showUnifiedModal, setShowUnifiedModal] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [currentTemplate, setCurrentTemplate] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [isSubmittingTemplate, setIsSubmittingTemplate] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [modalMode, setModalMode] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"direct\");\n    const [showSurveyModal, setShowSurveyModal] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [surveyCase, setSurveyCase] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const messagesEndRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    // Storage keys for persistence\n    const storageKey = \"chat_\".concat(provider.id);\n    const conversationKey = \"conversation_\".concat(provider.id);\n    const scrollToBottom = ()=>{\n        var _messagesEndRef_current;\n        (_messagesEndRef_current = messagesEndRef.current) === null || _messagesEndRef_current === void 0 ? void 0 : _messagesEndRef_current.scrollIntoView({\n            behavior: \"smooth\"\n        });\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        scrollToBottom();\n    }, [\n        messages\n    ]);\n    // Initialize user data only once when modal opens\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        const initializeChat = async ()=>{\n            if (isOpen && isAuthenticated && user && !isStarted) {\n                console.log(\"\\uD83D\\uDDE8️ ChatModal opened for provider:\", provider.id);\n                const fullName = \"\".concat(user.firstName || \"\", \" \").concat(user.lastName || \"\").trim();\n                const finalName = fullName || \"User\";\n                setCustomerName(finalName);\n                setCustomerEmail(user.email || \"\");\n                setCustomerPhone(user.phoneNumber || \"\");\n                // Check for existing conversation\n                const savedConversationId = localStorage.getItem(conversationKey);\n                if (savedConversationId) {\n                    console.log(\"\\uD83D\\uDD0D Found saved conversation ID:\", savedConversationId);\n                    // Validate that the conversation exists by trying to load messages\n                    try {\n                        var _messagesResponse_data;\n                        const messagesResponse = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.getConversationMessages(savedConversationId);\n                        if ((_messagesResponse_data = messagesResponse.data) === null || _messagesResponse_data === void 0 ? void 0 : _messagesResponse_data.success) {\n                            console.log(\"✅ Saved conversation is valid, using it\");\n                            setConversationId(savedConversationId);\n                            setIsStarted(true);\n                            loadMessages(savedConversationId);\n                        } else {\n                            console.log(\"❌ Saved conversation is invalid, creating new one\");\n                            localStorage.removeItem(conversationKey);\n                            await startConversation({\n                                name: finalName,\n                                email: user.email || \"\",\n                                phone: user.phoneNumber || \"\"\n                            });\n                        }\n                    } catch (error) {\n                        console.log(\"❌ Error validating saved conversation, creating new one:\", error);\n                        localStorage.removeItem(conversationKey);\n                        await startConversation({\n                            name: finalName,\n                            email: user.email || \"\",\n                            phone: user.phoneNumber || \"\"\n                        });\n                    }\n                } else {\n                    // Auto-start conversation for authenticated users\n                    await startConversation({\n                        name: finalName,\n                        email: user.email || \"\",\n                        phone: user.phoneNumber || \"\"\n                    });\n                }\n            }\n        };\n        initializeChat();\n    }, [\n        isOpen,\n        isAuthenticated,\n        user,\n        provider.id\n    ]);\n    // Join conversation room when modal opens\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (!isOpen || !conversationId || !socket || !isConnected) return;\n        console.log(\"\\uD83C\\uDFE0 ChatModal - Joining conversation room:\", conversationId);\n        socket.emit(\"join-conversation\", conversationId);\n        return ()=>{\n            console.log(\"\\uD83D\\uDEAA ChatModal - Leaving conversation room:\", conversationId);\n        // Don't disconnect the global socket, just leave the room\n        };\n    }, [\n        isOpen,\n        conversationId,\n        socket,\n        isConnected\n    ]);\n    // Setup real-time message listeners\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (!socket || !conversationId) return;\n        const handleNewMessage = (data)=>{\n            console.log(\"\\uD83D\\uDCAC Customer received new message:\", data);\n            // Only add messages from providers (not our own messages)\n            if (data.conversationId === conversationId && data.messageId && data.senderType === \"provider\") {\n                const newMessage = {\n                    id: data.messageId,\n                    conversationId: data.conversationId,\n                    senderType: data.senderType,\n                    senderName: data.senderName,\n                    message: data.message,\n                    messageType: data.messageType,\n                    timestamp: data.timestamp\n                };\n                setMessages((prev)=>{\n                    const messageExists = prev.some((msg)=>msg.id === data.messageId);\n                    if (messageExists) return prev;\n                    console.log(\"\\uD83D\\uDCDD Adding provider message to customer chat:\", newMessage);\n                    return [\n                        ...prev,\n                        newMessage\n                    ];\n                });\n                scrollToBottom();\n            }\n        };\n        socket.on(\"new_message\", handleNewMessage);\n        return ()=>{\n            socket.off(\"new_message\", handleNewMessage);\n        };\n    }, [\n        socket,\n        conversationId\n    ]);\n    const startConversation = async (overrideData)=>{\n        if (loading || isStarted || conversationId) {\n            console.log(\"⏭️ Skipping conversation creation - already exists or in progress\");\n            return;\n        }\n        setLoading(true);\n        try {\n            var _response_data, _response_data_data, _response_data1;\n            const data = {\n                providerId: provider.id,\n                customerId: (user === null || user === void 0 ? void 0 : user.id) || undefined,\n                customerName: (overrideData === null || overrideData === void 0 ? void 0 : overrideData.name) || customerName,\n                customerEmail: (overrideData === null || overrideData === void 0 ? void 0 : overrideData.email) || customerEmail,\n                customerPhone: (overrideData === null || overrideData === void 0 ? void 0 : overrideData.phone) || customerPhone\n            };\n            console.log(\"\\uD83D\\uDE80 Starting conversation with data:\", data);\n            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.createOrGetConversation(data);\n            if (((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) && ((_response_data1 = response.data) === null || _response_data1 === void 0 ? void 0 : (_response_data_data = _response_data1.data) === null || _response_data_data === void 0 ? void 0 : _response_data_data.conversationId)) {\n                const newConversationId = response.data.data.conversationId;\n                setConversationId(newConversationId);\n                setIsStarted(true);\n                // Save to localStorage\n                localStorage.setItem(storageKey, JSON.stringify(data));\n                localStorage.setItem(conversationKey, newConversationId);\n                // Load existing messages\n                await loadMessages(newConversationId);\n            }\n        } catch (error) {\n            console.error(\"Error starting conversation:\", error);\n        } finally{\n            setLoading(false);\n        }\n    };\n    const loadMessages = async (convId)=>{\n        try {\n            var _response_data;\n            setLoading(true);\n            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.getMarketplaceMessages(convId);\n            if (((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) && Array.isArray(response.data.data)) {\n                setMessages(response.data.data);\n                scrollToBottom();\n            }\n        } catch (error) {\n            var _error_response;\n            console.error(\"Error loading messages:\", error);\n            // If conversation doesn't exist, auto-recreate it\n            if ((error === null || error === void 0 ? void 0 : (_error_response = error.response) === null || _error_response === void 0 ? void 0 : _error_response.status) === 404) {\n                console.log(\"\\uD83D\\uDD27 Conversation not found, attempting to recreate...\");\n                await recreateConversation();\n            }\n        } finally{\n            setLoading(false);\n        }\n    };\n    const recreateConversation = async ()=>{\n        try {\n            var _response_data, _response_data_data, _response_data1;\n            const data = {\n                providerId: provider.id,\n                customerName: customerName,\n                customerEmail: customerEmail,\n                customerPhone: customerPhone\n            };\n            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.createOrGetConversation(data);\n            if (((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) && ((_response_data1 = response.data) === null || _response_data1 === void 0 ? void 0 : (_response_data_data = _response_data1.data) === null || _response_data_data === void 0 ? void 0 : _response_data_data.conversationId)) {\n                const newConversationId = response.data.data.conversationId;\n                setConversationId(newConversationId);\n                localStorage.setItem(conversationKey, newConversationId);\n                console.log(\"✅ Conversation recreated:\", newConversationId);\n            }\n        } catch (error) {\n            console.error(\"Failed to recreate conversation:\", error);\n        }\n    };\n    const handleCaseTemplateClick = async (message)=>{\n        if (message.messageType !== \"case_template\") return;\n        try {\n            var _response_data, _response_data1;\n            // Get the service category from provider\n            const serviceCategory = provider.serviceCategory || provider.service_category || \"general\";\n            // Fetch the case template\n            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.getCaseTemplate(serviceCategory);\n            if (((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) && ((_response_data1 = response.data) === null || _response_data1 === void 0 ? void 0 : _response_data1.data)) {\n                const templateData = JSON.parse(response.data.data.template_data);\n                setCurrentTemplate({\n                    ...response.data.data,\n                    templateData\n                });\n                setModalMode(\"template\");\n                setShowUnifiedModal(true);\n            }\n        } catch (error) {\n            console.error(\"Error loading case template:\", error);\n        }\n    };\n    const handleTemplateSubmit = async (formData)=>{\n        if (!conversationId || !currentTemplate) return;\n        setIsSubmittingTemplate(true);\n        try {\n            var _response_data;\n            // Create or update service case with filled data\n            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.createServiceCase({\n                conversationId,\n                templateId: currentTemplate.id,\n                caseData: formData\n            });\n            if ((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) {\n                // Send a message to the provider with the filled template\n                const summaryMessage = \"\\uD83D\\uDCCB Попълних формата с информация за проблема:\\n\\n\".concat(Object.entries(formData).map((param)=>{\n                    let [key, value] = param;\n                    const field = currentTemplate.templateData.fields.find((f)=>f.id === key);\n                    const label = (field === null || field === void 0 ? void 0 : field.label) || key;\n                    return \"\".concat(label, \": \").concat(value);\n                }).join(\"\\n\"));\n                // Send the summary message\n                const messageResponse = await fetch(\"\".concat(\"http://192.168.0.129:3000/api/v1\" || 0, \"/chat/messages\"), {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        conversationId,\n                        senderType: \"customer\",\n                        senderName: customerName,\n                        message: summaryMessage,\n                        messageType: \"case_filled\"\n                    })\n                });\n                if (messageResponse.ok) {\n                    // Add message to local state\n                    const newMessage = {\n                        id: Date.now().toString(),\n                        conversationId: conversationId,\n                        senderType: \"customer\",\n                        senderName: customerName,\n                        message: summaryMessage,\n                        messageType: \"case_filled\",\n                        timestamp: new Date().toISOString()\n                    };\n                    setMessages((prev)=>[\n                            ...prev,\n                            newMessage\n                        ]);\n                }\n                setShowUnifiedModal(false);\n                setCurrentTemplate(null);\n            }\n        } catch (error) {\n            console.error(\"Error submitting template:\", error);\n            alert(\"Възникна грешка при изпращането на формата\");\n        } finally{\n            setIsSubmittingTemplate(false);\n        }\n    };\n    const handleCaseCreation = async (caseData)=>{\n        if (!conversationId) return;\n        try {\n            var _caseResponse_data;\n            console.log(\"\\uD83D\\uDCCB ChatModal - Creating case with data:\", caseData);\n            console.log(\"\\uD83D\\uDCCB ChatModal - Provider object:\", provider);\n            console.log(\"\\uD83D\\uDCCB ChatModal - Assignment type:\", caseData.assignmentType);\n            // Prepare case data for API\n            const casePayload = {\n                serviceType: caseData.serviceType,\n                description: caseData.description,\n                preferredDate: caseData.preferredDate,\n                preferredTime: caseData.preferredTime,\n                priority: caseData.priority || \"normal\",\n                address: caseData.address,\n                phone: caseData.phone,\n                additionalDetails: caseData.additionalDetails || \"\",\n                // Handle assignment based on \"тип заявка\" selection\n                assignmentType: caseData.assignmentType || \"specific\",\n                providerId: caseData.assignmentType === \"specific\" ? provider.id : null,\n                conversationId: conversationId,\n                customerId: user.id,\n                customerName: customerName,\n                customerEmail: customerEmail,\n                customerPhone: customerPhone\n            };\n            console.log(\"\\uD83D\\uDCCB ChatModal - Case payload:\", casePayload);\n            console.log(\"\\uD83D\\uDCCB ChatModal - Final providerId for assignment:\", casePayload.providerId);\n            console.log(\"\\uD83D\\uDCCB ChatModal - Assignment logic: assignmentType =\", caseData.assignmentType, \"provider.id =\", provider.id);\n            // Create the actual case in the system\n            const caseResponse = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.createCase(casePayload);\n            if ((_caseResponse_data = caseResponse.data) === null || _caseResponse_data === void 0 ? void 0 : _caseResponse_data.success) {\n                const createdCase = caseResponse.data.data;\n                console.log(\"✅ ChatModal - Case created successfully:\", createdCase);\n                // Create a notification message in the chat\n                let notificationMessage = \"✅ Заявката е създадена успешно!\\n\\n\\uD83D\\uDCCB Номер на заявката: #\".concat(createdCase.id, \"\\n\\uD83D\\uDD27 Услуга: \").concat(caseData.serviceType, \"\\n\\uD83D\\uDCCD Адрес: \").concat(caseData.address, \"\\n\\uD83D\\uDCC5 Дата: \").concat(caseData.preferredDate, \"\\n⏰ Време: \").concat(caseData.preferredTime || \"Сутрин (8:00-12:00)\", \"\\n\\n\").concat(caseData.assignmentType === \"specific\" ? \"\\uD83C\\uDFAF Заявката е насочена директно към \".concat(provider.businessName || provider.business_name) : \"\\uD83C\\uDF10 Заявката е поставена в общата опашка за всички специалисти\");\n                // Try to send notification message to chat (non-critical)\n                try {\n                    await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.sendMessage({\n                        conversationId,\n                        senderType: \"customer\",\n                        senderName: customerName,\n                        message: notificationMessage,\n                        messageType: \"case_created\"\n                    });\n                    // Add message to local state\n                    const newMessage = {\n                        id: Date.now().toString(),\n                        conversationId: conversationId,\n                        senderType: \"customer\",\n                        senderName: customerName,\n                        message: notificationMessage,\n                        messageType: \"case_created\",\n                        timestamp: new Date().toISOString()\n                    };\n                    setMessages((prev)=>[\n                            ...prev,\n                            newMessage\n                        ]);\n                } catch (chatError) {\n                    console.error(\"\\uD83D\\uDCCB ChatModal - Failed to send chat notification (non-critical):\", chatError);\n                // Don't throw error here since case was created successfully\n                }\n                // Show success feedback\n                alert(\"Заявката е създадена успешно! Номер: #\".concat(createdCase.id));\n            } else {\n                var _caseResponse_data1;\n                throw new Error(((_caseResponse_data1 = caseResponse.data) === null || _caseResponse_data1 === void 0 ? void 0 : _caseResponse_data1.message) || \"Грешка при създаването на заявката\");\n            }\n            setShowUnifiedModal(false);\n        } catch (error) {\n            console.error(\"Error creating case:\", error);\n            alert(\"Възникна грешка при създаването на заявката\");\n        }\n    };\n    const sendMessage = async ()=>{\n        if (!newMessage.trim() || loading) return;\n        // If no conversation exists, create one first\n        let activeConvId = conversationId;\n        if (!activeConvId) {\n            console.log(\"\\uD83D\\uDD27 No conversation found, creating new one...\");\n            await startConversation();\n            // Wait a bit for state to update and check again\n            await new Promise((resolve)=>setTimeout(resolve, 100));\n            activeConvId = conversationId;\n            if (!activeConvId) {\n                console.error(\"❌ Failed to create conversation\");\n                return;\n            }\n        }\n        setLoading(true);\n        try {\n            var _response_data;\n            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.sendMessage({\n                conversationId: activeConvId,\n                senderType: \"customer\",\n                senderName: customerName,\n                message: newMessage\n            });\n            if ((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) {\n                var _response_data_data;\n                // Add customer message to UI immediately (won't come back via WebSocket)\n                const newMsg = {\n                    id: ((_response_data_data = response.data.data) === null || _response_data_data === void 0 ? void 0 : _response_data_data.messageId) || Date.now().toString(),\n                    conversationId: conversationId,\n                    senderType: \"customer\",\n                    senderName: customerName,\n                    message: newMessage,\n                    timestamp: new Date().toISOString()\n                };\n                setMessages((prev)=>[\n                        ...prev,\n                        newMsg\n                    ]);\n                setNewMessage(\"\");\n            }\n        } catch (error) {\n            var _error_response;\n            console.error(\"Error sending message:\", error);\n            // If conversation was deleted, try to recreate and resend\n            if ((error === null || error === void 0 ? void 0 : (_error_response = error.response) === null || _error_response === void 0 ? void 0 : _error_response.status) === 404) {\n                console.log(\"\\uD83D\\uDD27 Conversation deleted, recreating and retrying...\");\n                await recreateConversation();\n                // Retry sending the message\n                setTimeout(()=>sendMessage(), 1000);\n            }\n        } finally{\n            setLoading(false);\n        }\n    };\n    const handleClose = ()=>{\n        // Reset state when closing\n        setMessages([]);\n        setNewMessage(\"\");\n        setConversationId(null);\n        setIsStarted(false);\n        onClose();\n    };\n    if (!isOpen) return null;\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"bg-slate-800 rounded-xl shadow-2xl w-full max-w-md mx-4 h-96 flex flex-col border border-white/20\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-4 rounded-t-xl flex justify-between items-center\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                                        className: \"font-semibold\",\n                                        children: provider.businessName || provider.business_name || \"\".concat(provider.firstName || provider.first_name, \" \").concat(provider.lastName || provider.last_name)\n                                    }, void 0, false, {\n                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                        lineNumber: 522,\n                                        columnNumber: 13\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                        className: \"text-sm text-white/80\",\n                                        children: provider.serviceCategory || provider.service_category\n                                    }, void 0, false, {\n                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                        lineNumber: 525,\n                                        columnNumber: 13\n                                    }, this)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                lineNumber: 521,\n                                columnNumber: 11\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: handleClose,\n                                className: \"text-white/80 hover:text-white transition-colors\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                                    className: \"w-6 h-6\",\n                                    fill: \"none\",\n                                    stroke: \"currentColor\",\n                                    viewBox: \"0 0 24 24\",\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                                        strokeLinecap: \"round\",\n                                        strokeLinejoin: \"round\",\n                                        strokeWidth: 2,\n                                        d: \"M6 18L18 6M6 6l12 12\"\n                                    }, void 0, false, {\n                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                        lineNumber: 534,\n                                        columnNumber: 15\n                                    }, this)\n                                }, void 0, false, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 533,\n                                    columnNumber: 13\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                lineNumber: 529,\n                                columnNumber: 11\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                        lineNumber: 520,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex-1 overflow-y-auto p-4 space-y-3 bg-slate-900/50\",\n                        children: [\n                            loading && messages.length === 0 ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"text-center text-slate-400\",\n                                children: \"Зареждане...\"\n                            }, void 0, false, {\n                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                lineNumber: 542,\n                                columnNumber: 13\n                            }, this) : messages.map((msg)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"flex \".concat(msg.senderType === \"customer\" ? \"justify-end\" : \"justify-start\"),\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"max-w-xs px-3 py-2 rounded-lg text-sm \".concat(msg.senderType === \"customer\" ? \"bg-gradient-to-r from-indigo-600 to-purple-600 text-white\" : \"bg-slate-700 text-slate-100 border border-slate-600\"),\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                children: msg.message\n                                            }, void 0, false, {\n                                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                lineNumber: 556,\n                                                columnNumber: 19\n                                            }, this),\n                                            msg.messageType === \"case_template\" && msg.senderType === \"provider\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                onClick: ()=>handleCaseTemplateClick(msg),\n                                                className: \"mt-2 px-3 py-1 bg-gradient-to-r from-indigo-500 to-purple-500 text-white text-xs rounded hover:shadow-lg transform hover:scale-105 transition-all duration-300\",\n                                                children: \"\\uD83D\\uDCCB Попълни формата\"\n                                            }, void 0, false, {\n                                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                lineNumber: 560,\n                                                columnNumber: 21\n                                            }, this),\n                                            msg.messageType === \"service_request\" && msg.senderType === \"provider\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"mt-2\",\n                                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_ServiceRequestButton__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n                                                    providerName: provider.businessName || provider.business_name || \"\".concat(provider.firstName || provider.first_name, \" \").concat(provider.lastName || provider.last_name),\n                                                    onClick: ()=>{\n                                                        setModalMode(\"direct\");\n                                                        setShowUnifiedModal(true);\n                                                    }\n                                                }, void 0, false, {\n                                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                    lineNumber: 571,\n                                                    columnNumber: 23\n                                                }, this)\n                                            }, void 0, false, {\n                                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                lineNumber: 570,\n                                                columnNumber: 21\n                                            }, this),\n                                            msg.messageType === \"survey_request\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                onClick: async ()=>{\n                                                    // Extract case ID from message data\n                                                    console.log(\"\\uD83D\\uDD0D Survey button clicked, message data:\", msg);\n                                                    let caseId = msg.caseId;\n                                                    // Try to parse data field if it exists\n                                                    if (msg.data) {\n                                                        try {\n                                                            const parsedData = typeof msg.data === \"string\" ? JSON.parse(msg.data) : msg.data;\n                                                            console.log(\"\\uD83D\\uDD0D Parsed message data:\", parsedData);\n                                                            caseId = parsedData.caseId || caseId;\n                                                        } catch (e) {\n                                                            console.log(\"Could not parse message data:\", msg.data);\n                                                        }\n                                                    }\n                                                    console.log(\"\\uD83D\\uDD0D Final caseId extracted:\", caseId);\n                                                    if (caseId) {\n                                                        try {\n                                                            var _response_data;\n                                                            // Fetch case details for the survey\n                                                            const response = await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.getCase(caseId);\n                                                            if ((_response_data = response.data) === null || _response_data === void 0 ? void 0 : _response_data.success) {\n                                                                setSurveyCase({\n                                                                    id: caseId,\n                                                                    providerName: provider.businessName || provider.business_name || \"\".concat(provider.firstName || provider.first_name, \" \").concat(provider.lastName || provider.last_name),\n                                                                    serviceType: response.data.data.service_type,\n                                                                    completedAt: response.data.data.completed_at,\n                                                                    description: response.data.data.description\n                                                                });\n                                                                setShowSurveyModal(true);\n                                                            }\n                                                        } catch (error) {\n                                                            console.error(\"Error fetching case details:\", error);\n                                                            alert(\"Възникна грешка при зареждането на детайлите за заявката\");\n                                                        }\n                                                    } else {\n                                                        alert(\"Не може да се намери ID на заявката\");\n                                                    }\n                                                },\n                                                className: \"mt-2 px-4 py-2 bg-gradient-to-r from-yellow-500 to-orange-500 text-white text-sm rounded-lg hover:from-yellow-600 hover:to-orange-600 transition-all duration-200 flex items-center space-x-2\",\n                                                children: [\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                        children: \"⭐\"\n                                                    }, void 0, false, {\n                                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                        lineNumber: 626,\n                                                        columnNumber: 23\n                                                    }, this),\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                        children: \"Оценете услугата\"\n                                                    }, void 0, false, {\n                                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                        lineNumber: 627,\n                                                        columnNumber: 23\n                                                    }, this)\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                lineNumber: 583,\n                                                columnNumber: 21\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"text-xs mt-1 \".concat(msg.senderType === \"customer\" ? \"text-white/60\" : \"text-slate-400\"),\n                                                children: new Date(msg.timestamp).toLocaleTimeString(\"bg-BG\", {\n                                                    hour: \"2-digit\",\n                                                    minute: \"2-digit\"\n                                                })\n                                            }, void 0, false, {\n                                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                                lineNumber: 631,\n                                                columnNumber: 19\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                        lineNumber: 549,\n                                        columnNumber: 17\n                                    }, this)\n                                }, msg.id, false, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 545,\n                                    columnNumber: 15\n                                }, this)),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                ref: messagesEndRef\n                            }, void 0, false, {\n                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                lineNumber: 643,\n                                columnNumber: 11\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                        lineNumber: 540,\n                        columnNumber: 9\n                    }, this),\n                    isStarted && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"border-t border-slate-700 p-4 bg-slate-800/50\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex space-x-2 mb-3\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                                        type: \"text\",\n                                        value: newMessage,\n                                        onChange: (e)=>setNewMessage(e.target.value),\n                                        onKeyPress: (e)=>e.key === \"Enter\" && sendMessage(),\n                                        placeholder: \"Напишете съобщение...\",\n                                        className: \"flex-1 bg-slate-700 border border-slate-600 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder:text-slate-400\",\n                                        disabled: loading\n                                    }, void 0, false, {\n                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                        lineNumber: 650,\n                                        columnNumber: 15\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                        onClick: sendMessage,\n                                        disabled: !newMessage.trim() || loading,\n                                        className: \"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-lg transform hover:scale-105 transition-all duration-300\",\n                                        children: loading ? \"...\" : \"Изпрати\"\n                                    }, void 0, false, {\n                                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                        lineNumber: 659,\n                                        columnNumber: 15\n                                    }, this)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                lineNumber: 649,\n                                columnNumber: 13\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex justify-center\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    onClick: ()=>{\n                                        setModalMode(\"direct\");\n                                        setShowUnifiedModal(true);\n                                    },\n                                    className: \"bg-gradient-to-r from-green-500 to-blue-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-green-600 hover:to-blue-600 transition-all duration-200 flex items-center space-x-2\",\n                                    children: [\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                            children: \"\\uD83D\\uDD27\"\n                                        }, void 0, false, {\n                                            fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                            lineNumber: 677,\n                                            columnNumber: 17\n                                        }, this),\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                            children: \"Създай заявка за услуга\"\n                                        }, void 0, false, {\n                                            fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                            lineNumber: 678,\n                                            columnNumber: 17\n                                        }, this)\n                                    ]\n                                }, void 0, true, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 670,\n                                    columnNumber: 15\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                lineNumber: 669,\n                                columnNumber: 13\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                        lineNumber: 648,\n                        columnNumber: 11\n                    }, this),\n                    !isStarted && !loading && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"p-4 border-t border-slate-700 bg-slate-800/50\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"space-y-3\",\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                                    type: \"text\",\n                                    placeholder: \"Вашето име\",\n                                    value: customerName,\n                                    onChange: (e)=>setCustomerName(e.target.value),\n                                    className: \"w-full bg-slate-700 border border-slate-600 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder:text-slate-400\"\n                                }, void 0, false, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 688,\n                                    columnNumber: 15\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                                    type: \"email\",\n                                    placeholder: \"Email адрес\",\n                                    value: customerEmail,\n                                    onChange: (e)=>setCustomerEmail(e.target.value),\n                                    className: \"w-full bg-slate-700 border border-slate-600 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder:text-slate-400\"\n                                }, void 0, false, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 695,\n                                    columnNumber: 15\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                                    type: \"tel\",\n                                    placeholder: \"Телефон\",\n                                    value: customerPhone,\n                                    onChange: (e)=>setCustomerPhone(e.target.value),\n                                    className: \"w-full bg-slate-700 border border-slate-600 text-white rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder:text-slate-400\"\n                                }, void 0, false, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 702,\n                                    columnNumber: 15\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    onClick: ()=>startConversation(),\n                                    disabled: !customerName || !customerEmail,\n                                    className: \"w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-lg transform hover:scale-105 transition-all duration-300\",\n                                    children: \"Започни разговор\"\n                                }, void 0, false, {\n                                    fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                                    lineNumber: 709,\n                                    columnNumber: 15\n                                }, this)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                            lineNumber: 687,\n                            columnNumber: 13\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                        lineNumber: 686,\n                        columnNumber: 11\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                lineNumber: 518,\n                columnNumber: 7\n            }, this),\n            showUnifiedModal && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_UnifiedCaseModal__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {\n                isOpen: showUnifiedModal,\n                mode: modalMode,\n                templateData: currentTemplate === null || currentTemplate === void 0 ? void 0 : currentTemplate.templateData,\n                onClose: ()=>{\n                    setShowUnifiedModal(false);\n                    setCurrentTemplate(null);\n                },\n                onSubmit: modalMode === \"template\" ? handleTemplateSubmit : handleCaseCreation,\n                isSubmitting: isSubmittingTemplate,\n                providerName: provider.businessName || provider.business_name || \"специалиста\",\n                providerId: provider.id,\n                providerCategory: provider.serviceCategory || provider.service_category,\n                customerPhone: customerPhone\n            }, void 0, false, {\n                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                lineNumber: 723,\n                columnNumber: 7\n            }, this),\n            showSurveyModal && surveyCase && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_SurveyModal__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n                isOpen: showSurveyModal,\n                onClose: ()=>{\n                    setShowSurveyModal(false);\n                    setSurveyCase(null);\n                },\n                caseId: surveyCase.id,\n                providerId: provider.id,\n                providerName: provider.businessName || provider.business_name || \"\".concat(provider.firstName || provider.first_name, \" \").concat(provider.lastName || provider.last_name),\n                onSubmitSuccess: async ()=>{\n                    // Send a thank you message to the chat\n                    const thankYouMessage = \"✅ Благодарим ви за оценката! \\n\\nВашето мнение е важно за нас и помага на други клиенти да направят правилния избор.\";\n                    try {\n                        await _lib_api__WEBPACK_IMPORTED_MODULE_5__.apiClient.sendMessage({\n                            conversationId: conversationId,\n                            senderType: \"customer\",\n                            senderName: customerName,\n                            message: thankYouMessage,\n                            messageType: \"text\"\n                        });\n                        // Add thank you message to local state\n                        const newMessage = {\n                            id: Date.now().toString(),\n                            conversationId: conversationId,\n                            senderType: \"customer\",\n                            senderName: customerName,\n                            message: thankYouMessage,\n                            messageType: \"text\",\n                            timestamp: new Date().toISOString()\n                        };\n                        setMessages((prev)=>[\n                                ...prev,\n                                newMessage\n                            ]);\n                    } catch (error) {\n                        console.error(\"Error sending thank you message:\", error);\n                    }\n                    setShowSurveyModal(false);\n                    setSurveyCase(null);\n                    alert(\"Благодарим ви за оценката!\");\n                }\n            }, void 0, false, {\n                fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n                lineNumber: 742,\n                columnNumber: 7\n            }, this)\n        ]\n    }, void 0, true, {\n        fileName: \"D:\\\\newtry1\\\\Marketplace\\\\src\\\\components\\\\ChatModal.tsx\",\n        lineNumber: 517,\n        columnNumber: 5\n    }, this);\n}\n_s(ChatModal, \"ir1+hIhHPugMO/zr0fAfFVq4m5g=\", false, function() {\n    return [\n        _contexts_AuthContext__WEBPACK_IMPORTED_MODULE_6__.useAuth,\n        _contexts_SocketContext__WEBPACK_IMPORTED_MODULE_7__.useSocket\n    ];\n});\n_c = ChatModal;\nvar _c;\n$RefreshReg$(_c, \"ChatModal\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9jb21wb25lbnRzL0NoYXRNb2RhbC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBRTJEO0FBRVQ7QUFDUTtBQUNsQjtBQUNIO0FBQ1c7QUFDSTtBQThDckMsU0FBU1UsVUFBVSxLQUE2QztRQUE3QyxFQUFFQyxRQUFRLEVBQUVDLE1BQU0sRUFBRUMsT0FBTyxFQUFrQixHQUE3Qzs7SUFDaEMsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLGVBQWUsRUFBRSxHQUFHUCw4REFBT0E7SUFDekMsTUFBTSxFQUFFUSxNQUFNLEVBQUVDLFdBQVcsRUFBRSxHQUFHUixrRUFBU0EsR0FBRyxpQ0FBaUM7O0lBQzdFLE1BQU0sQ0FBQ1MsVUFBVUMsWUFBWSxHQUFHbEIsK0NBQVFBLENBQVksRUFBRTtJQUN0RCxNQUFNLENBQUNtQixZQUFZQyxjQUFjLEdBQUdwQiwrQ0FBUUEsQ0FBQztJQUM3QyxNQUFNLENBQUNxQixTQUFTQyxXQUFXLEdBQUd0QiwrQ0FBUUEsQ0FBQztJQUN2QyxNQUFNLENBQUN1QixnQkFBZ0JDLGtCQUFrQixHQUFHeEIsK0NBQVFBLENBQWdCO0lBQ3BFLE1BQU0sQ0FBQ3lCLGNBQWNDLGdCQUFnQixHQUFHMUIsK0NBQVFBLENBQUM7SUFDakQsTUFBTSxDQUFDMkIsZUFBZUMsaUJBQWlCLEdBQUc1QiwrQ0FBUUEsQ0FBQztJQUNuRCxNQUFNLENBQUM2QixlQUFlQyxpQkFBaUIsR0FBRzlCLCtDQUFRQSxDQUFDO0lBQ25ELE1BQU0sQ0FBQytCLFdBQVdDLGFBQWEsR0FBR2hDLCtDQUFRQSxDQUFDO0lBQzNDLE1BQU0sQ0FBQ2lDLGtCQUFrQkMsb0JBQW9CLEdBQUdsQywrQ0FBUUEsQ0FBQztJQUN6RCxNQUFNLENBQUNtQyxpQkFBaUJDLG1CQUFtQixHQUFHcEMsK0NBQVFBLENBQU07SUFDNUQsTUFBTSxDQUFDcUMsc0JBQXNCQyx3QkFBd0IsR0FBR3RDLCtDQUFRQSxDQUFDO0lBQ2pFLE1BQU0sQ0FBQ3VD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WkMsWUFBWXZEOzRCQUNad0QsU0FBU21JOzRCQUNUbEksYUFBYTs0QkFDYkMsV0FBVyxJQUFJd0QsT0FBT0csV0FBVzt3QkFDbkM7d0JBQ0E1SCxZQUFZa0UsQ0FBQUEsT0FBUTttQ0FBSUE7Z0NBQU1qRTs2QkFBVztvQkFDM0MsRUFBRSxPQUFPd0QsT0FBTzt3QkFDZHJCLFFBQVFxQixLQUFLLENBQUMsb0NBQW9DQTtvQkFDcEQ7b0JBRUFqQyxtQkFBbUI7b0JBQ25CRSxjQUFjO29CQUNkbUcsTUFBTTtnQkFDUjs7Ozs7Ozs7Ozs7O0FBS1I7R0E3dEJ3QnRJOztRQUNZRiwwREFBT0E7UUFDVEMsOERBQVNBOzs7S0FGbkJDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9jb21wb25lbnRzL0NoYXRNb2RhbC50c3g/Nzg3YyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGNsaWVudCdcblxuaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZVJlZiB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFNvY2tldCB9IGZyb20gJ3NvY2tldC5pby1jbGllbnQnO1xuaW1wb3J0IFVuaWZpZWRDYXNlTW9kYWwgZnJvbSAnLi9VbmlmaWVkQ2FzZU1vZGFsJztcbmltcG9ydCBTZXJ2aWNlUmVxdWVzdEJ1dHRvbiBmcm9tICcuL1NlcnZpY2VSZXF1ZXN0QnV0dG9uJztcbmltcG9ydCBTdXJ2ZXlNb2RhbCBmcm9tICcuL1N1cnZleU1vZGFsJztcbmltcG9ydCB7IGFwaUNsaWVudCB9IGZyb20gJ0AvbGliL2FwaSdcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICdAL2NvbnRleHRzL0F1dGhDb250ZXh0J1xuaW1wb3J0IHsgdXNlU29ja2V0IH0gZnJvbSAnQC9jb250ZXh0cy9Tb2NrZXRDb250ZXh0J1xuXG5pbnRlcmZhY2UgU2VydmljZVByb3ZpZGVyIHtcbiAgaWQ6IHN0cmluZ1xuICAvLyBTdXBwb3J0IGJvdGggbmFtaW5nIGNvbnZlbnRpb25zIC0gbWFrZSBhbGwgb3B0aW9uYWwgYW5kIGhhbmRsZSBib3RoXG4gIGJ1c2luZXNzTmFtZT86IHN0cmluZ1xuICBidXNpbmVzc19uYW1lPzogc3RyaW5nXG4gIHNlcnZpY2VDYXRlZ29yeT86IHN0cmluZ1xuICBzZXJ2aWNlX2NhdGVnb3J5Pzogc3RyaW5nXG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nXG4gIGV4cGVyaWVuY2VZZWFycz86IG51bWJlclxuICBleHBlcmllbmNlX3llYXJzPzogbnVtYmVyXG4gIGhvdXJseVJhdGU/OiBudW1iZXJcbiAgaG91cmx5X3JhdGU/OiBudW1iZXJcbiAgY2l0eTogc3RyaW5nXG4gIG5laWdoYm9yaG9vZD86IHN0cmluZ1xuICBwaG9uZU51bWJlcj86IHN0cmluZ1xuICBwaG9uZV9udW1iZXI/OiBzdHJpbmdcbiAgZW1haWw/OiBzdHJpbmdcbiAgcmF0aW5nOiBudW1iZXJcbiAgdG90YWxSZXZpZXdzPzogbnVtYmVyXG4gIHRvdGFsX3Jldmlld3M/OiBudW1iZXJcbiAgZmlyc3ROYW1lPzogc3RyaW5nXG4gIGZpcnN0X25hbWU/OiBzdHJpbmdcbiAgbGFzdE5hbWU/OiBzdHJpbmdcbiAgbGFzdF9uYW1lPzogc3RyaW5nXG59XG5cbmludGVyZmFjZSBNZXNzYWdlIHtcbiAgaWQ6IHN0cmluZ1xuICBjb252ZXJzYXRpb25JZDogc3RyaW5nXG4gIHNlbmRlclR5cGU6ICdjdXN0b21lcicgfCAncHJvdmlkZXInIHwgJ3N5c3RlbSdcbiAgc2VuZGVyTmFtZTogc3RyaW5nXG4gIG1lc3NhZ2U6IHN0cmluZ1xuICBtZXNzYWdlVHlwZT86IHN0cmluZ1xuICB0aW1lc3RhbXA6IHN0cmluZ1xuICBkYXRhPzogYW55IC8vIEZvciBhZGRpdGlvbmFsIG1lc3NhZ2UgZGF0YSBsaWtlIGNhc2VJZFxuICBjYXNlSWQ/OiBzdHJpbmcgLy8gRGlyZWN0IGNhc2UgSUQgZm9yIHN1cnZleSBtZXNzYWdlc1xufVxuXG5pbnRlcmZhY2UgQ2hhdE1vZGFsUHJvcHMge1xuICBwcm92aWRlcjogU2VydmljZVByb3ZpZGVyXG4gIGlzT3BlbjogYm9vbGVhblxuICBvbkNsb3NlOiAoKSA9PiB2b2lkXG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIENoYXRNb2RhbCh7IHByb3ZpZGVyLCBpc09wZW4sIG9uQ2xvc2UgfTogQ2hhdE1vZGFsUHJvcHMpIHtcbiAgY29uc3QgeyB1c2VyLCBpc0F1dGhlbnRpY2F0ZWQgfSA9IHVzZUF1dGgoKVxuICBjb25zdCB7IHNvY2tldCwgaXNDb25uZWN0ZWQgfSA9IHVzZVNvY2tldCgpIC8vIFVzZSBnbG9iYWwgc29ja2V0IGZyb20gY29udGV4dFxuICBjb25zdCBbbWVzc2FnZXMsIHNldE1lc3NhZ2VzXSA9IHVzZVN0YXRlPE1lc3NhZ2VbXT4oW10pXG4gIGNvbnN0IFtuZXdNZXNzYWdlLCBzZXROZXdNZXNzYWdlXSA9IHVzZVN0YXRlKCcnKVxuICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZShmYWxzZSlcbiAgY29uc3QgW2NvbnZlcnNhdGlvbklkLCBzZXRDb252ZXJzYXRpb25JZF0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKVxuICBjb25zdCBbY3VzdG9tZXJOYW1lLCBzZXRDdXN0b21lck5hbWVdID0gdXNlU3RhdGUoJycpXG4gIGNvbnN0IFtjdXN0b21lckVtYWlsLCBzZXRDdXN0b21lckVtYWlsXSA9IHVzZVN0YXRlKCcnKVxuICBjb25zdCBbY3VzdG9tZXJQaG9uZSwgc2V0Q3VzdG9tZXJQaG9uZV0gPSB1c2VTdGF0ZSgnJylcbiAgY29uc3QgW2lzU3RhcnRlZCwgc2V0SXNTdGFydGVkXSA9IHVzZVN0YXRlKGZhbHNlKVxuICBjb25zdCBbc2hvd1VuaWZpZWRNb2RhbCwgc2V0U2hvd1VuaWZpZWRNb2RhbF0gPSB1c2VTdGF0ZShmYWxzZSlcbiAgY29uc3QgW2N1cnJlbnRUZW1wbGF0ZSwgc2V0Q3VycmVudFRlbXBsYXRlXSA9IHVzZVN0YXRlPGFueT4obnVsbClcbiAgY29uc3QgW2lzU3VibWl0dGluZ1RlbXBsYXRlLCBzZXRJc1N1Ym1pdHRpbmdUZW1wbGF0ZV0gPSB1c2VTdGF0ZShmYWxzZSlcbiAgY29uc3QgW21vZGFsTW9kZSwgc2V0TW9kYWxNb2RlXSA9IHVzZVN0YXRlPCd0ZW1wbGF0ZScgfCAnZGlyZWN0Jz4oJ2RpcmVjdCcpXG4gIGNvbnN0IFtzaG93U3VydmV5TW9kYWwsIHNldFNob3dTdXJ2ZXlNb2RhbF0gPSB1c2VTdGF0ZShmYWxzZSlcbiAgY29uc3QgW3N1cnZleUNhc2UsIHNldFN1cnZleUNhc2VdID0gdXNlU3RhdGU8YW55PihudWxsKVxuICBjb25zdCBtZXNzYWdlc0VuZFJlZiA9IHVzZVJlZjxIVE1MRGl2RWxlbWVudD4obnVsbClcblxuICAvLyBTdG9yYWdlIGtleXMgZm9yIHBlcnNpc3RlbmNlXG4gIGNvbnN0IHN0b3JhZ2VLZXkgPSBgY2hhdF8ke3Byb3ZpZGVyLmlkfWBcbiAgY29uc3QgY29udmVyc2F0aW9uS2V5ID0gYGNvbnZlcnNhdGlvbl8ke3Byb3ZpZGVyLmlkfWBcblxuICBjb25zdCBzY3JvbGxUb0JvdHRvbSA9ICgpID0+IHtcbiAgICBtZXNzYWdlc0VuZFJlZi5jdXJyZW50Py5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJyB9KVxuICB9XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBzY3JvbGxUb0JvdHRvbSgpXG4gIH0sIFttZXNzYWdlc10pXG5cbiAgLy8gSW5pdGlhbGl6ZSB1c2VyIGRhdGEgb25seSBvbmNlIHdoZW4gbW9kYWwgb3BlbnNcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBpbml0aWFsaXplQ2hhdCA9IGFzeW5jICgpID0+IHtcbiAgICAgIGlmIChpc09wZW4gJiYgaXNBdXRoZW50aWNhdGVkICYmIHVzZXIgJiYgIWlzU3RhcnRlZCkge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+XqO+4jyBDaGF0TW9kYWwgb3BlbmVkIGZvciBwcm92aWRlcjonLCBwcm92aWRlci5pZClcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZ1bGxOYW1lID0gYCR7dXNlci5maXJzdE5hbWUgfHwgJyd9ICR7dXNlci5sYXN0TmFtZSB8fCAnJ31gLnRyaW0oKVxuICAgICAgICBjb25zdCBmaW5hbE5hbWUgPSBmdWxsTmFtZSB8fCAnVXNlcidcbiAgICAgICAgXG4gICAgICAgIHNldEN1c3RvbWVyTmFtZShmaW5hbE5hbWUpXG4gICAgICAgIHNldEN1c3RvbWVyRW1haWwodXNlci5lbWFpbCB8fCAnJylcbiAgICAgICAgc2V0Q3VzdG9tZXJQaG9uZSh1c2VyLnBob25lTnVtYmVyIHx8ICcnKVxuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgZm9yIGV4aXN0aW5nIGNvbnZlcnNhdGlvblxuICAgICAgICBjb25zdCBzYXZlZENvbnZlcnNhdGlvbklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oY29udmVyc2F0aW9uS2V5KVxuICAgICAgICBpZiAoc2F2ZWRDb252ZXJzYXRpb25JZCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIEZvdW5kIHNhdmVkIGNvbnZlcnNhdGlvbiBJRDonLCBzYXZlZENvbnZlcnNhdGlvbklkKVxuICAgICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGhlIGNvbnZlcnNhdGlvbiBleGlzdHMgYnkgdHJ5aW5nIHRvIGxvYWQgbWVzc2FnZXNcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbWVzc2FnZXNSZXNwb25zZSA9IGF3YWl0IGFwaUNsaWVudC5nZXRDb252ZXJzYXRpb25NZXNzYWdlcyhzYXZlZENvbnZlcnNhdGlvbklkKVxuICAgICAgICAgICAgaWYgKG1lc3NhZ2VzUmVzcG9uc2UuZGF0YT8uc3VjY2Vzcykge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIFNhdmVkIGNvbnZlcnNhdGlvbiBpcyB2YWxpZCwgdXNpbmcgaXQnKVxuICAgICAgICAgICAgICBzZXRDb252ZXJzYXRpb25JZChzYXZlZENvbnZlcnNhdGlvbklkKVxuICAgICAgICAgICAgICBzZXRJc1N0YXJ0ZWQodHJ1ZSlcbiAgICAgICAgICAgICAgbG9hZE1lc3NhZ2VzKHNhdmVkQ29udmVyc2F0aW9uSWQpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygn4p2MIFNhdmVkIGNvbnZlcnNhdGlvbiBpcyBpbnZhbGlkLCBjcmVhdGluZyBuZXcgb25lJylcbiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oY29udmVyc2F0aW9uS2V5KVxuICAgICAgICAgICAgICBhd2FpdCBzdGFydENvbnZlcnNhdGlvbih7IFxuICAgICAgICAgICAgICAgIG5hbWU6IGZpbmFsTmFtZSwgXG4gICAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwgfHwgJycsIFxuICAgICAgICAgICAgICAgIHBob25lOiB1c2VyLnBob25lTnVtYmVyIHx8ICcnIFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygn4p2MIEVycm9yIHZhbGlkYXRpbmcgc2F2ZWQgY29udmVyc2F0aW9uLCBjcmVhdGluZyBuZXcgb25lOicsIGVycm9yKVxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oY29udmVyc2F0aW9uS2V5KVxuICAgICAgICAgICAgYXdhaXQgc3RhcnRDb252ZXJzYXRpb24oeyBcbiAgICAgICAgICAgICAgbmFtZTogZmluYWxOYW1lLCBcbiAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwgfHwgJycsIFxuICAgICAgICAgICAgICBwaG9uZTogdXNlci5waG9uZU51bWJlciB8fCAnJyBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEF1dG8tc3RhcnQgY29udmVyc2F0aW9uIGZvciBhdXRoZW50aWNhdGVkIHVzZXJzXG4gICAgICAgICAgYXdhaXQgc3RhcnRDb252ZXJzYXRpb24oeyBcbiAgICAgICAgICAgIG5hbWU6IGZpbmFsTmFtZSwgXG4gICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCB8fCAnJywgXG4gICAgICAgICAgICBwaG9uZTogdXNlci5waG9uZU51bWJlciB8fCAnJyBcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGluaXRpYWxpemVDaGF0KClcbiAgfSwgW2lzT3BlbiwgaXNBdXRoZW50aWNhdGVkLCB1c2VyLCBwcm92aWRlci5pZF0pXG5cbiAgLy8gSm9pbiBjb252ZXJzYXRpb24gcm9vbSB3aGVuIG1vZGFsIG9wZW5zXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFpc09wZW4gfHwgIWNvbnZlcnNhdGlvbklkIHx8ICFzb2NrZXQgfHwgIWlzQ29ubmVjdGVkKSByZXR1cm5cblxuICAgIGNvbnNvbGUubG9nKCfwn4+gIENoYXRNb2RhbCAtIEpvaW5pbmcgY29udmVyc2F0aW9uIHJvb206JywgY29udmVyc2F0aW9uSWQpXG4gICAgc29ja2V0LmVtaXQoJ2pvaW4tY29udmVyc2F0aW9uJywgY29udmVyc2F0aW9uSWQpXG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ/CfmqogQ2hhdE1vZGFsIC0gTGVhdmluZyBjb252ZXJzYXRpb24gcm9vbTonLCBjb252ZXJzYXRpb25JZClcbiAgICAgIC8vIERvbid0IGRpc2Nvbm5lY3QgdGhlIGdsb2JhbCBzb2NrZXQsIGp1c3QgbGVhdmUgdGhlIHJvb21cbiAgICB9XG4gIH0sIFtpc09wZW4sIGNvbnZlcnNhdGlvbklkLCBzb2NrZXQsIGlzQ29ubmVjdGVkXSlcblxuICAvLyBTZXR1cCByZWFsLXRpbWUgbWVzc2FnZSBsaXN0ZW5lcnNcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIXNvY2tldCB8fCAhY29udmVyc2F0aW9uSWQpIHJldHVyblxuXG4gICAgY29uc3QgaGFuZGxlTmV3TWVzc2FnZSA9IChkYXRhOiBhbnkpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5KsIEN1c3RvbWVyIHJlY2VpdmVkIG5ldyBtZXNzYWdlOicsIGRhdGEpXG4gICAgICBcbiAgICAgIC8vIE9ubHkgYWRkIG1lc3NhZ2VzIGZyb20gcHJvdmlkZXJzIChub3Qgb3VyIG93biBtZXNzYWdlcylcbiAgICAgIGlmIChkYXRhLmNvbnZlcnNhdGlvbklkID09PSBjb252ZXJzYXRpb25JZCAmJiBkYXRhLm1lc3NhZ2VJZCAmJiBkYXRhLnNlbmRlclR5cGUgPT09ICdwcm92aWRlcicpIHtcbiAgICAgICAgY29uc3QgbmV3TWVzc2FnZTogTWVzc2FnZSA9IHtcbiAgICAgICAgICBpZDogZGF0YS5tZXNzYWdlSWQsXG4gICAgICAgICAgY29udmVyc2F0aW9uSWQ6IGRhdGEuY29udmVyc2F0aW9uSWQsXG4gICAgICAgICAgc2VuZGVyVHlwZTogZGF0YS5zZW5kZXJUeXBlLFxuICAgICAgICAgIHNlbmRlck5hbWU6IGRhdGEuc2VuZGVyTmFtZSxcbiAgICAgICAgICBtZXNzYWdlOiBkYXRhLm1lc3NhZ2UsXG4gICAgICAgICAgbWVzc2FnZVR5cGU6IGRhdGEubWVzc2FnZVR5cGUsXG4gICAgICAgICAgdGltZXN0YW1wOiBkYXRhLnRpbWVzdGFtcFxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBzZXRNZXNzYWdlcyhwcmV2ID0+IHtcbiAgICAgICAgICBjb25zdCBtZXNzYWdlRXhpc3RzID0gcHJldi5zb21lKG1zZyA9PiBtc2cuaWQgPT09IGRhdGEubWVzc2FnZUlkKVxuICAgICAgICAgIGlmIChtZXNzYWdlRXhpc3RzKSByZXR1cm4gcHJldlxuICAgICAgICAgIFxuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5OdIEFkZGluZyBwcm92aWRlciBtZXNzYWdlIHRvIGN1c3RvbWVyIGNoYXQ6JywgbmV3TWVzc2FnZSlcbiAgICAgICAgICByZXR1cm4gWy4uLnByZXYsIG5ld01lc3NhZ2VdXG4gICAgICAgIH0pXG4gICAgICAgIHNjcm9sbFRvQm90dG9tKClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBzb2NrZXQub24oJ25ld19tZXNzYWdlJywgaGFuZGxlTmV3TWVzc2FnZSlcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBzb2NrZXQub2ZmKCduZXdfbWVzc2FnZScsIGhhbmRsZU5ld01lc3NhZ2UpXG4gICAgfVxuICB9LCBbc29ja2V0LCBjb252ZXJzYXRpb25JZF0pXG5cbiAgY29uc3Qgc3RhcnRDb252ZXJzYXRpb24gPSBhc3luYyAob3ZlcnJpZGVEYXRhPzogeyBuYW1lPzogc3RyaW5nLCBlbWFpbD86IHN0cmluZywgcGhvbmU/OiBzdHJpbmcgfSkgPT4ge1xuICAgIGlmIChsb2FkaW5nIHx8IGlzU3RhcnRlZCB8fCBjb252ZXJzYXRpb25JZCkge1xuICAgICAgY29uc29sZS5sb2coJ+KPre+4jyBTa2lwcGluZyBjb252ZXJzYXRpb24gY3JlYXRpb24gLSBhbHJlYWR5IGV4aXN0cyBvciBpbiBwcm9ncmVzcycpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBzZXRMb2FkaW5nKHRydWUpXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIHByb3ZpZGVySWQ6IHByb3ZpZGVyLmlkLFxuICAgICAgICBjdXN0b21lcklkOiB1c2VyPy5pZCB8fCB1bmRlZmluZWQsIC8vIEFkZCBhdXRoZW50aWNhdGVkIHVzZXIgSURcbiAgICAgICAgY3VzdG9tZXJOYW1lOiBvdmVycmlkZURhdGE/Lm5hbWUgfHwgY3VzdG9tZXJOYW1lLFxuICAgICAgICBjdXN0b21lckVtYWlsOiBvdmVycmlkZURhdGE/LmVtYWlsIHx8IGN1c3RvbWVyRW1haWwsXG4gICAgICAgIGN1c3RvbWVyUGhvbmU6IG92ZXJyaWRlRGF0YT8ucGhvbmUgfHwgY3VzdG9tZXJQaG9uZVxuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZygn8J+agCBTdGFydGluZyBjb252ZXJzYXRpb24gd2l0aCBkYXRhOicsIGRhdGEpXG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpQ2xpZW50LmNyZWF0ZU9yR2V0Q29udmVyc2F0aW9uKGRhdGEpXG4gICAgICBcbiAgICAgIGlmIChyZXNwb25zZS5kYXRhPy5zdWNjZXNzICYmIHJlc3BvbnNlLmRhdGE/LmRhdGE/LmNvbnZlcnNhdGlvbklkKSB7XG4gICAgICAgIGNvbnN0IG5ld0NvbnZlcnNhdGlvbklkID0gcmVzcG9uc2UuZGF0YS5kYXRhLmNvbnZlcnNhdGlvbklkXG4gICAgICAgIHNldENvbnZlcnNhdGlvbklkKG5ld0NvbnZlcnNhdGlvbklkKVxuICAgICAgICBzZXRJc1N0YXJ0ZWQodHJ1ZSlcbiAgICAgICAgXG4gICAgICAgIC8vIFNhdmUgdG8gbG9jYWxTdG9yYWdlXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHN0b3JhZ2VLZXksIEpTT04uc3RyaW5naWZ5KGRhdGEpKVxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShjb252ZXJzYXRpb25LZXksIG5ld0NvbnZlcnNhdGlvbklkKVxuICAgICAgICBcbiAgICAgICAgLy8gTG9hZCBleGlzdGluZyBtZXNzYWdlc1xuICAgICAgICBhd2FpdCBsb2FkTWVzc2FnZXMobmV3Q29udmVyc2F0aW9uSWQpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN0YXJ0aW5nIGNvbnZlcnNhdGlvbjonLCBlcnJvcilcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSlcbiAgICB9XG4gIH1cblxuICBjb25zdCBsb2FkTWVzc2FnZXMgPSBhc3luYyAoY29udklkOiBzdHJpbmcpID0+IHtcbiAgICB0cnkge1xuICAgICAgc2V0TG9hZGluZyh0cnVlKVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQuZ2V0TWFya2V0cGxhY2VNZXNzYWdlcyhjb252SWQpXG4gICAgICBpZiAocmVzcG9uc2UuZGF0YT8uc3VjY2VzcyAmJiBBcnJheS5pc0FycmF5KHJlc3BvbnNlLmRhdGEuZGF0YSkpIHtcbiAgICAgICAgc2V0TWVzc2FnZXMocmVzcG9uc2UuZGF0YS5kYXRhKVxuICAgICAgICBzY3JvbGxUb0JvdHRvbSgpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9hZGluZyBtZXNzYWdlczonLCBlcnJvcilcbiAgICAgIC8vIElmIGNvbnZlcnNhdGlvbiBkb2Vzbid0IGV4aXN0LCBhdXRvLXJlY3JlYXRlIGl0XG4gICAgICBpZiAoZXJyb3I/LnJlc3BvbnNlPy5zdGF0dXMgPT09IDQwNCkge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+UpyBDb252ZXJzYXRpb24gbm90IGZvdW5kLCBhdHRlbXB0aW5nIHRvIHJlY3JlYXRlLi4uJylcbiAgICAgICAgYXdhaXQgcmVjcmVhdGVDb252ZXJzYXRpb24oKVxuICAgICAgfVxuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRMb2FkaW5nKGZhbHNlKVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHJlY3JlYXRlQ29udmVyc2F0aW9uID0gYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBwcm92aWRlcklkOiBwcm92aWRlci5pZCxcbiAgICAgICAgY3VzdG9tZXJOYW1lOiBjdXN0b21lck5hbWUsXG4gICAgICAgIGN1c3RvbWVyRW1haWw6IGN1c3RvbWVyRW1haWwsXG4gICAgICAgIGN1c3RvbWVyUGhvbmU6IGN1c3RvbWVyUGhvbmVcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQuY3JlYXRlT3JHZXRDb252ZXJzYXRpb24oZGF0YSlcbiAgICAgIGlmIChyZXNwb25zZS5kYXRhPy5zdWNjZXNzICYmIHJlc3BvbnNlLmRhdGE/LmRhdGE/LmNvbnZlcnNhdGlvbklkKSB7XG4gICAgICAgIGNvbnN0IG5ld0NvbnZlcnNhdGlvbklkID0gcmVzcG9uc2UuZGF0YS5kYXRhLmNvbnZlcnNhdGlvbklkXG4gICAgICAgIHNldENvbnZlcnNhdGlvbklkKG5ld0NvbnZlcnNhdGlvbklkKVxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShjb252ZXJzYXRpb25LZXksIG5ld0NvbnZlcnNhdGlvbklkKVxuICAgICAgICBjb25zb2xlLmxvZygn4pyFIENvbnZlcnNhdGlvbiByZWNyZWF0ZWQ6JywgbmV3Q29udmVyc2F0aW9uSWQpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byByZWNyZWF0ZSBjb252ZXJzYXRpb246JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgY29uc3QgaGFuZGxlQ2FzZVRlbXBsYXRlQ2xpY2sgPSBhc3luYyAobWVzc2FnZTogTWVzc2FnZSkgPT4ge1xuICAgIGlmIChtZXNzYWdlLm1lc3NhZ2VUeXBlICE9PSAnY2FzZV90ZW1wbGF0ZScpIHJldHVybjtcbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IHRoZSBzZXJ2aWNlIGNhdGVnb3J5IGZyb20gcHJvdmlkZXJcbiAgICAgIGNvbnN0IHNlcnZpY2VDYXRlZ29yeSA9IHByb3ZpZGVyLnNlcnZpY2VDYXRlZ29yeSB8fCBwcm92aWRlci5zZXJ2aWNlX2NhdGVnb3J5IHx8ICdnZW5lcmFsJztcbiAgICAgIFxuICAgICAgLy8gRmV0Y2ggdGhlIGNhc2UgdGVtcGxhdGVcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpQ2xpZW50LmdldENhc2VUZW1wbGF0ZShzZXJ2aWNlQ2F0ZWdvcnkpO1xuICAgICAgXG4gICAgICBpZiAocmVzcG9uc2UuZGF0YT8uc3VjY2VzcyAmJiByZXNwb25zZS5kYXRhPy5kYXRhKSB7XG4gICAgICAgIGNvbnN0IHRlbXBsYXRlRGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2UuZGF0YS5kYXRhLnRlbXBsYXRlX2RhdGEpO1xuICAgICAgICBzZXRDdXJyZW50VGVtcGxhdGUoe1xuICAgICAgICAgIC4uLnJlc3BvbnNlLmRhdGEuZGF0YSxcbiAgICAgICAgICB0ZW1wbGF0ZURhdGFcbiAgICAgICAgfSk7XG4gICAgICAgIHNldE1vZGFsTW9kZSgndGVtcGxhdGUnKTtcbiAgICAgICAgc2V0U2hvd1VuaWZpZWRNb2RhbCh0cnVlKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9hZGluZyBjYXNlIHRlbXBsYXRlOicsIGVycm9yKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlVGVtcGxhdGVTdWJtaXQgPSBhc3luYyAoZm9ybURhdGE6IFJlY29yZDxzdHJpbmcsIGFueT4pID0+IHtcbiAgICBpZiAoIWNvbnZlcnNhdGlvbklkIHx8ICFjdXJyZW50VGVtcGxhdGUpIHJldHVybjtcblxuICAgIHNldElzU3VibWl0dGluZ1RlbXBsYXRlKHRydWUpO1xuICAgIHRyeSB7XG4gICAgICAvLyBDcmVhdGUgb3IgdXBkYXRlIHNlcnZpY2UgY2FzZSB3aXRoIGZpbGxlZCBkYXRhXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaUNsaWVudC5jcmVhdGVTZXJ2aWNlQ2FzZSh7XG4gICAgICAgIGNvbnZlcnNhdGlvbklkLFxuICAgICAgICB0ZW1wbGF0ZUlkOiBjdXJyZW50VGVtcGxhdGUuaWQsXG4gICAgICAgIGNhc2VEYXRhOiBmb3JtRGF0YVxuICAgICAgfSk7XG5cbiAgICAgIGlmIChyZXNwb25zZS5kYXRhPy5zdWNjZXNzKSB7XG4gICAgICAgIC8vIFNlbmQgYSBtZXNzYWdlIHRvIHRoZSBwcm92aWRlciB3aXRoIHRoZSBmaWxsZWQgdGVtcGxhdGVcbiAgICAgICAgY29uc3Qgc3VtbWFyeU1lc3NhZ2UgPSBg8J+TiyDQn9C+0L/RitC70L3QuNGFINGE0L7RgNC80LDRgtCwINGBINC40L3RhNC+0YDQvNCw0YbQuNGPINC30LAg0L/RgNC+0LHQu9C10LzQsDpcblxuJHtPYmplY3QuZW50cmllcyhmb3JtRGF0YSkubWFwKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgY29uc3QgZmllbGQgPSBjdXJyZW50VGVtcGxhdGUudGVtcGxhdGVEYXRhLmZpZWxkcy5maW5kKChmOiBhbnkpID0+IGYuaWQgPT09IGtleSk7XG4gIGNvbnN0IGxhYmVsID0gZmllbGQ/LmxhYmVsIHx8IGtleTtcbiAgcmV0dXJuIGAke2xhYmVsfTogJHt2YWx1ZX1gO1xufSkuam9pbignXFxuJyl9YDtcblxuICAgICAgICAvLyBTZW5kIHRoZSBzdW1tYXJ5IG1lc3NhZ2VcbiAgICAgICAgY29uc3QgbWVzc2FnZVJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBJX1VSTCB8fCAnaHR0cDovLzE5Mi4xNjguMC4xMjk6MzAwMC9hcGkvdjEnfS9jaGF0L21lc3NhZ2VzYCwge1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbklkLFxuICAgICAgICAgICAgc2VuZGVyVHlwZTogJ2N1c3RvbWVyJyxcbiAgICAgICAgICAgIHNlbmRlck5hbWU6IGN1c3RvbWVyTmFtZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IHN1bW1hcnlNZXNzYWdlLFxuICAgICAgICAgICAgbWVzc2FnZVR5cGU6ICdjYXNlX2ZpbGxlZCdcbiAgICAgICAgICB9KVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAobWVzc2FnZVJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgLy8gQWRkIG1lc3NhZ2UgdG8gbG9jYWwgc3RhdGVcbiAgICAgICAgICBjb25zdCBuZXdNZXNzYWdlOiBNZXNzYWdlID0ge1xuICAgICAgICAgICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbklkOiBjb252ZXJzYXRpb25JZCEsXG4gICAgICAgICAgICBzZW5kZXJUeXBlOiAnY3VzdG9tZXInLFxuICAgICAgICAgICAgc2VuZGVyTmFtZTogY3VzdG9tZXJOYW1lLFxuICAgICAgICAgICAgbWVzc2FnZTogc3VtbWFyeU1lc3NhZ2UsXG4gICAgICAgICAgICBtZXNzYWdlVHlwZTogJ2Nhc2VfZmlsbGVkJyxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgfTtcbiAgICAgICAgICBzZXRNZXNzYWdlcyhwcmV2ID0+IFsuLi5wcmV2LCBuZXdNZXNzYWdlXSk7XG4gICAgICAgIH1cblxuICAgICAgICBzZXRTaG93VW5pZmllZE1vZGFsKGZhbHNlKTtcbiAgICAgICAgc2V0Q3VycmVudFRlbXBsYXRlKG51bGwpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzdWJtaXR0aW5nIHRlbXBsYXRlOicsIGVycm9yKVxuICAgICAgYWxlcnQoJ9CS0YrQt9C90LjQutC90LAg0LPRgNC10YjQutCwINC/0YDQuCDQuNC30L/RgNCw0YnQsNC90LXRgtC+INC90LAg0YTQvtGA0LzQsNGC0LAnKVxuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc1N1Ym1pdHRpbmdUZW1wbGF0ZShmYWxzZSlcbiAgICB9XG4gIH1cblxuICBjb25zdCBoYW5kbGVDYXNlQ3JlYXRpb24gPSBhc3luYyAoY2FzZURhdGE6IGFueSkgPT4ge1xuICAgIGlmICghY29udmVyc2F0aW9uSWQpIHJldHVyblxuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+TiyBDaGF0TW9kYWwgLSBDcmVhdGluZyBjYXNlIHdpdGggZGF0YTonLCBjYXNlRGF0YSlcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OLIENoYXRNb2RhbCAtIFByb3ZpZGVyIG9iamVjdDonLCBwcm92aWRlcilcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OLIENoYXRNb2RhbCAtIEFzc2lnbm1lbnQgdHlwZTonLCBjYXNlRGF0YS5hc3NpZ25tZW50VHlwZSlcbiAgICAgIFxuICAgICAgLy8gUHJlcGFyZSBjYXNlIGRhdGEgZm9yIEFQSVxuICAgICAgY29uc3QgY2FzZVBheWxvYWQgPSB7XG4gICAgICAgIHNlcnZpY2VUeXBlOiBjYXNlRGF0YS5zZXJ2aWNlVHlwZSxcbiAgICAgICAgZGVzY3JpcHRpb246IGNhc2VEYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICBwcmVmZXJyZWREYXRlOiBjYXNlRGF0YS5wcmVmZXJyZWREYXRlLFxuICAgICAgICBwcmVmZXJyZWRUaW1lOiBjYXNlRGF0YS5wcmVmZXJyZWRUaW1lLFxuICAgICAgICBwcmlvcml0eTogY2FzZURhdGEucHJpb3JpdHkgfHwgJ25vcm1hbCcsXG4gICAgICAgIGFkZHJlc3M6IGNhc2VEYXRhLmFkZHJlc3MsXG4gICAgICAgIHBob25lOiBjYXNlRGF0YS5waG9uZSxcbiAgICAgICAgYWRkaXRpb25hbERldGFpbHM6IGNhc2VEYXRhLmFkZGl0aW9uYWxEZXRhaWxzIHx8ICcnLFxuICAgICAgICAvLyBIYW5kbGUgYXNzaWdubWVudCBiYXNlZCBvbiBcItGC0LjQvyDQt9Cw0Y/QstC60LBcIiBzZWxlY3Rpb25cbiAgICAgICAgYXNzaWdubWVudFR5cGU6IGNhc2VEYXRhLmFzc2lnbm1lbnRUeXBlIHx8ICdzcGVjaWZpYycsXG4gICAgICAgIHByb3ZpZGVySWQ6IGNhc2VEYXRhLmFzc2lnbm1lbnRUeXBlID09PSAnc3BlY2lmaWMnID8gcHJvdmlkZXIuaWQgOiBudWxsLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogY29udmVyc2F0aW9uSWQsXG4gICAgICAgIGN1c3RvbWVySWQ6IHVzZXIhLmlkLCAvLyBBZGQgdGhlIGFjdHVhbCB1c2VyIElEXG4gICAgICAgIGN1c3RvbWVyTmFtZTogY3VzdG9tZXJOYW1lLFxuICAgICAgICBjdXN0b21lckVtYWlsOiBjdXN0b21lckVtYWlsLFxuICAgICAgICBjdXN0b21lclBob25lOiBjdXN0b21lclBob25lXG4gICAgICB9XG4gICAgICBjb25zb2xlLmxvZygn8J+TiyBDaGF0TW9kYWwgLSBDYXNlIHBheWxvYWQ6JywgY2FzZVBheWxvYWQpXG4gICAgICBjb25zb2xlLmxvZygn8J+TiyBDaGF0TW9kYWwgLSBGaW5hbCBwcm92aWRlcklkIGZvciBhc3NpZ25tZW50OicsIGNhc2VQYXlsb2FkLnByb3ZpZGVySWQpXG4gICAgICBjb25zb2xlLmxvZygn8J+TiyBDaGF0TW9kYWwgLSBBc3NpZ25tZW50IGxvZ2ljOiBhc3NpZ25tZW50VHlwZSA9JywgY2FzZURhdGEuYXNzaWdubWVudFR5cGUsICdwcm92aWRlci5pZCA9JywgcHJvdmlkZXIuaWQpXG5cbiAgICAgIC8vIENyZWF0ZSB0aGUgYWN0dWFsIGNhc2UgaW4gdGhlIHN5c3RlbVxuICAgICAgY29uc3QgY2FzZVJlc3BvbnNlID0gYXdhaXQgYXBpQ2xpZW50LmNyZWF0ZUNhc2UoY2FzZVBheWxvYWQpXG4gICAgICBcbiAgICAgIGlmIChjYXNlUmVzcG9uc2UuZGF0YT8uc3VjY2Vzcykge1xuICAgICAgICBjb25zdCBjcmVhdGVkQ2FzZSA9IGNhc2VSZXNwb25zZS5kYXRhLmRhdGFcbiAgICAgICAgY29uc29sZS5sb2coJ+KchSBDaGF0TW9kYWwgLSBDYXNlIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5OicsIGNyZWF0ZWRDYXNlKVxuXG4gICAgICAgIC8vIENyZWF0ZSBhIG5vdGlmaWNhdGlvbiBtZXNzYWdlIGluIHRoZSBjaGF0XG4gICAgICAgIGxldCBub3RpZmljYXRpb25NZXNzYWdlID0gYOKchSDQl9Cw0Y/QstC60LDRgtCwINC1INGB0YrQt9C00LDQtNC10L3QsCDRg9GB0L/QtdGI0L3QviFcblxu8J+TiyDQndC+0LzQtdGAINC90LAg0LfQsNGP0LLQutCw0YLQsDogIyR7Y3JlYXRlZENhc2UuaWR9XG7wn5SnINCj0YHQu9GD0LPQsDogJHtjYXNlRGF0YS5zZXJ2aWNlVHlwZX1cbvCfk40g0JDQtNGA0LXRgTogJHtjYXNlRGF0YS5hZGRyZXNzfVxu8J+ThSDQlNCw0YLQsDogJHtjYXNlRGF0YS5wcmVmZXJyZWREYXRlfVxu4o+wINCS0YDQtdC80LU6ICR7Y2FzZURhdGEucHJlZmVycmVkVGltZSB8fCAn0KHRg9GC0YDQuNC9ICg4OjAwLTEyOjAwKSd9XG5cbiR7Y2FzZURhdGEuYXNzaWdubWVudFR5cGUgPT09ICdzcGVjaWZpYycgXG4gID8gYPCfjq8g0JfQsNGP0LLQutCw0YLQsCDQtSDQvdCw0YHQvtGH0LXQvdCwINC00LjRgNC10LrRgtC90L4g0LrRitC8ICR7cHJvdmlkZXIuYnVzaW5lc3NOYW1lIHx8IHByb3ZpZGVyLmJ1c2luZXNzX25hbWV9YFxuICA6ICfwn4yQINCX0LDRj9Cy0LrQsNGC0LAg0LUg0L/QvtGB0YLQsNCy0LXQvdCwINCyINC+0LHRidCw0YLQsCDQvtC/0LDRiNC60LAg0LfQsCDQstGB0LjRh9C60Lgg0YHQv9C10YbQuNCw0LvQuNGB0YLQuCdcbn1gXG5cbiAgICAgICAgLy8gVHJ5IHRvIHNlbmQgbm90aWZpY2F0aW9uIG1lc3NhZ2UgdG8gY2hhdCAobm9uLWNyaXRpY2FsKVxuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IGFwaUNsaWVudC5zZW5kTWVzc2FnZSh7XG4gICAgICAgICAgICBjb252ZXJzYXRpb25JZCxcbiAgICAgICAgICAgIHNlbmRlclR5cGU6ICdjdXN0b21lcicsXG4gICAgICAgICAgICBzZW5kZXJOYW1lOiBjdXN0b21lck5hbWUsXG4gICAgICAgICAgICBtZXNzYWdlOiBub3RpZmljYXRpb25NZXNzYWdlLFxuICAgICAgICAgICAgbWVzc2FnZVR5cGU6ICdjYXNlX2NyZWF0ZWQnXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIC8vIEFkZCBtZXNzYWdlIHRvIGxvY2FsIHN0YXRlXG4gICAgICAgICAgY29uc3QgbmV3TWVzc2FnZTogTWVzc2FnZSA9IHtcbiAgICAgICAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICBjb252ZXJzYXRpb25JZDogY29udmVyc2F0aW9uSWQhLFxuICAgICAgICAgICAgc2VuZGVyVHlwZTogJ2N1c3RvbWVyJyxcbiAgICAgICAgICAgIHNlbmRlck5hbWU6IGN1c3RvbWVyTmFtZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IG5vdGlmaWNhdGlvbk1lc3NhZ2UsXG4gICAgICAgICAgICBtZXNzYWdlVHlwZTogJ2Nhc2VfY3JlYXRlZCcsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICAgIH1cbiAgICAgICAgICBzZXRNZXNzYWdlcyhwcmV2ID0+IFsuLi5wcmV2LCBuZXdNZXNzYWdlXSlcbiAgICAgICAgfSBjYXRjaCAoY2hhdEVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcign8J+TiyBDaGF0TW9kYWwgLSBGYWlsZWQgdG8gc2VuZCBjaGF0IG5vdGlmaWNhdGlvbiAobm9uLWNyaXRpY2FsKTonLCBjaGF0RXJyb3IpXG4gICAgICAgICAgLy8gRG9uJ3QgdGhyb3cgZXJyb3IgaGVyZSBzaW5jZSBjYXNlIHdhcyBjcmVhdGVkIHN1Y2Nlc3NmdWxseVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2hvdyBzdWNjZXNzIGZlZWRiYWNrXG4gICAgICAgIGFsZXJ0KGDQl9Cw0Y/QstC60LDRgtCwINC1INGB0YrQt9C00LDQtNC10L3QsCDRg9GB0L/QtdGI0L3QviEg0J3QvtC80LXRgDogIyR7Y3JlYXRlZENhc2UuaWR9YClcbiAgICAgICAgXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoY2FzZVJlc3BvbnNlLmRhdGE/Lm1lc3NhZ2UgfHwgJ9CT0YDQtdGI0LrQsCDQv9GA0Lgg0YHRitC30LTQsNCy0LDQvdC10YLQviDQvdCwINC30LDRj9Cy0LrQsNGC0LAnKVxuICAgICAgfVxuICAgICAgXG4gICAgICBzZXRTaG93VW5pZmllZE1vZGFsKGZhbHNlKVxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhc2U6JywgZXJyb3IpXG4gICAgICBhbGVydCgn0JLRitC30L3QuNC60L3QsCDQs9GA0LXRiNC60LAg0L/RgNC4INGB0YrQt9C00LDQstCw0L3QtdGC0L4g0L3QsCDQt9Cw0Y/QstC60LDRgtCwJylcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgc2VuZE1lc3NhZ2UgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKCFuZXdNZXNzYWdlLnRyaW0oKSB8fCBsb2FkaW5nKSByZXR1cm5cblxuICAgIC8vIElmIG5vIGNvbnZlcnNhdGlvbiBleGlzdHMsIGNyZWF0ZSBvbmUgZmlyc3RcbiAgICBsZXQgYWN0aXZlQ29udklkID0gY29udmVyc2F0aW9uSWRcbiAgICBpZiAoIWFjdGl2ZUNvbnZJZCkge1xuICAgICAgY29uc29sZS5sb2coJ/CflKcgTm8gY29udmVyc2F0aW9uIGZvdW5kLCBjcmVhdGluZyBuZXcgb25lLi4uJylcbiAgICAgIGF3YWl0IHN0YXJ0Q29udmVyc2F0aW9uKClcbiAgICAgIC8vIFdhaXQgYSBiaXQgZm9yIHN0YXRlIHRvIHVwZGF0ZSBhbmQgY2hlY2sgYWdhaW5cbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKVxuICAgICAgYWN0aXZlQ29udklkID0gY29udmVyc2F0aW9uSWRcbiAgICAgIGlmICghYWN0aXZlQ29udklkKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gY3JlYXRlIGNvbnZlcnNhdGlvbicpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgIH1cblxuICAgIHNldExvYWRpbmcodHJ1ZSlcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGlDbGllbnQuc2VuZE1lc3NhZ2Uoe1xuICAgICAgICBjb252ZXJzYXRpb25JZDogYWN0aXZlQ29udklkLFxuICAgICAgICBzZW5kZXJUeXBlOiAnY3VzdG9tZXInLFxuICAgICAgICBzZW5kZXJOYW1lOiBjdXN0b21lck5hbWUsXG4gICAgICAgIG1lc3NhZ2U6IG5ld01lc3NhZ2VcbiAgICAgIH0pXG5cbiAgICAgIGlmIChyZXNwb25zZS5kYXRhPy5zdWNjZXNzKSB7XG4gICAgICAgIC8vIEFkZCBjdXN0b21lciBtZXNzYWdlIHRvIFVJIGltbWVkaWF0ZWx5ICh3b24ndCBjb21lIGJhY2sgdmlhIFdlYlNvY2tldClcbiAgICAgICAgY29uc3QgbmV3TXNnOiBNZXNzYWdlID0ge1xuICAgICAgICAgIGlkOiByZXNwb25zZS5kYXRhLmRhdGE/Lm1lc3NhZ2VJZCB8fCBEYXRlLm5vdygpLnRvU3RyaW5nKCksXG4gICAgICAgICAgY29udmVyc2F0aW9uSWQ6IGNvbnZlcnNhdGlvbklkLFxuICAgICAgICAgIHNlbmRlclR5cGU6ICdjdXN0b21lcicsXG4gICAgICAgICAgc2VuZGVyTmFtZTogY3VzdG9tZXJOYW1lLFxuICAgICAgICAgIG1lc3NhZ2U6IG5ld01lc3NhZ2UsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2V0TWVzc2FnZXMocHJldiA9PiBbLi4ucHJldiwgbmV3TXNnXSlcbiAgICAgICAgc2V0TmV3TWVzc2FnZSgnJylcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZW5kaW5nIG1lc3NhZ2U6JywgZXJyb3IpXG4gICAgICBcbiAgICAgIC8vIElmIGNvbnZlcnNhdGlvbiB3YXMgZGVsZXRlZCwgdHJ5IHRvIHJlY3JlYXRlIGFuZCByZXNlbmRcbiAgICAgIGlmIChlcnJvcj8ucmVzcG9uc2U/LnN0YXR1cyA9PT0gNDA0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SnIENvbnZlcnNhdGlvbiBkZWxldGVkLCByZWNyZWF0aW5nIGFuZCByZXRyeWluZy4uLicpXG4gICAgICAgIGF3YWl0IHJlY3JlYXRlQ29udmVyc2F0aW9uKClcbiAgICAgICAgLy8gUmV0cnkgc2VuZGluZyB0aGUgbWVzc2FnZVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHNlbmRNZXNzYWdlKCksIDEwMDApXG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldExvYWRpbmcoZmFsc2UpXG4gICAgfVxuICB9XG5cbiAgY29uc3QgaGFuZGxlQ2xvc2UgPSAoKSA9PiB7XG4gICAgLy8gUmVzZXQgc3RhdGUgd2hlbiBjbG9zaW5nXG4gICAgc2V0TWVzc2FnZXMoW10pXG4gICAgc2V0TmV3TWVzc2FnZSgnJylcbiAgICBzZXRDb252ZXJzYXRpb25JZChudWxsKVxuICAgIHNldElzU3RhcnRlZChmYWxzZSlcbiAgICBvbkNsb3NlKClcbiAgfVxuXG4gIGlmICghaXNPcGVuKSByZXR1cm4gbnVsbFxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJmaXhlZCBpbnNldC0wIGJnLWJsYWNrLzcwIGJhY2tkcm9wLWJsdXItc20gZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgei01MFwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJiZy1zbGF0ZS04MDAgcm91bmRlZC14bCBzaGFkb3ctMnhsIHctZnVsbCBtYXgtdy1tZCBteC00IGgtOTYgZmxleCBmbGV4LWNvbCBib3JkZXIgYm9yZGVyLXdoaXRlLzIwXCI+XG4gICAgICAgIHsvKiBIZWFkZXIgKi99XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctZ3JhZGllbnQtdG8tciBmcm9tLWluZGlnby02MDAgdG8tcHVycGxlLTYwMCB0ZXh0LXdoaXRlIHAtNCByb3VuZGVkLXQteGwgZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtY2VudGVyXCI+XG4gICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJmb250LXNlbWlib2xkXCI+XG4gICAgICAgICAgICAgIHtwcm92aWRlci5idXNpbmVzc05hbWUgfHwgcHJvdmlkZXIuYnVzaW5lc3NfbmFtZSB8fCBgJHtwcm92aWRlci5maXJzdE5hbWUgfHwgcHJvdmlkZXIuZmlyc3RfbmFtZX0gJHtwcm92aWRlci5sYXN0TmFtZSB8fCBwcm92aWRlci5sYXN0X25hbWV9YH1cbiAgICAgICAgICAgIDwvaDM+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtd2hpdGUvODBcIj5cbiAgICAgICAgICAgICAge3Byb3ZpZGVyLnNlcnZpY2VDYXRlZ29yeSB8fCBwcm92aWRlci5zZXJ2aWNlX2NhdGVnb3J5fVxuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZUNsb3NlfVxuICAgICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC13aGl0ZS84MCBob3Zlcjp0ZXh0LXdoaXRlIHRyYW5zaXRpb24tY29sb3JzXCJcbiAgICAgICAgICA+XG4gICAgICAgICAgICA8c3ZnIGNsYXNzTmFtZT1cInctNiBoLTZcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj5cbiAgICAgICAgICAgICAgPHBhdGggc3Ryb2tlTGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlTGluZWpvaW49XCJyb3VuZFwiIHN0cm9rZVdpZHRoPXsyfSBkPVwiTTYgMThMMTggNk02IDZsMTIgMTJcIiAvPlxuICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIHsvKiBNZXNzYWdlcyAqL31cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgb3ZlcmZsb3cteS1hdXRvIHAtNCBzcGFjZS15LTMgYmctc2xhdGUtOTAwLzUwXCI+XG4gICAgICAgICAge2xvYWRpbmcgJiYgbWVzc2FnZXMubGVuZ3RoID09PSAwID8gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LWNlbnRlciB0ZXh0LXNsYXRlLTQwMFwiPtCX0LDRgNC10LbQtNCw0L3QtS4uLjwvZGl2PlxuICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICBtZXNzYWdlcy5tYXAoKG1zZykgPT4gKFxuICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAga2V5PXttc2cuaWR9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgZmxleCAke21zZy5zZW5kZXJUeXBlID09PSAnY3VzdG9tZXInID8gJ2p1c3RpZnktZW5kJyA6ICdqdXN0aWZ5LXN0YXJ0J31gfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgbWF4LXcteHMgcHgtMyBweS0yIHJvdW5kZWQtbGcgdGV4dC1zbSAke1xuICAgICAgICAgICAgICAgICAgICBtc2cuc2VuZGVyVHlwZSA9PT0gJ2N1c3RvbWVyJ1xuICAgICAgICAgICAgICAgICAgICAgID8gJ2JnLWdyYWRpZW50LXRvLXIgZnJvbS1pbmRpZ28tNjAwIHRvLXB1cnBsZS02MDAgdGV4dC13aGl0ZSdcbiAgICAgICAgICAgICAgICAgICAgICA6ICdiZy1zbGF0ZS03MDAgdGV4dC1zbGF0ZS0xMDAgYm9yZGVyIGJvcmRlci1zbGF0ZS02MDAnXG4gICAgICAgICAgICAgICAgICB9YH1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8ZGl2Pnttc2cubWVzc2FnZX08L2Rpdj5cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgey8qIFNob3cgdGVtcGxhdGUgYnV0dG9uIGZvciBjYXNlX3RlbXBsYXRlIG1lc3NhZ2VzICovfVxuICAgICAgICAgICAgICAgICAge21zZy5tZXNzYWdlVHlwZSA9PT0gJ2Nhc2VfdGVtcGxhdGUnICYmIG1zZy5zZW5kZXJUeXBlID09PSAncHJvdmlkZXInICYmIChcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZUNhc2VUZW1wbGF0ZUNsaWNrKG1zZyl9XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXQtMiBweC0zIHB5LTEgYmctZ3JhZGllbnQtdG8tciBmcm9tLWluZGlnby01MDAgdG8tcHVycGxlLTUwMCB0ZXh0LXdoaXRlIHRleHQteHMgcm91bmRlZCBob3ZlcjpzaGFkb3ctbGcgdHJhbnNmb3JtIGhvdmVyOnNjYWxlLTEwNSB0cmFuc2l0aW9uLWFsbCBkdXJhdGlvbi0zMDBcIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAg8J+TiyDQn9C+0L/RitC70L3QuCDRhNC+0YDQvNCw0YLQsFxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIHsvKiBTaG93IHNlcnZpY2UgcmVxdWVzdCBidXR0b24gZm9yIHNlcnZpY2VfcmVxdWVzdCBtZXNzYWdlcyAqL31cbiAgICAgICAgICAgICAgICAgIHttc2cubWVzc2FnZVR5cGUgPT09ICdzZXJ2aWNlX3JlcXVlc3QnICYmIG1zZy5zZW5kZXJUeXBlID09PSAncHJvdmlkZXInICYmIChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtdC0yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPFNlcnZpY2VSZXF1ZXN0QnV0dG9uIFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJOYW1lPXtwcm92aWRlci5idXNpbmVzc05hbWUgfHwgcHJvdmlkZXIuYnVzaW5lc3NfbmFtZSB8fCBgJHtwcm92aWRlci5maXJzdE5hbWUgfHwgcHJvdmlkZXIuZmlyc3RfbmFtZX0gJHtwcm92aWRlci5sYXN0TmFtZSB8fCBwcm92aWRlci5sYXN0X25hbWV9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0TW9kYWxNb2RlKCdkaXJlY3QnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0U2hvd1VuaWZpZWRNb2RhbCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICApfVxuXG4gICAgICAgICAgICAgICAgICB7LyogU2hvdyBzdXJ2ZXkgYnV0dG9uIGZvciBzdXJ2ZXlfcmVxdWVzdCBtZXNzYWdlcyAqL31cbiAgICAgICAgICAgICAgICAgIHttc2cubWVzc2FnZVR5cGUgPT09ICdzdXJ2ZXlfcmVxdWVzdCcgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17YXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXh0cmFjdCBjYXNlIElEIGZyb20gbWVzc2FnZSBkYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn8J+UjSBTdXJ2ZXkgYnV0dG9uIGNsaWNrZWQsIG1lc3NhZ2UgZGF0YTonLCBtc2cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNhc2VJZCA9IG1zZy5jYXNlSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byBwYXJzZSBkYXRhIGZpZWxkIGlmIGl0IGV4aXN0c1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1zZy5kYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkRGF0YSA9IHR5cGVvZiBtc2cuZGF0YSA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKG1zZy5kYXRhKSA6IG1zZy5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIFBhcnNlZCBtZXNzYWdlIGRhdGE6JywgcGFyc2VkRGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZUlkID0gcGFyc2VkRGF0YS5jYXNlSWQgfHwgY2FzZUlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0NvdWxkIG5vdCBwYXJzZSBtZXNzYWdlIGRhdGE6JywgbXNnLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIEZpbmFsIGNhc2VJZCBleHRyYWN0ZWQ6JywgY2FzZUlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhc2VJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZldGNoIGNhc2UgZGV0YWlscyBmb3IgdGhlIHN1cnZleVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpQ2xpZW50LmdldENhc2UoY2FzZUlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YT8uc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0U3VydmV5Q2FzZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjYXNlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyTmFtZTogcHJvdmlkZXIuYnVzaW5lc3NOYW1lIHx8IHByb3ZpZGVyLmJ1c2luZXNzX25hbWUgfHwgYCR7cHJvdmlkZXIuZmlyc3ROYW1lIHx8IHByb3ZpZGVyLmZpcnN0X25hbWV9ICR7cHJvdmlkZXIubGFzdE5hbWUgfHwgcHJvdmlkZXIubGFzdF9uYW1lfWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VUeXBlOiByZXNwb25zZS5kYXRhLmRhdGEuc2VydmljZV90eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWRBdDogcmVzcG9uc2UuZGF0YS5kYXRhLmNvbXBsZXRlZF9hdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHJlc3BvbnNlLmRhdGEuZGF0YS5kZXNjcmlwdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRTaG93U3VydmV5TW9kYWwodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2UgZGV0YWlsczonLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ9CS0YrQt9C90LjQutC90LAg0LPRgNC10YjQutCwINC/0YDQuCDQt9Cw0YDQtdC20LTQsNC90LXRgtC+INC90LAg0LTQtdGC0LDQudC70LjRgtC1INC30LAg0LfQsNGP0LLQutCw0YLQsCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydCgn0J3QtSDQvNC+0LbQtSDQtNCwINGB0LUg0L3QsNC80LXRgNC4IElEINC90LAg0LfQsNGP0LLQutCw0YLQsCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXQtMiBweC00IHB5LTIgYmctZ3JhZGllbnQtdG8tciBmcm9tLXllbGxvdy01MDAgdG8tb3JhbmdlLTUwMCB0ZXh0LXdoaXRlIHRleHQtc20gcm91bmRlZC1sZyBob3Zlcjpmcm9tLXllbGxvdy02MDAgaG92ZXI6dG8tb3JhbmdlLTYwMCB0cmFuc2l0aW9uLWFsbCBkdXJhdGlvbi0yMDAgZmxleCBpdGVtcy1jZW50ZXIgc3BhY2UteC0yXCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPuKtkDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj7QntGG0LXQvdC10YLQtSDRg9GB0LvRg9Cz0LDRgtCwPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgdGV4dC14cyBtdC0xICR7XG4gICAgICAgICAgICAgICAgICAgIG1zZy5zZW5kZXJUeXBlID09PSAnY3VzdG9tZXInID8gJ3RleHQtd2hpdGUvNjAnIDogJ3RleHQtc2xhdGUtNDAwJ1xuICAgICAgICAgICAgICAgICAgfWB9PlxuICAgICAgICAgICAgICAgICAgICB7bmV3IERhdGUobXNnLnRpbWVzdGFtcCkudG9Mb2NhbGVUaW1lU3RyaW5nKCdiZy1CRycsIHtcbiAgICAgICAgICAgICAgICAgICAgICBob3VyOiAnMi1kaWdpdCcsXG4gICAgICAgICAgICAgICAgICAgICAgbWludXRlOiAnMi1kaWdpdCdcbiAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApKVxuICAgICAgICAgICl9XG4gICAgICAgICAgPGRpdiByZWY9e21lc3NhZ2VzRW5kUmVmfSAvPlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICB7LyogSW5wdXQgU2VjdGlvbiAqL31cbiAgICAgICAge2lzU3RhcnRlZCAmJiAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJib3JkZXItdCBib3JkZXItc2xhdGUtNzAwIHAtNCBiZy1zbGF0ZS04MDAvNTBcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBzcGFjZS14LTIgbWItM1wiPlxuICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgdmFsdWU9e25ld01lc3NhZ2V9XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXROZXdNZXNzYWdlKGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgICBvbktleVByZXNzPXsoZSkgPT4gZS5rZXkgPT09ICdFbnRlcicgJiYgc2VuZE1lc3NhZ2UoKX1cbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cItCd0LDQv9C40YjQtdGC0LUg0YHRitC+0LHRidC10L3QuNC1Li4uXCJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmbGV4LTEgYmctc2xhdGUtNzAwIGJvcmRlciBib3JkZXItc2xhdGUtNjAwIHRleHQtd2hpdGUgcm91bmRlZC1sZyBweC0zIHB5LTIgdGV4dC1zbSBmb2N1czpvdXRsaW5lLW5vbmUgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctaW5kaWdvLTUwMCBwbGFjZWhvbGRlcjp0ZXh0LXNsYXRlLTQwMFwiXG4gICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2xvYWRpbmd9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICBvbkNsaWNrPXtzZW5kTWVzc2FnZX1cbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17IW5ld01lc3NhZ2UudHJpbSgpIHx8IGxvYWRpbmd9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYmctZ3JhZGllbnQtdG8tciBmcm9tLWluZGlnby02MDAgdG8tcHVycGxlLTYwMCB0ZXh0LXdoaXRlIHB4LTQgcHktMiByb3VuZGVkLWxnIGRpc2FibGVkOm9wYWNpdHktNTAgZGlzYWJsZWQ6Y3Vyc29yLW5vdC1hbGxvd2VkIGhvdmVyOnNoYWRvdy1sZyB0cmFuc2Zvcm0gaG92ZXI6c2NhbGUtMTA1IHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTMwMFwiXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7bG9hZGluZyA/ICcuLi4nIDogJ9CY0LfQv9GA0LDRgtC4J31cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgey8qIFF1aWNrIEFjdGlvbiBCdXR0b24gKi99XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgganVzdGlmeS1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgIHNldE1vZGFsTW9kZSgnZGlyZWN0Jyk7XG4gICAgICAgICAgICAgICAgICBzZXRTaG93VW5pZmllZE1vZGFsKHRydWUpO1xuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYmctZ3JhZGllbnQtdG8tciBmcm9tLWdyZWVuLTUwMCB0by1ibHVlLTUwMCB0ZXh0LXdoaXRlIHB4LTQgcHktMiByb3VuZGVkLWxnIHRleHQtc20gZm9udC1tZWRpdW0gaG92ZXI6ZnJvbS1ncmVlbi02MDAgaG92ZXI6dG8tYmx1ZS02MDAgdHJhbnNpdGlvbi1hbGwgZHVyYXRpb24tMjAwIGZsZXggaXRlbXMtY2VudGVyIHNwYWNlLXgtMlwiXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8c3Bhbj7wn5SnPC9zcGFuPlxuICAgICAgICAgICAgICAgIDxzcGFuPtCh0YrQt9C00LDQuSDQt9Cw0Y/QstC60LAg0LfQsCDRg9GB0LvRg9Cz0LA8L3NwYW4+XG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICl9XG5cbiAgICAgICAgey8qIFN0YXJ0IENoYXQgRm9ybSAqL31cbiAgICAgICAgeyFpc1N0YXJ0ZWQgJiYgIWxvYWRpbmcgJiYgKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC00IGJvcmRlci10IGJvcmRlci1zbGF0ZS03MDAgYmctc2xhdGUtODAwLzUwXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktM1wiPlxuICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCLQktCw0YjQtdGC0L4g0LjQvNC1XCJcbiAgICAgICAgICAgICAgICB2YWx1ZT17Y3VzdG9tZXJOYW1lfVxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0Q3VzdG9tZXJOYW1lKGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LWZ1bGwgYmctc2xhdGUtNzAwIGJvcmRlciBib3JkZXItc2xhdGUtNjAwIHRleHQtd2hpdGUgcm91bmRlZC1sZyBweC0zIHB5LTIgdGV4dC1zbSBmb2N1czpvdXRsaW5lLW5vbmUgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctaW5kaWdvLTUwMCBwbGFjZWhvbGRlcjp0ZXh0LXNsYXRlLTQwMFwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgIHR5cGU9XCJlbWFpbFwiXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJFbWFpbCDQsNC00YDQtdGBXCJcbiAgICAgICAgICAgICAgICB2YWx1ZT17Y3VzdG9tZXJFbWFpbH1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEN1c3RvbWVyRW1haWwoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBiZy1zbGF0ZS03MDAgYm9yZGVyIGJvcmRlci1zbGF0ZS02MDAgdGV4dC13aGl0ZSByb3VuZGVkLWxnIHB4LTMgcHktMiB0ZXh0LXNtIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1pbmRpZ28tNTAwIHBsYWNlaG9sZGVyOnRleHQtc2xhdGUtNDAwXCJcbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgdHlwZT1cInRlbFwiXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCLQotC10LvQtdGE0L7QvVwiXG4gICAgICAgICAgICAgICAgdmFsdWU9e2N1c3RvbWVyUGhvbmV9XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRDdXN0b21lclBob25lKGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LWZ1bGwgYmctc2xhdGUtNzAwIGJvcmRlciBib3JkZXItc2xhdGUtNjAwIHRleHQtd2hpdGUgcm91bmRlZC1sZyBweC0zIHB5LTIgdGV4dC1zbSBmb2N1czpvdXRsaW5lLW5vbmUgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctaW5kaWdvLTUwMCBwbGFjZWhvbGRlcjp0ZXh0LXNsYXRlLTQwMFwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzdGFydENvbnZlcnNhdGlvbigpfVxuICAgICAgICAgICAgICAgIGRpc2FibGVkPXshY3VzdG9tZXJOYW1lIHx8ICFjdXN0b21lckVtYWlsfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBiZy1ncmFkaWVudC10by1yIGZyb20taW5kaWdvLTYwMCB0by1wdXJwbGUtNjAwIHRleHQtd2hpdGUgcHktMiByb3VuZGVkLWxnIGRpc2FibGVkOm9wYWNpdHktNTAgZGlzYWJsZWQ6Y3Vyc29yLW5vdC1hbGxvd2VkIGhvdmVyOnNoYWRvdy1sZyB0cmFuc2Zvcm0gaG92ZXI6c2NhbGUtMTA1IHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTMwMFwiXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICDQl9Cw0L/QvtGH0L3QuCDRgNCw0LfQs9C+0LLQvtGAXG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICl9XG4gICAgPC9kaXY+XG5cbiAgICB7LyogVW5pZmllZCBDYXNlIE1vZGFsICovfVxuICAgIHtzaG93VW5pZmllZE1vZGFsICYmIChcbiAgICAgIDxVbmlmaWVkQ2FzZU1vZGFsXG4gICAgICAgIGlzT3Blbj17c2hvd1VuaWZpZWRNb2RhbH1cbiAgICAgICAgbW9kZT17bW9kYWxNb2RlfVxuICAgICAgICB0ZW1wbGF0ZURhdGE9e2N1cnJlbnRUZW1wbGF0ZT8udGVtcGxhdGVEYXRhfVxuICAgICAgICBvbkNsb3NlPXsoKSA9PiB7XG4gICAgICAgICAgc2V0U2hvd1VuaWZpZWRNb2RhbChmYWxzZSk7XG4gICAgICAgICAgc2V0Q3VycmVudFRlbXBsYXRlKG51bGwpO1xuICAgICAgICB9fVxuICAgICAgICBvblN1Ym1pdD17bW9kYWxNb2RlID09PSAndGVtcGxhdGUnID8gaGFuZGxlVGVtcGxhdGVTdWJtaXQgOiBoYW5kbGVDYXNlQ3JlYXRpb259XG4gICAgICAgIGlzU3VibWl0dGluZz17aXNTdWJtaXR0aW5nVGVtcGxhdGV9XG4gICAgICAgIHByb3ZpZGVyTmFtZT17cHJvdmlkZXIuYnVzaW5lc3NOYW1lIHx8IHByb3ZpZGVyLmJ1c2luZXNzX25hbWUgfHwgJ9GB0L/QtdGG0LjQsNC70LjRgdGC0LAnfVxuICAgICAgICBwcm92aWRlcklkPXtwcm92aWRlci5pZH1cbiAgICAgICAgcHJvdmlkZXJDYXRlZ29yeT17cHJvdmlkZXIuc2VydmljZUNhdGVnb3J5IHx8IHByb3ZpZGVyLnNlcnZpY2VfY2F0ZWdvcnl9XG4gICAgICAgIGN1c3RvbWVyUGhvbmU9e2N1c3RvbWVyUGhvbmV9XG4gICAgICAvPlxuICAgICl9XG5cbiAgICB7LyogU3VydmV5IE1vZGFsICovfVxuICAgIHtzaG93U3VydmV5TW9kYWwgJiYgc3VydmV5Q2FzZSAmJiAoXG4gICAgICA8U3VydmV5TW9kYWxcbiAgICAgICAgaXNPcGVuPXtzaG93U3VydmV5TW9kYWx9XG4gICAgICAgIG9uQ2xvc2U9eygpID0+IHtcbiAgICAgICAgICBzZXRTaG93U3VydmV5TW9kYWwoZmFsc2UpO1xuICAgICAgICAgIHNldFN1cnZleUNhc2UobnVsbCk7XG4gICAgICAgIH19XG4gICAgICAgIGNhc2VJZD17c3VydmV5Q2FzZS5pZH1cbiAgICAgICAgcHJvdmlkZXJJZD17cHJvdmlkZXIuaWR9XG4gICAgICAgIHByb3ZpZGVyTmFtZT17cHJvdmlkZXIuYnVzaW5lc3NOYW1lIHx8IHByb3ZpZGVyLmJ1c2luZXNzX25hbWUgfHwgYCR7cHJvdmlkZXIuZmlyc3ROYW1lIHx8IHByb3ZpZGVyLmZpcnN0X25hbWV9ICR7cHJvdmlkZXIubGFzdE5hbWUgfHwgcHJvdmlkZXIubGFzdF9uYW1lfWB9XG4gICAgICAgIG9uU3VibWl0U3VjY2Vzcz17YXN5bmMgKCkgPT4ge1xuICAgICAgICAgIC8vIFNlbmQgYSB0aGFuayB5b3UgbWVzc2FnZSB0byB0aGUgY2hhdFxuICAgICAgICAgIGNvbnN0IHRoYW5rWW91TWVzc2FnZSA9IGDinIUg0JHQu9Cw0LPQvtC00LDRgNC40Lwg0LLQuCDQt9CwINC+0YbQtdC90LrQsNGC0LAhIFxuXG7QktCw0YjQtdGC0L4g0LzQvdC10L3QuNC1INC1INCy0LDQttC90L4g0LfQsCDQvdCw0YEg0Lgg0L/QvtC80LDQs9CwINC90LAg0LTRgNGD0LPQuCDQutC70LjQtdC90YLQuCDQtNCwINC90LDQv9GA0LDQstGP0YIg0L/RgNCw0LLQuNC70L3QuNGPINC40LfQsdC+0YAuYDtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBhcGlDbGllbnQuc2VuZE1lc3NhZ2Uoe1xuICAgICAgICAgICAgICBjb252ZXJzYXRpb25JZDogY29udmVyc2F0aW9uSWQhLFxuICAgICAgICAgICAgICBzZW5kZXJUeXBlOiAnY3VzdG9tZXInLFxuICAgICAgICAgICAgICBzZW5kZXJOYW1lOiBjdXN0b21lck5hbWUsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IHRoYW5rWW91TWVzc2FnZSxcbiAgICAgICAgICAgICAgbWVzc2FnZVR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEFkZCB0aGFuayB5b3UgbWVzc2FnZSB0byBsb2NhbCBzdGF0ZVxuICAgICAgICAgICAgY29uc3QgbmV3TWVzc2FnZTogTWVzc2FnZSA9IHtcbiAgICAgICAgICAgICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgY29udmVyc2F0aW9uSWQ6IGNvbnZlcnNhdGlvbklkISxcbiAgICAgICAgICAgICAgc2VuZGVyVHlwZTogJ2N1c3RvbWVyJyxcbiAgICAgICAgICAgICAgc2VuZGVyTmFtZTogY3VzdG9tZXJOYW1lLFxuICAgICAgICAgICAgICBtZXNzYWdlOiB0aGFua1lvdU1lc3NhZ2UsXG4gICAgICAgICAgICAgIG1lc3NhZ2VUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc2V0TWVzc2FnZXMocHJldiA9PiBbLi4ucHJldiwgbmV3TWVzc2FnZV0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZW5kaW5nIHRoYW5rIHlvdSBtZXNzYWdlOicsIGVycm9yKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBzZXRTaG93U3VydmV5TW9kYWwoZmFsc2UpO1xuICAgICAgICAgIHNldFN1cnZleUNhc2UobnVsbCk7XG4gICAgICAgICAgYWxlcnQoJ9CR0LvQsNCz0L7QtNCw0YDQuNC8INCy0Lgg0LfQsCDQvtGG0LXQvdC60LDRgtCwIScpO1xuICAgICAgICB9fVxuICAgICAgLz5cbiAgICApfVxuICA8L2Rpdj5cbilcbn1cbiJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZVN0YXRlIiwidXNlRWZmZWN0IiwidXNlUmVmIiwiVW5pZmllZENhc2VNb2RhbCIsIlNlcnZpY2VSZXF1ZXN0QnV0dG9uIiwiU3VydmV5TW9kYWwiLCJhcGlDbGllbnQiLCJ1c2VBdXRoIiwidXNlU29ja2V0IiwiQ2hhdE1vZGFsIiwicHJvdmlkZXIiLCJpc09wZW4iLCJvbkNsb3NlIiwidXNlciIsImlzQXV0aGVudGljYXRlZCIsInNvY2tldCIsImlzQ29ubmVjdGVkIiwibWVzc2FnZXMiLCJzZXRNZXNzYWdlcyIsIm5ld01lc3NhZ2UiLCJzZXROZXdNZXNzYWdlIiwibG9hZGluZyIsInNldExvYWRpbmciLCJjb252ZXJzYXRpb25JZCIsInNldENvbnZlcnNhdGlvbklkIiwiY3VzdG9tZXJOYW1lIiwic2V0Q3VzdG9tZXJOYW1lIiwiY3VzdG9tZXJFbWFpbCIsInNldEN1c3RvbWVyRW1haWwiLCJjdXN0b21lclBob25lIiwic2V0Q3VzdG9tZXJQaG9uZSIsImlzU3RhcnRlZCIsInNldElzU3RhcnRlZCIsInNob3dVbmlmaWVkTW9kYWwiLCJzZXRTaG93VW5pZmllZE1vZGFsIiwiY3VycmVudFRlbXBsYXRlIiwic2V0Q3VycmVudFRlbXBsYXRlIiwiaXNTdWJtaXR0aW5nVGVtcGxhdGUiLCJzZXRJc1N1Ym1pdHRpbmdUZW1wbGF0ZSIsIm1vZGFsTW9kZSIsInNldE1vZGFsTW9kZSIsInNob3dTdXJ2ZXlNb2RhbCIsInNldFNob3dTdXJ2ZXlNb2RhbCIsInN1cnZleUNhc2UiLCJzZXRTdXJ2ZXlDYXNlIiwibWVzc2FnZXNFbmRSZWYiLCJzdG9yYWdlS2V5IiwiaWQiLCJjb252ZXJzYXRpb25LZXkiLCJzY3JvbGxUb0JvdHRvbSIsImN1cnJlbnQiLCJzY3JvbGxJbnRvVmlldyIsImJlaGF2aW9yIiwiaW5pdGlhbGl6ZUNoYXQiLCJjb25zb2xlIiwibG9nIiwiZnVsbE5hbWUiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsInRyaW0iLCJmaW5hbE5hbWUiLCJlbWFpbCIsInBob25lTnVtYmVyIiwic2F2ZWRDb252ZXJzYXRpb25JZCIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJtZXNzYWdlc1Jlc3BvbnNlIiwiZ2V0Q29udmVyc2F0aW9uTWVzc2FnZXMiLCJkYXRhIiwic3VjY2VzcyIsImxvYWRNZXNzYWdlcyIsInJlbW92ZUl0ZW0iLCJzdGFydENvbnZlcnNhdGlvbiIsIm5hbWUiLCJwaG9uZSIsImVycm9yIiwiZW1pdCIsImhhbmRsZU5ld01lc3NhZ2UiLCJtZXNzYWdlSWQiLCJzZW5kZXJUeXBlIiwic2VuZGVyTmFtZSIsIm1lc3NhZ2UiLCJtZXNzYWdlVHlwZSIsInRpbWVzdGFtcCIsInByZXYiLCJtZXNzYWdlRXhpc3RzIiwic29tZSIsIm1zZyIsIm9uIiwib2ZmIiwib3ZlcnJpZGVEYXRhIiwicmVzcG9uc2UiLCJwcm92aWRlcklkIiwiY3VzdG9tZXJJZCIsInVuZGVmaW5lZCIsImNyZWF0ZU9yR2V0Q29udmVyc2F0aW9uIiwibmV3Q29udmVyc2F0aW9uSWQiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImNvbnZJZCIsImdldE1hcmtldHBsYWNlTWVzc2FnZXMiLCJBcnJheSIsImlzQXJyYXkiLCJzdGF0dXMiLCJyZWNyZWF0ZUNvbnZlcnNhdGlvbiIsImhhbmRsZUNhc2VUZW1wbGF0ZUNsaWNrIiwic2VydmljZUNhdGVnb3J5Iiwic2VydmljZV9jYXRlZ29yeSIsImdldENhc2VUZW1wbGF0ZSIsInRlbXBsYXRlRGF0YSIsInBhcnNlIiwidGVtcGxhdGVfZGF0YSIsImhhbmRsZVRlbXBsYXRlU3VibWl0IiwiZm9ybURhdGEiLCJjcmVhdGVTZXJ2aWNlQ2FzZSIsInRlbXBsYXRlSWQiLCJjYXNlRGF0YSIsInN1bW1hcnlNZXNzYWdlIiwiT2JqZWN0IiwiZW50cmllcyIsIm1hcCIsImtleSIsInZhbHVlIiwiZmllbGQiLCJmaWVsZHMiLCJmaW5kIiwiZiIsImxhYmVsIiwiam9pbiIsIm1lc3NhZ2VSZXNwb25zZSIsImZldGNoIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX0FQSV9VUkwiLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIm9rIiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwidG9JU09TdHJpbmciLCJhbGVydCIsImhhbmRsZUNhc2VDcmVhdGlvbiIsImNhc2VSZXNwb25zZSIsImFzc2lnbm1lbnRUeXBlIiwiY2FzZVBheWxvYWQiLCJzZXJ2aWNlVHlwZSIsImRlc2NyaXB0aW9uIiwicHJlZmVycmVkRGF0ZSIsInByZWZlcnJlZFRpbWUiLCJwcmlvcml0eSIsImFkZHJlc3MiLCJhZGRpdGlvbmFsRGV0YWlscyIsImNyZWF0ZUNhc2UiLCJjcmVhdGVkQ2FzZSIsIm5vdGlmaWNhdGlvbk1lc3NhZ2UiLCJidXNpbmVzc05hbWUiLCJidXNpbmVzc19uYW1lIiwic2VuZE1lc3NhZ2UiLCJjaGF0RXJyb3IiLCJFcnJvciIsImFjdGl2ZUNvbnZJZCIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIm5ld01zZyIsImhhbmRsZUNsb3NlIiwiZGl2IiwiY2xhc3NOYW1lIiwiaDMiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwicCIsImJ1dHRvbiIsIm9uQ2xpY2siLCJzdmciLCJmaWxsIiwic3Ryb2tlIiwidmlld0JveCIsInBhdGgiLCJzdHJva2VMaW5lY2FwIiwic3Ryb2tlTGluZWpvaW4iLCJzdHJva2VXaWR0aCIsImQiLCJsZW5ndGgiLCJwcm92aWRlck5hbWUiLCJjYXNlSWQiLCJwYXJzZWREYXRhIiwiZSIsImdldENhc2UiLCJzZXJ2aWNlX3R5cGUiLCJjb21wbGV0ZWRBdCIsImNvbXBsZXRlZF9hdCIsInNwYW4iLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJob3VyIiwibWludXRlIiwicmVmIiwiaW5wdXQiLCJ0eXBlIiwib25DaGFuZ2UiLCJ0YXJnZXQiLCJvbktleVByZXNzIiwicGxhY2Vob2xkZXIiLCJkaXNhYmxlZCIsIm1vZGUiLCJvblN1Ym1pdCIsImlzU3VibWl0dGluZyIsInByb3ZpZGVyQ2F0ZWdvcnkiLCJvblN1Ym1pdFN1Y2Nlc3MiLCJ0aGFua1lvdU1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/components/ChatModal.tsx\n"));

/***/ })

});